"use strict";(self.webpackChunk_snowflake_nu_ui=self.webpackChunk_snowflake_nu_ui||[]).push([["2838"],{751544:function(e,t,n){n.d(t,{_:()=>a,x:()=>E});var o=n(499924),r=n(868809),i=n(630455);function a(e,t,{serialize:n=JSON.stringify,deserialize:r=JSON.parse}={}){let[l,s]=o.useState(()=>{let n=window.localStorage.getItem(e);return null!==n?r(n):"function"==typeof t?t():t}),c=o.useRef(e);return[l,(0,i.z)(t=>{s(o=>{let r="function"==typeof t?t(o):t,i=c.current;return i!==e&&window.localStorage.removeItem(i),c.current=e,window.localStorage.setItem(e,n(r)),r})})]}function l(e,t){window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:t}))}let s=(e,t)=>{window.localStorage.setItem(e,t),l(e,t)},c=e=>{window.localStorage.removeItem(e),l(e,null)},u=e=>window.localStorage.getItem(e),d=e=>(window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)),f=()=>{throw Error("useLocalStorage is a client-only hook")};function E(e,t){let n=(0,r.useSyncExternalStore)(d,()=>u(e),f),i=(0,o.useMemo)(()=>{if(null===n)return null;try{return JSON.parse(n)}catch(e){return null}},[n]),a=(0,o.useMemo)(()=>null!=i,[i]),l=(0,o.useMemo)(()=>a?i:t,[a,t,i]),E=(0,o.useCallback)(()=>{c(e)},[e]),p=(0,o.useCallback)(t=>{try{null==t&&c(e);let n="function"==typeof t?t(l):t;null==n?c(e):s(e,JSON.stringify(n))}catch(e){console.warn(e)}},[e,l]);return{value:l,setValue:p,hasStoredValue:a,clear:E}}},713756:function(e,t,n){n.d(t,{b:()=>i,k:()=>r});var o=n(374318);function r(e){return e instanceof o.M}function i(e){let t=e;for(;t;){if(r(t))return t;t=t.cause}}},501188:function(e,t,n){n.d(t,{j:()=>w});var o,r=n(431815),i=n(750129),a=n(767557),l=n(117043),s=n(662839),c=n(613752),u=n(311636),d=n(438635),f=n(83980),E=n(844699),p=n(490066),b=n(54649),y=n(878439),g=n(564395);let S=["/:region/:org/data/marketplace","/marketplace","/:region/:org/data/provider-studio","/provider-studio","/:region/:org/data/shared/listing","/:region/:org/apps/listing"],O=["/:region/:org/data/manage/admin/:id?","/:region/:org/data/manage/provider/:id?","/:region/:org/data/manage/:id?","/:region/:org/data/shared/manage/:id?","/:region/:org/data/shared/provider/:id?","/:region/:org/data/shared/:id?","/:region/:org/admin/exchange/:id?","/:region/:org/data/","/:region/:org//"],h=()=>{var e;if(S.some(e=>(0,y.matchPath)({path:e,end:!1},g.lm.location.pathname)))return b.SnowflakePuDxName;let t=O.reduce((e,t)=>{var n;return(null==e||null==(n=e.params)?void 0:n.id)?e:(0,y.matchPath)({path:t,end:!1},g.lm.location.pathname)},null);return(null==t||null==(e=t.params)?void 0:e.id)&&decodeURI(t.params.id)};var m=n(998269),_=n(783844),I=n(279098),T=n(499269),v=n(499924);class R{constructor(e){this.dispatch=e,this[o]=!0}}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function N(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}o=T.sc;class A extends R{loadStores(e){if(this.dispatch){let{user:t,organization:n,securable:o}=e;!this.securablePromises&&o&&this.loadSecurableStore(o),!this.userStore&&t&&this.loadUserStore(t),this.initializeRolesAndWarehouse(t),!this.organizationStore&&n&&this.loadOrganizationStore(n)}}initializeRolesAndWarehouse(e){if(this.dispatch&&!this.userStore&&e){let n=e.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_WAW_DEX_FEATURE_20");if(this.dataDiscoverRole)e.switchCurrentRole(this.dataDiscoverRole);else{var t;let o=(null==(t=e.currentRole)?void 0:t.call(e))||(0,p.d)(e.currentUser);this.setDataDiscoverRole(o,n)}if(!this.currentWarehouse&&e.currentUser){let{settings:t}=e.currentUser;this.setCurrentWarehouse(null==t?void 0:t.defaultWarehouse,n)}}}get exchangeId(){return h()}get organizationName(){return this.organizationStore.activeOrg.settings.snowflakeOrgName}get isHealthCheckEnabled(){return this.userStore.dxHealthCheckEnabled}get hasSuperAccountAdminRole(){return(0,s.i)(this.availableRoles)}get isCurrentRoleSuperAccountAdmin(){return(0,d.h)(this.dataDiscoverRole)}get hasSuperOrgAdminRole(){return(0,c.j)(this.availableRoles)}get isCurrentRoleSuperOrgAdmin(){return(0,f.l)(this.dataDiscoverRole)}get hasSuperSecurityAdmin(){return(0,u.w)(this.availableRoles)}get isCurrentRoleSuperSecurityAdmin(){return(0,E.E)(this.dataDiscoverRole)}isCurrentUser(e){return this.userStore.isCurrentUser(e)}async validateSnowflakeURL(e){try{let t=await l.nufetch("/validate-snowflake-url?"+a.nZ({url:e}),this.userStore.userRequestContext(),void 0,void 0,!1);if(!t.valid)return{valid:!1};if(!e.toLowerCase().includes(".snowflakecomputing.com"))return console.error("account must include full url"),{valid:!1};return t}catch(e){return console.error("Validate snowflake url failed with err",e),{valid:!1}}}async validateAccountIdentifier(e,t,n){try{let o=await l.nufetch("/validate-snowflake-account-region?"+a.nZ({region:e.toUpperCase(),account:t.toUpperCase(),isSecondaryAccount:n}),this.userStore.userRequestContext());if(!o.valid)return{valid:!1};return o}catch(e){return console.error("Validate snowflake account region failed with err",e),{valid:!1}}}async fetchAccountDeploymentInfo(e,t){try{let n=await l.nufetch("/fetch-account-deployment-info?"+a.nZ({org:e.toUpperCase(),accountAlias:t.toUpperCase()}),this.userStore.userRequestContext());if(!n.valid)return{valid:!1};return N(C({},n),{org:n.org.toUpperCase(),accountAlias:n.accountAlias.toUpperCase()})}catch(e){return console.error("Fetch account deployment info failed with err",e),{valid:!1}}}async fetchAccountDeploymentInfoFromURL(e){try{let t=await l.nufetch("/fetch-account-deployment-info-from-url?"+a.nZ({url:e}),this.userStore.userRequestContext());if(!t.valid)return{valid:!1};return N(C({},t),{org:t.org.toUpperCase(),accountAlias:t.accountAlias.toUpperCase()})}catch(e){return console.error("Fetch account deployment info from url failed with err",e),{valid:!1}}}getCurrentRegion(){return this.organizationStore.activeOrg.settings.region}constructor(...e){super(...e),this.dataDiscoverRole="",this.secondaryRoles="",this.availableRoles=[],this.currentWarehouse="",this.googleTagManagerInitialized=!1,this.dataDiscoverRoleInitializedResolver=e=>{},this.dataDiscoverRoleInitialized=new Promise(e=>{this.dataDiscoverRoleInitializedResolver=e}),this.loadUserStore=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.userStore=e})},this.loadOrganizationStore=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.organizationStore=e})},this.loadSecurableStore=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.securablePromises=e})},this.validateRoleWarehousePair=(e=!0)=>{var t;null==(t=this.dispatch)||t.call(this,t=>{if(""===t.currentWarehouse||!t.securablePromises)return;let n=t.roleWarehouseValidationKey=new Promise((o,r)=>{var i;null==(i=t.securablePromises)||i.list(t.dataDiscoverRole,_.M.WAREHOUSE,m.Y.show,void 0,{forceRefresh:e,filter:t.currentWarehouse}).then(e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.roleWarehouseValidationKey===n&&(e.result.map(e=>e.name).includes(t.currentWarehouse)||(t.currentWarehouse="",o(!1)),o(!0))})},e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.roleWarehouseValidationKey===n&&(t.currentWarehouse="",r(e))})})})})},this.setDataDiscoverRole=(e,t=!1)=>{var n;null==(n=this.dispatch)||n.call(this,t=>{var n,o,r,i,a;t.dataDiscoverRole=e,null==(o=t.userStore)||null==(n=o.switchCurrentRole)||n.call(o,e),t.currentWarehouse||(t.currentWarehouse=null==(a=t.userStore)||null==(i=a.currentUser)||null==(r=i.settings)?void 0:r.defaultWarehouse)}),t||this.validateRoleWarehousePair(!1),this.dataDiscoverRoleInitializedResolver(e);try{let t=(0,r._)();r._.set(N(C({},t),{role:e}))}catch(e){i.log.error(e)}},this.setSecondaryRoles=(e,t=!1)=>{var n;null==(n=this.dispatch)||n.call(this,t=>{var n,o;t.secondaryRoles=e,null==(o=t.userStore)||null==(n=o.switchCurrentSecondaryRoles)||n.call(o,e)}),t||this.validateRoleWarehousePair(!1)},this.setAvailableRoles=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.availableRoles=e})},this.setStripeHealthCheckStatus=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.stripeHealthCheckComplete=e})},this.setCurrentWarehouse=(e,t=!1)=>{var n;null==(n=this.dispatch)||n.call(this,t=>{t.currentWarehouse=e}),t||this.validateRoleWarehousePair(!1);try{let t=(0,r._)();r._.set(N(C({},t),{warehouse:e}))}catch(e){i.log.error(e)}},this.setMarketplaceLunrIdx=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.marketplaceLunrIdx=N(C({},n.marketplaceLunrIdx),{idx:e,lastLoadTime:t})})},this.setMarketplaceLunrPromise=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.marketplaceLunrIdx=N(C({},n.marketplaceLunrIdx),{promise:e,lastLoadTime:t})})},this.setProviderMarketplaceLunrIdx=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.providerMarketplaceLunrIdx=N(C({},n.providerMarketplaceLunrIdx),{idx:e,lastLoadTime:t})})},this.setProviderMarketplaceLunrPromise=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.providerMarketplaceLunrIdx=N(C({},n.providerMarketplaceLunrIdx),{promise:e,lastLoadTime:t})})},this.setGoogleTagManagerInitialized=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.googleTagManagerInitialized=e})},this.setAccountCreatedDetails=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.accountCreatedDetails=e})}}}let w=(0,I.q)(()=>(function(e){let t=new e,[n,o]=(0,v.useReducer)(function(e,t){return(0,T.Uy)(e,t)},t);return(0,v.useEffect)(()=>o(()=>new e(o)),[e]),n})(A))},279098:function(e,t,n){n.d(t,{q:()=>r});var o=n(237257);function r(e,...t){let[n,i]=(0,o.Z)(e,...t);return Object.defineProperties(i,{Provider:{get:()=>n}}),i}},593944:function(e,t,n){n.d(t,{p:()=>i,Z:()=>a});var o=n(237257),r=n(499924);let[i,a]=(0,o.Z)(()=>(function(){let[e,t]=(0,r.useState)({});return{getFetchId:(0,r.useCallback)(t=>`${e[t]||1}`,[e]),incrementFetchId:(0,r.useCallback)(e=>{t(t=>{var n,o;return n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},t),o=o={[e]:(t[e]||1)+1},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n})},[])}})())},475165:function(e,t,n){n.d(t,{O:()=>o});function o(e,t){let{getCacheKey:n,getData:o}=t,r=e?n():void 0,i=e&&r?e.getEntry(r):void 0;if(i)return i;let a=o();return e&&r&&e.setEntry(r,a),a}},755388:function(e,t,n){n.d(t,{m:()=>i});var o=n(499924),r=n(593944);function i(e){let{getFetchId:t,incrementFetchId:n}=(0,r.Z)();return{fetchId:t(e),updateFetchId:(0,o.useCallback)(()=>n(e),[n,e])}}},433915:function(e,t,n){n.d(t,{b:()=>r});var o=n(499924);function r(){let e=(0,o.useRef)({entries:{},currentEvictionBucketIndex:0,evictionBuckets:Array.from({length:6},()=>[])}),t=(0,o.useCallback)(t=>{var n;let{entries:o}=e.current;return null==(n=o[t])?void 0:n.data},[]),n=(0,o.useCallback)((t,n)=>{let{entries:o,currentEvictionBucketIndex:r,evictionBuckets:i}=e.current;o[t]={data:n,evictionBucketIndex:r},i[r].push(t)},[]),r=(0,o.useCallback)(t=>{let{entries:n}=e.current;delete n[t]},[]);return(0,o.useEffect)(()=>{let t=setInterval(()=>{let{entries:t,currentEvictionBucketIndex:n,evictionBuckets:o}=e.current,r=(n+1)%o.length;for(let e of o[r]){var i;(null==(i=t[e])?void 0:i.evictionBucketIndex)===r&&delete t[e]}o[r]=[],e.current.currentEvictionBucketIndex=r},6e4);return()=>{clearInterval(t)}},[]),(0,o.useMemo)(()=>({getEntry:t,setEntry:n,clearEntry:r}),[r,t,n])}},896426:function(e,t,n){n.d(t,{H$:()=>a,OY:()=>l,Oi:()=>i,bR:()=>c,x3:()=>s});var o=n(467131);let r=(e,...t)=>`${e}${t?":":""}${null==t?void 0:t.join(":")}`,i=e=>{var t,n;let o=e.isUserE2E?[...null!=(t=e.markers)?t:[],"user-e2e"]:[...null!=(n=e.markers)?n:[]];return r(e.event,...o)},a=(e,...t)=>{let n=i({event:e,markers:t});return performance.clearMarks(n),performance.mark(n)},l=(e,...t)=>{let n=i({event:e,markers:t,isUserE2E:!0});return performance.clearMarks(n),performance.mark(n)},s=e=>{let t=i(e),n=performance.getEntriesByName(t);return!!(n&&n.length>0&&n.filter(e=>"mark"===e.entryType).length>0)},c=(e,...t)=>{let n=t.join(":");try{return performance.measure(e,n)}catch(e){return o.cM.info("[TELEMETRY] measureEvent: Event start was not marked for the marker: ",n),{duration:-1}}}},979991:function(e,t,n){n.d(t,{z:()=>s});var o=n(307134),r=n(51723),i=n(499924),a=n(362779),l=n(896426);let s=()=>{let{logEvent:e}=(0,r.useTelemetry)(),t=(0,i.useCallback)((e,...t)=>l.H$(e,...t),[]),n=(0,i.useCallback)((e,...t)=>l.bR(e,...t),[]),s=(0,i.useCallback)((e,...t)=>l.OY(e,...t),[]),c=(0,i.useCallback)(e=>l.x3(e),[]),u=(0,i.useCallback)(e=>{var t,o;let r;if(e.isUserE2E){let t=l.Oi(e);r=n(e.event,t).duration}let i=l.Oi((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},e),o=o={isUserE2E:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}),t));return{durationMs:n(e.event,i).duration,e2eDurationMs:r}},[n]);return{markEventStart:t,measureEventDuration:n,markE2EEventStart:s,isMarkerSet:c,_getDurationsFromMarker:u,logEventToSnowflakeAndDatadog:(0,i.useCallback)(t=>{e(t),a.A.isDisallowedDatadogEvent(t)&&o.v.addAction(t.event,t.data)},[e])}}},437239:function(e,t,n){n.d(t,{k:()=>i});var o=n(307134),r=n(616821);function i(e,t){(0,r.WC)()&&console.error(e,t),o.v.addError(e,t)}},221009:function(e,t,n){n.d(t,{EQ:()=>l,I1:()=>a});var o=n(184168),r=n(499924);let i=r.createContext(void 0),a=()=>(0,r.useContext)(i),l=({configToml:e,children:t})=>(0,o.jsx)(i.Provider,{value:e,children:t});l.displayName="ConfigTomlProvider"},375756:function(e,t,n){n.d(t,{S:()=>o});let o="SYSTEM$BASIC_RUNTIME"},369859:function(e,t,n){n.d(t,{R:()=>r});var o=n(750671);function r(e,t){let n=e.lastVersionLocationUri,r=e.liveVersionLocationUri,i=e.rootLocation;return!t&&r?{kind:"versioned",isLive:!0,rootLocation:r}:n?{kind:"versioned",isLive:!1,rootLocation:n}:{kind:"checkouts",rootLocation:(0,o.h)(i,"Invalid or unsupported location")}}},463462:function(e,t,n){n.d(t,{T:()=>r});var o=n(90911);function r(e){if((0,o.f)(e)){let[t,n]=e.split("/versions/");if((null==n?void 0:n.length)>0)return{stage:t,path:`/versions/${n}`};let o="/checkouts/",[r,i]=e.split(o);if((null==i?void 0:i.length)>0)return{stage:r,path:`${o}${i}`};let a="/commits/",[l,s]=e.split(a);return(null==s?void 0:s.length)>0?{stage:l,path:`${a}${s}`}:{stage:e,path:""}}let t=/^(@?(?:[^/"]*|"(?:[^"]|"")*")*)\/?(.*)/u.exec(e);return t?{stage:t[1].startsWith("@")?t[1]:`@${t[1]}`,path:t[2]}:{stage:e,path:""}}},90911:function(e,t,n){n.d(t,{f:()=>o});function o(e){return e.startsWith("snow://")}},583135:function(e,t,n){n.d(t,{A:()=>a});var o=n(499924),r=n(23917),i=n(254759);function a(){let{user:e}=(0,i.m)(["user"]),t="alter-entity-checkout";return(0,o.useCallback)(async({id:n,role:o,secondaryRoles:i})=>{let a=(0,r.BW)(n);return await e.api.query(a,{isInternal:!0,role:o,secondaryRoles:i,desc:t})},[e.api,t])}},735736:function(e,t,n){n.d(t,{U:()=>u});var o=n(499924),r=n(778098),i=n(320241),a=n(646397),l=n(998269),s=n(832072);function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function u(){let e=(0,o.useContext)(i.V1),{formatMessage:t}=(0,r.Z)();return(0,o.useCallback)(async(n,o,r)=>{let i=await (0,a.W)(e.get(o,n,l.Y.describe,{secondaryRoles:r}));if((0,s.D)(i)){var u;throw Error(t({id:"Could not get details for the object. Error: {message}"},{message:null==(u=i.error)?void 0:u.message}))}if(!i.result)throw Error(t({id:"Could not get details for the object. No result data."}));let d=i.result.columns[0];return d.rootLocation&&!d.lastVersionName?c({kind:"checkouts"},d):c({kind:"versioned"},d)},[t,e])}},613159:function(e,t,n){n.d(t,{z:()=>h});var o=n(485387),r=n.n(o),i=n(499924),a=n(501188),l=n(537840),s=n(320241),c=n(998269),u=n(783844),d=n(690908),f=n(67158),E=n(11043),p=n(94587),b=n(254759),y=n(369859),g=n(583135),S=n(731694);function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}let h=e=>{let{dataDiscoverRole:t,secondaryRoles:n,userStore:o}=(0,a.j)(),h=(0,s.fo)(t,{secondaryRoles:n}),m=(0,i.useContext)(s.V1),_=(0,b.m)(["query"]).query,I=(0,i.useMemo)(()=>{var t;let n=h.get(e,c.Y.describe).result;return(null==n||null==(t=n.columns)?void 0:t.length)?n.columns[0]:null},[e,h]),T=(0,g.A)(),v=(0,S.iA)(),R=null!==I,C=(0,i.useCallback)(()=>I?`Copy of ${I.name} ${r()().format("YYYY-MM-DD h:mm:ssa")}`:"",[I]),N=(0,i.useCallback)(async(e,r)=>{let i=new d.L(r?"ALTER SESSION SET ENABLE_COPY_FILES = TRUE, ENABLE_COPY_FILES_API_IN_STORAGE = TRUE":"ALTER SESSION UNSET ENABLE_COPY_FILES, ENABLE_COPY_FILES_API_IN_STORAGE");await o.api.query(i.toQuery(),{isInternal:!0,role:t,secondaryRoles:n,desc:r?"enable-copy-files-sql":"unset-copy-files-sql",pid:e})},[t,n,o.api]),A=(0,i.useCallback)(async(e,r)=>{var i;let a=new d.L("COPY FILES");a.add("INTO {}",(0,E.Q)(r)),a.add("FROM {}",(0,p.i)(null!=(i=null==I?void 0:I.rootLocation)?i:"")),await o.api.query(a.toQuery(),{isInternal:!0,role:t,secondaryRoles:n,desc:"copy-files-for-entity-clone",pid:e})},[t,n,null==I?void 0:I.rootLocation,o.api]),w=(0,i.useCallback)(async({newEntityName:o,newEntityTitle:r,useEmbeddedStage:i,shouldUseVersionedStage:a=!0,postCreationAction:s,getAdditionalProps:c})=>{var d;if(!R)throw Error("Duplication not ready yet.");let{mainFile:E,queryWarehouse:p,codeWarehouse:b}=I,g=(0,l.$3)(E),{type:S,database:h,schema:w,name:L}=e,k=null!=o?o:C(),P=`Duplicated from ${L}`,D={type:S,name:k,database:h,schema:w},{rootLocation:M}=(0,y.R)(I),U=M.endsWith("/")?M:`${M}/`,j=null,x=null!=(d=null==c?void 0:c(I))?d:{};if(i||a)return j=await m.create(t,D,O({from:U,warehouse:b,queryWarehouse:p,title:null!=r?r:void 0,mainFile:g,comment:P},x),{secondaryRoles:n}),a?await v({id:j,role:t,secondaryRoles:n}):await T({id:j,role:t,secondaryRoles:n}),s&&await s({newEntityFullIdentifier:j}),j;let F={type:u.M.STAGE,name:`${o} (Stage)`,database:h,schema:w},B=await m.create(t,F,{},{secondaryRoles:n});try{j=await m.create(t,D,O({rootLocation:`@${(0,f.m)(B)}`,mainFile:g,warehouse:b,queryWarehouse:p,title:null!=r?r:"",comment:P},x),{secondaryRoles:n})}catch(e){throw await m.drop(t,B,{secondaryRoles:n}),e}let G="";try{G=await _.createQuery(),await N(G,!0),await A(G,B)}catch(e){throw await m.drop(t,j,{secondaryRoles:n}),await m.drop(t,B,{secondaryRoles:n}),e}finally{G.length>0&&await _.deleteQuery(G)}return s&&await s({newEntityFullIdentifier:j,newEntityStageIdentifier:B}),j},[N,A,T,t,v,C,_,R,n,m,I,e]);return{sourceEntityDetails:I,duplicate:w,readyForDuplication:R}}},274753:function(e,t,n){n.d(t,{h:()=>u});var o=n(499924),r=n(320241),i=n(380621),a=n(998269),l=n(583135),s=n(23917),c=n(254759);let u=()=>{let e=function(){let{user:e}=(0,c.m)(["user"]),t="show-checkouts";return(0,o.useCallback)(async({id:n,role:o,secondaryRoles:r})=>{let i=(0,s.CG)(n);return await e.api.query(i,{isInternal:!0,role:o,secondaryRoles:r,desc:t})},[e.api,t])}(),t=(0,l.A)(),n=(0,o.useContext)(r.V1);return(0,o.useCallback)(async({id:o,role:r,secondaryRoles:l})=>{0===(await e({id:o,role:r,secondaryRoles:l})).rows.length&&(await t({id:o,role:r,secondaryRoles:l}),await (0,i.r)(n.get(r,o,a.Y.describe,{forceRefresh:!0,secondaryRoles:l})))},[e,t,n])}},731694:function(e,t,n){n.d(t,{LH:()=>d,iA:()=>f});var o=n(499924),r=n(778098),i=n(982055),a=n(713756),l=n(320241),s=n(646397),c=n(998269),u=n(832072);async function d(e,t,n,o){try{await e.alter(n,t,{add:!0,version:"live"},{secondaryRoles:o})}catch(e){var r,l;if((0,a.k)(e)&&(r=e.code,l=i.SFDBErrorCode.VSTAGE_LIVE_VERSION_EXISTS,void 0!==r&&void 0!==l&&E(r)===E(l)))return;throw e}}let f=()=>{let e=(0,o.useContext)(l.V1),{formatMessage:t}=(0,r.Z)();return(0,o.useCallback)(async({id:n,role:o,secondaryRoles:r})=>{await d(e,n,o,r);let i=await (0,s.W)(e.get(o,n,c.Y.describe,{secondaryRoles:r}));if((0,u.D)(i)){var a;throw Error(t({id:"Could not get details for the object. Error: {message}"},{message:null==(a=i.error)?void 0:a.message}))}if(!i.result)throw Error(t({id:"Could not get details for the object. No result data."}));return i.result.columns[0]},[t,e])};function E(e){return"number"==typeof e?e:parseInt(e,10)}},446013:function(e,t,n){n.d(t,{P:()=>a,X:()=>i});var o=n(499924);let r=(0,o.createContext)(null),i=r.Provider,a=()=>(0,o.useContext)(r)},810339:function(e,t,n){n.d(t,{Z:()=>s});var o=n(320241),r=n(527565),i=n(998269),a=n(3291),l=n(427674);function s(e){var t;let n=(0,o.fo)();if((0,l.$)())return!1;let s=n.get(e,i.Y.describe);if((0,a.M)(s))return null;let c=null==s||null==(t=s.result)?void 0:t.columns[0];return!!(null==c?void 0:c.runtimeName)&&c.runtimeName!==r.U}},427674:function(e,t,n){n.d(t,{$:()=>l,S:()=>a});var o=n(184168),r=n(499924);let i=(0,r.createContext)(!1),a=({children:e})=>(0,o.jsx)(i.Provider,{value:!0,children:e});a.displayName="StaticNotebookProvider";let l=()=>(0,r.useContext)(i)},102078:function(e,t,n){n.d(t,{r:()=>o});function o(e){for(let t of e)return!1;return!0}},537840:function(e,t,n){function o(e,t="/"){return e.startsWith(t)?e.substring(1):e}function r(e,t="/"){return e.startsWith(t)?e:`${t}${e}`}function i(e,t="/"){return e.endsWith(t)?e:`${e}${t}`}function a(e,t="/"){return e.endsWith(t)?e.substring(0,e.length-1):e}function l(e,t="/"){let n=e.lastIndexOf(t);return -1===n?"":e.slice(0,n)}function s(e,t){let n=i(o(t));return 0!==e.indexOf(n)?e:e.slice(n.length)}n.d(t,{$3:()=>o,FR:()=>a,X7:()=>l,kN:()=>i,mJ:()=>r,sR:()=>s})},313554:function(e,t,n){n.d(t,{Q:()=>r});let o={undefined:()=>0,boolean:()=>4,number:()=>8,string:e=>2*e.length,bigint:e=>r(e.toString()),function:e=>r(e.toString()),symbol:e=>r(e.toString()),object:e=>e?e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array?e.byteLength:Object.entries(e).reduce((e,[t,n])=>r(t)+r(n)+e,0):0};function r(e){return o[typeof e](e)}},461376:function(e,t,n){function o(e){return"function"==typeof e?e():e}function r(e,t){return o(e)?t:{}}function i(e,...t){return o(e)?t:[]}n.d(t,{V:()=>r,p:()=>i})},490066:function(e,t,n){n.d(t,{d:()=>r});var o=n(54649);function r(e,t){var n,r;if(t)return t;let i=null==e||null==(n=e.settings)?void 0:n.defaultRole;return i&&(null==e||null==(r=e.availableRoles)?void 0:r.includes(i))?i:o.PUBLIC_ROLE}},243181:function(e,t,n){n.d(t,{Bg:()=>y,HS:()=>g,N0:()=>E,Qe:()=>b,RL:()=>S,Te:()=>f,Zl:()=>d,eO:()=>u,wZ:()=>c,zd:()=>p});var o=n(616821),r=n(783844),i=n(690908),a=n(67158),l=n(988209),s=n(94587);let c=(e,t)=>({isInternal:!0,role:e,secondaryRoles:t,desc:"generate-notebook-url"});function u(e){return e.isPrivatelinkEnabled?new i.L().add("CALL SYSTEM$GENERATE_NOTEBOOK_URL_FROM_NAME({} , {} );",(0,s.i)((0,a.m)(e.fullNotebookIdentifier)),(0,l.S)(e.isAccountUsingPrivateLink)).toQuery():new i.L().add("CALL SYSTEM$GENERATE_NOTEBOOK_URL_FROM_NAME({});",(0,s.i)((0,a.m)(e.fullNotebookIdentifier))).toQuery()}function d({fullNotebookIdentifier:e,queryId:t}){return t?new i.L().add("CALL SYSTEM$GENERATE_READ_ONLY_NOTEBOOK_TOKEN_WITH_REPLAY_QUERY_ID({}, {});",(0,s.i)((0,a.m)(e)),(0,s.i)(t)).toQuery():new i.L().add("CALL SYSTEM$GENERATE_NOTEBOOK_TOKEN({});",(0,s.i)((0,a.m)(e))).toQuery()}function f(e){let t=new URL(e);return{baseUriParts:{host:t.hostname,port:""===t.port?443:Number(t.port),basePath:(0,o.WC)()?t.pathname.split("/").filter(e=>"bootstrap"!==e).join("/"):t.pathname},isHttps:"https:"===t.protocol}}function E(e){return e&&`${e.isHttps?"https":"http"}://${e.baseUriParts.host}:${e.baseUriParts.port}${e.baseUriParts.basePath}`}function p({fullNotebookIdentifier:e,queryId:t}){return new i.L().add("CALL SYSTEM$GET_NOTEBOOK_EXECUTION_MAIN_FILE({}, {});",(0,s.i)((0,a.m)(e)),(0,s.i)(t)).toQuery()}function b({database:e,schema:t}){let n=e&&t?`${e}.${t}`:"",o=new i.L;return n?o.add("SELECT SYSTEM$SHOW_NOTEBOOK_COMPUTE_POOLS(?)",(0,s.i)(n)):o.add("SELECT SYSTEM$SHOW_NOTEBOOK_COMPUTE_POOLS()"),o.toQuery()}function y({notebookUrlId:e}){return new i.L().add("CALL SYSTEM$GET_USER_PREFERENCE({}, {}, {});",(0,s.i)(r.M.NOTEBOOK),(0,s.i)(e),(0,s.i)("session_settings")).toQuery()}function g({notebookUrlId:e,sessionSettingsData:t}){return new i.L().add("CALL SYSTEM$SET_USER_PREFERENCE({}, {}, {}, {});",(0,s.i)(r.M.NOTEBOOK),(0,s.i)(e),(0,s.i)("session_settings"),(0,s.i)(t)).toQuery()}function S({fullNotebookIdentifier:e}){return new i.L().add("CALL SYSTEM$IS_ENTITY_READONLY_REPLICA({}, {});",(0,s.i)("NOTEBOOK"),(0,s.i)((0,a.m)(e))).toQuery()}},601127:function(e,t,n){n.d(t,{l:()=>a});var o=n(701257),r=n(577197),i=n(564395);class a{getPath(){return this.path}goBackOrNavigate(e,t={},n=[]){let o=i.lm.entries;if(o.length>1)for(let e=o.length-2;e>=0;e--){if(this.matchesAgainstPath(o[e].pathname))return void i.lm.push(o[e].pathname+o[e].search);let t=!1;for(let r of n)if(r.matchesAgainstPath(o[e].pathname)){t=!0;break}if(!t)break}i.lm.push(this.getURL(e,t))}goBackWithDataOrNavigate(e,t={},n=[]){let o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},e);Object.entries(o).forEach(([e,t])=>{"string"==typeof t&&(o[e]=decodeURIComponent(t))});let r=i.lm.entries;if(r.length>1)for(let e=r.length-2;e>=0;e--){let t=!1;for(let o of[...n,this])if(o.matchesAgainstPath(r[e].pathname)){t=!0;break}if(t){if(this.getURL(o)===r[e].pathname)return void i.lm.push(r[e].pathname+r[e].search)}else break}i.lm.push(this.getURL(o,t))}getURL(e,t){return(0,r.m)(this.path,e,t)}navigate(e,t={}){i.lm.push(this.getURL(e,t))}replaceCurrentURL(e,t={}){i.lm.replace(this.getURL(e,t))}matchesAgainstPath(e){return"string"!=typeof(0,o.Yt)(this.path,e)}constructor(e){this.path=e.path,this.page=e.page}}},865386:function(e,t,n){n.d(t,{k:()=>i});var o=n(601127),r=n(785433);let i=new o.l({path:[`${(0,r.D)()}/notebooks/id/{notebookUniqueId:string}`,`${(0,r.D)()}/notebooks/{entityIdStr:string}`],page:"notebook_detail"})},849792:function(e,t,n){n.d(t,{a:()=>o});function o(e,t){let n;n=t instanceof URLSearchParams?Array.from(t.entries()):Object.entries(t);let o=e;if(n.length>0){let t=n.map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&");o=`${e}?${t}`}return o}},701257:function(e,t,n){n.d(t,{Mp:()=>s,Yt:()=>l});var o=n(351436),r=n.n(o),i=n(779694);function a(e,t){let n=[].concat(e);for(n=n.map(e=>(0,i.Q)(e)),t=(0,i.Q)(t);n.length;){let e=t.split("/").filter(e=>e.length),o=n.shift(),i=o||"",a=o.replace(/^\//,"").replace(/\/$/,"").split("/").filter(e=>e.length);if("*"!==a.at(-1)&&e.length!==a.length)continue;let l={},s=!1;for(;a.length;){let t=e.shift(),n=a.shift();if(n.startsWith("{")){let e=n.slice(1,-1),o=e.split(":");switch(o[1].replace(/<[^>]*>/,"")){case"number":l[o[0]]=+t;break;case"string":l[o[0]]=decodeURIComponent(t);break;case"exists":t===o[0]?l[o[0]]=!0:s=!0;break;case"enum":let a=o[1].match(/enum<([^>]+)>/);if(null==a?void 0:a[1].match(RegExp(`(^|\\|)${r()(t)}(\\||$)`))){l[o[0]]=t;let e=RegExp(`/{${String(o[0])}:enum<([^\\|}]+(?:\\|[^\\|}]+)+)>}(?:/|$)`);(null==i?void 0:i.match(e))&&(i=i.replace(e,`/${encodeURIComponent(r()(t))}/`))}else s=!0;break;default:let c=this.constructor.name;return{data:`Unknown data typing of "{${e}}" in ${c}.`,path:""}}}else if(t===n)continue;else if(n&&"*"!==n||0!==a.length){s=!0;break}else break}if(!s)return{data:l,path:i}}return{data:`There was a path mismatch for the URL at "${t}"`,path:""}}function l(e,t){return a(e,t).data}function s(e,t){return a(e,t).path}},785433:function(e,t,n){n.d(t,{D:()=>o});function o(){return"/{region:string}/{org:string}"}},207036:function(e,t,n){n.d(t,{s:()=>r});var o=n(564395);function r(e=o.lm.location.search){return new URLSearchParams(decodeURI(e))}},577197:function(e,t,n){n.d(t,{m:()=>i});var o=n(849792),r=n(785433);function i(e,t={},n={},a=!1){let l=[].concat(e),s="";for(l=l.map(e=>e.includes((0,r.D)())?e.replace((0,r.D)(),"/{region:string}/{org:string}/#"):e);l.length;){let e=!1,r=`/${l.shift().replace(/^\//,"")}`;for(let n in t){let o=t[n];if(null==o)continue;let i=RegExp(`/{${n}:string}(?:/|$)`),a=RegExp(`/{${n}:exists}(?:/|$)`),l=RegExp(`/{${n}:enum<([^\\|}]+(?:\\|[^\\|}]+)*)>}(?:/|$)`);if(r.match(i))r=r.replace(i,`/${encodeURIComponent(o)}/`);else if(r.match(a))r=r.replace(a,`/${encodeURIComponent(n)}/`);else if(r.match(l)&&r.match(l)[1].split("|").includes(o))r=r.replace(l,`/${encodeURIComponent(o)}/`);else{e=!0;break}}if(!r.match(/{/)){r=r.replace(/\/$/,"");let t=(0,o.a)(r,n);if(!e)return t.replace(/%25/g,"%2525");s=s||t;break}}if(s){let e=`Left over data when building URL "${s}". Supplied data: ${JSON.stringify(t)}`;if(a)throw Error(e);return console.error(e),encodeURI(s)}throw Error(`Invalid data supplied to "${e}". Supplied data: ${JSON.stringify(t)}`)}},779694:function(e,t,n){n.d(t,{Q:()=>o});function o(e){return e.includes("/#/")?e.replace("/#/","/"):e}},320241:function(e,t,n){n.d(t,{V1:()=>S,fo:()=>O});var o=n(500140),r=n(51723),i=n(710807),a=n.n(i),l=n(499924),s=n(501188),c=n(490066),u=n(596378),d=n(272515),f=n(641392),E=n(832072),p=n(3291),b=n(254759);function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function g(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let S=l.createContext(void 0);function O(e,t={}){let{secondaryRoles:n,sessionContext:o}=t,i=(0,l.useContext)(S),a=(0,l.useContext)(r.TelemetryPerformanceContext),u=(0,s.j)(),d=(0,l.useContext)(b.L),f=null==d?void 0:d.user,E=e||(null==f?void 0:f.currentRole())||(0,c.d)(null==f?void 0:f.currentUser),p=null!=n?n:u.secondaryRoles,[,y]=(0,l.useState)(0),g={};return(0,l.useEffect)(()=>{let e=Object.values(g).map(e=>e(()=>{y(e=>e+1)}));return()=>{for(let t of e)t()}}),new h(E,p,i,g,a,o)}class h{async create(e,t,n){return this.securableStore.create(this.role,e,t,y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},n))}async clone(e,t,n,o){return this.securableStore.clone(this.role,e,t,n,y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},o))}async alter(e,t,n){return this.securableStore.alter(this.role,e,t,y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},n))}async drop(e,t){return this.securableStore.drop(this.role,e,y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},t))}async undrop(e,t){return this.securableStore.undrop(this.role,e,y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},t))}useList(e,t,n,r){let i=this.useListSkippable(e,t,n,r),a=(0,o.N)(y({profiler:this.profiler},r)),s=(0,o.N)(n),c=this.role,u=l.useCallback(()=>this.securableStore.list(c,e,t,s,g(y({},a),{sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0})),[c,t,s,e,a]);if(void 0===i)throw Error("skipped somehow");return[i,u]}useListSkippable(e,t,n,o){let r=this.useListSkippableNoThrowAux(e,t,n,o);if(r){if((0,p.M)(r.value))throw(0,d.d)(r);if((0,E.D)(r.value))throw r.value.error;return r.value}}useListSkippableNoThrowAux(e,t,n,r){let[,i]=(0,l.useState)(null),a=(0,o.N)(y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},r)),s=this.role;if((0,l.useEffect)(()=>{if(null==a||!a.skipFetch)return this.securableStore.list(s,e,t,n,a).register(i)},[s,e,t,n,a]),null==a||!a.skipFetch)return this.securableStore.list(s,e,t,n,a)}useListSkippableNoThrow(e,t,n,o){var r;return null==(r=this.useListSkippableNoThrowAux(e,t,n,o))?void 0:r.value}useGet(e,t,n){let o=this.useGetSkippable(e,t,n);if(void 0===o)throw Error("skipped somehow");return o}useGetMulti(e,t,n){let r=t instanceof Array?t:[t],i=r.map(t=>this.useGet(e,t,n)),s=(0,l.useMemo)(()=>Object.assign({},...a()(i,["lastLoadTime"]).map(e=>e.result)),i),c=Object.fromEntries(i.map((e,t)=>[r[t],e])),u=(0,o.N)(n),d=this.role;return{merged:s,bylevel:c,refresh:l.useCallback(t=>this.securableStore.get(d,e,t,g(y({profiler:this.profiler},u),{sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0})),[d,e,u])}}useGetSkippableNoThrowAux(e,t,n){let[,r]=(0,l.useState)({result:void 0,loadState:f.p.loading});n=(0,o.N)(y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},n));let i=this.role;if((0,l.useEffect)(()=>{if(null==n?void 0:n.skipFetch)return;let o=this.securableStore.get(i,e,t,n);return r(o.value),o.register(r)},[i,e,t,n]),null==n||!n.skipFetch)return this.securableStore.get(i,e,t,n)}useGetSkippableNoThrow(e,t,n){var o;return null==(o=this.useGetSkippableNoThrowAux(e,t,n))?void 0:o.value}useGetSkippable(e,t,n){let o=this.useGetSkippableNoThrowAux(e,t,n);if(o){if((0,p.M)(o.value))throw(0,u.c)(o);if((0,E.D)(o.value))throw o.value.error;return o.value}}get(e,t,n){var o;let r=null!=(o=null==n?void 0:n.role)?o:this.role,i=this.securableStore.get(r,e,t,g(y({profiler:this.profiler},n),{sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles}));return this.registersMap[i.updatingKey]=i.register,i.value}listIds(e,t,n,o){var r;let i=null!=(r=null==o?void 0:o.role)?r:this.role,a=this.securableStore.list(i,e,t,n,g(y({profiler:this.profiler},o),{sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles}));return this.registersMap[a.updatingKey]=a.register,a.value}useRefreshGet(e,t,n){let r=(0,o.N)(n),i=(0,o.N)(e);return l.useCallback(()=>this.securableStore.get(this.role,i,t,g(y({profiler:this.profiler},r),{sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0})),[i,t,r])}useHydratedList(e,t,n,r){let[i,a]=this.useHydratedListSkippable(e,t,n,r),s=(0,o.N)(y({profiler:this.profiler},r)),c=(0,o.N)(n),u=this.role,d=l.useCallback(()=>this.securableStore.list(u,e,t,c,g(y({},s),{sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0})),[u,t,c,e,s]);if(void 0===i||void 0===a)throw Error("skipped somehow");return[i,a,d]}useHydratedListNoThrow(e,t,n,r){let i=this.useListSkippableNoThrow(e,t,n,r),a=(0,o.N)(y({profiler:this.profiler},r)),s=(0,o.N)(n),c=null==r?void 0:r.requestContext,u=this.role,d=(0,o.N)(this.sessionContext),f=l.useCallback(()=>this.securableStore.list(u,e,t,s,g(y({},a),{sessionContext:d,forceRefresh:!0})),[u,e,t,s,a,d]);return[(0,l.useMemo)(()=>{var e;return null==i||null==(e=i.result)?void 0:e.map(e=>{var n;return this.securableStore.get(this.role,e,t,{profiler:this.profiler,ttlMs:Number.MAX_SAFE_INTEGER,requestContext:c,sessionContext:this.sessionContext,secondaryRoles:null!=(n=null==r?void 0:r.secondaryRoles)?n:this.secondaryRoles}).value.result},this.profiler)},[i,t,c,null==r?void 0:r.secondaryRoles]),i,f]}useHydratedListSkippable(e,t,n,r){let i=this.useListSkippable(e,t,n,r),a=(0,o.N)(null==r?void 0:r.requestContext),s=null==i?void 0:i.result;return[(0,l.useMemo)(()=>null==s?void 0:s.map(e=>{var n;return this.securableStore.get(this.role,e,t,{profiler:this.profiler,ttlMs:Number.MAX_SAFE_INTEGER,requestContext:a,sessionContext:this.sessionContext,secondaryRoles:null!=(n=null==r?void 0:r.secondaryRoles)?n:this.secondaryRoles}).value.result},this.profiler),[s,t,a,null==r?void 0:r.secondaryRoles]),i]}grant(e,t){return this.securableStore.grant(this.role,e,y({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles},t))}useIsRefreshing(e){let[t,n]=(0,l.useState)(!1),[o,r]=(0,l.useState)(e);return(0,l.useEffect)(()=>{if(!o)return;let e=this.securableStore.areRefreshesWithIDPending(o);return n(e.value||!0),e.register(e=>{n(e),r(void 0)})},[o]),[t,o,r]}constructor(e,t,n,o,r,i){this.role=e,this.secondaryRoles=t,this.securableStore=n,this.registersMap=o,this.profiler=r,this.sessionContext=i}}},596378:function(e,t,n){n.d(t,{c:()=>i});var o=n(60501),r=n(832072);function i(e){return new Promise((t,n)=>{let i=e.register(e=>{(0,r.D)(e)?(i(),n(e.error)):(0,o.j)(e)&&(i(),t(e))})})}},272515:function(e,t,n){n.d(t,{d:()=>i});var o=n(832072),r=n(227533);function i(e){return new Promise((t,n)=>{let i=e.register(e=>{(0,o.D)(e)?(i(),n(e.error)):(0,r.g)(e)&&(i(),t(e))})})}},380621:function(e,t,n){n.d(t,{r:()=>i});var o=n(3291),r=n(649957);function i(e,t){return new Promise(n=>{if((0,r.O)(e.value)||(0,o.M)(e.value)){let i=e.register(e=>{(0,r.O)(e)||(0,o.M)(e)||(t||i(),n(e))})}else n(e.value)})}},646397:function(e,t,n){n.d(t,{W:()=>r});var o=n(3291);function r(e){return new Promise(t=>{if((0,o.M)(e.value)){let n=e.register(e=>{(0,o.M)(e)||(n(),t(e))})}else t(e.value)})}},113803:function(e,t,n){n.d(t,{g:()=>g,w:()=>y});var o=n(783844),r=n(481642),i=n(690908),a=n(884407),l=n(390080),s=n(868646),c=n(94587),u=n(72949),d=n(802118),f=n(201515),E=n(230981);function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function b(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let y=e=>{var t,n,r,l;let u,y,g=(null==(t=e.id)?void 0:t.name)||"",S=(null==(l=e.options)||null==(r=l.extras)||null==(n=r.filter)?void 0:n.toString())||"",O=(0,s.M)({name:g,type:o.M.APPLICATION});S?(u="CALL SYSTEM$GET_REFERENCE_DEFINITIONS(?,[?])",y=[O,(0,c.i)(S)]):(u="CALL SYSTEM$GET_REFERENCE_DEFINITIONS(?)",y=[O]);let h=new i.L(u,...y).toQuery();return b(p({},e),{query:h,adapter:e=>{var t,n,r;let i=null!=(r=null==(n=e.rows)||null==(t=n[0])?void 0:t[0])?r:"",l=i?(0,f.F)(i):[],s=(0,E.y)(l);return s.forEach(e=>{let t=e.objectType.toLowerCase();if("api integration"===t)e.objectType=o.M.API_INTEGRATION;else if("external table"===t)e.objectType=o.M.EXTERNAL_TABLE;else if("external_access integration"===t||"external access integration"===t)e.objectType=o.M.EXTERNAL_ACCESS_INTEGRATION;else if("function"===t||"procedure"===t){let t=e.bindings;for(let e=0;e<t.length;e++)if(t[e].name){let n=t[e],{args:o,name:r}=(0,a.L)(n.name);n.name=(0,d.Z2)(r)||r,n.args=o}}}),{rows:[{id:{type:o.M.APPLICATION,name:g},references:s}]}},desc:"show-application-references"})},g=(e,t)=>{let n,a=e.reference;if(!a)return[];let d=(0,l.y)(p({type:o.M.PROCEDURE,database:t.name},a.registerCallback)),f=[],E=(0,c.i)(a.name),y=(0,c.i)(a.actionType);switch(a.actionType){case r.l.ADD:if(a.objects&&a.objects.length>0){n=`call ${d}(?, {}, system$reference({}, ?, 'PERSISTENT', {}))`;for(let e=0;e<a.objects.length;e++){let t=a.objects[e],o=(0,s.M)(t,{withArgs:!0}),r=(0,c.i)(t.type),l=new i.L().add(n,E,y,r,o,(0,u.K)(a.privileges||[]));f.push(b(p({},l.toQuery()),{desc:"set-reference-add"}))}}break;case r.l.REMOVE:if(a.objects&&a.objects.length>0){n=`call ${d}(?, {}, ?)`;for(let e=0;e<a.objects.length;e++){let t=(0,c.i)(a.objects[e]),o=new i.L().add(n,E,y,t);f.push(b(p({},o.toQuery()),{desc:"set-reference-remove"}))}}break;case r.l.CLEAR:{n=`call ${d}(?, {}, '')`;let e=new i.L().add(n,E,y);f.push(b(p({},e.toQuery()),{desc:"set-reference-clear"}))}}return f}},527565:function(e,t,n){n.d(t,{T:()=>o,U:()=>r});let o="SYSTEM$STREAMLIT_NOTEBOOK_WH",r="SYSTEM$WAREHOUSE_RUNTIME"},294098:function(e,t,n){n.d(t,{w3:()=>eS,n5:()=>ev,As:()=>eh,jJ:()=>ey,Vq:()=>eR,pV:()=>eu,Nj:()=>e_,r5:()=>eg,_t:()=>ec,Vk:()=>eC,rW:()=>es});var o=n(678830),r=n.n(o),i=n(326290),a=n.n(i),l=n(783844),s=n(690908),c=n(868646),u=n(908545);function d(e,t){if(t.type===l.M.EXTERNAL_TABLE)e.add("{} IDENTIFIER(?)",(0,u.T)(l.M.TABLE),(0,c.M)(t));else if(t.type===l.M.ML_MODEL_VERSION){let n={database:t.database,schema:t.schema,name:t.module,type:l.M.ML_MODEL};e.add("MODEL IDENTIFIER (?) MODIFY VERSION {}",(0,c.M)(n),{bindingsJSONRepr:t.name,inlineRepr:t.name})}else e.addFullyQualifiedIdentifier(t)}var f=n(470946),E=n(794912),p=n(645807),b=n(988209),y=n(971478),g=n(253833),S=n(610280),O=n(833030),h=n(802402),m=n(94587),_=n(244983),I=n(516727),T=n(850114),v=n(790757),R=n(223819);let C={[v.Q.EDIT_APP_PACKAGE]:({id:e,alterProps:t,descPrefix:n})=>{let{comment:o,distribution:r}=t,i=new s.L;return i.add("ALTER APPLICATION PACKAGE {} SET COMMENT = {} DISTRIBUTION = {}; ",(0,c.M)(e),(0,m.i)(o),(0,_.V)(r)),{alterSqlQuery:i.toQuery(),desc:`${n}-edit`}},[v.Q.RENAME_APP_PACKAGE]:({id:e,alterProps:t,descPrefix:n})=>{let{name:o}=t,r=new s.L;return r.add("ALTER APPLICATION PACKAGE IDENTIFIER(?) RENAME TO IDENTIFIER(?)",(0,c.M)(e),(0,c.M)({type:l.M.APPLICATION_PACKAGE,name:o})),{alterSqlQuery:r.toQuery(),desc:`${n}-rename`,newName:o}},[v.Q.ADD_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,pathToVersionDirectory:r,label:i,releaseChannel:a}=t,l=new s.L;return l.add("ALTER APPLICATION PACKAGE {}",(0,c.M)(e)),a?l.add("MODIFY RELEASE CHANNEL {} ADD VERSION {}",(0,R.t)(a),(0,R.t)(o)):l.add("ADD VERSION {} USING {} LABEL = {}",(0,R.t)(o),(0,m.i)(r),(0,m.i)(null!=i?i:"")),{alterSqlQuery:l.toQuery(),desc:a?`${n}-add-version-to-release-channel`:`${n}-add-version`}},[v.Q.ADD_PATCH_TO_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,pathToVersionDirectory:r,label:i}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE IDENTIFIER(?) ADD PATCH FOR VERSION {} USING {} LABEL = {}",(0,c.M)(e),(0,R.t)(o),(0,m.i)(r),(0,m.i)(null!=i?i:"")).toQuery(),desc:`${n}-create-new-patch`}},[v.Q.DROP_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE {} DROP VERSION {}",(0,c.M)(e),(0,R.t)(o)).toQuery(),desc:`${n}-drop-version`}},[v.Q.SET_DEFAULT_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,patch:r,releaseChannel:i}=t,a=new s.L;return a.add("ALTER APPLICATION PACKAGE {}",(0,c.M)(e)),i&&a.add("MODIFY RELEASE CHANNEL {}",(0,R.t)(i)),a.add("SET DEFAULT RELEASE DIRECTIVE VERSION = {} PATCH = {}",(0,R.t)(o),(0,O._)(r)),{alterSqlQuery:a.toQuery(),desc:i?`${n}-set-default-release-directive-for-release-channel`:`${n}-set-default-release-directive`}},[v.Q.SET_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,patch:r,directiveName:i,accounts:a,releaseChannel:u}=t,d=new s.L,f=a.map(e=>(0,c.M)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({type:l.M.ACCOUNT},e)));return d.add("ALTER APPLICATION PACKAGE {}",(0,c.M)(e)),u&&d.add("MODIFY RELEASE CHANNEL {}",(0,R.t)(u)),d.add("SET RELEASE DIRECTIVE {} ACCOUNTS = (",(0,R.t)(i)),f.forEach((e,t)=>{let n=t===f.length-1;d.add(n?"{}":"{}, ",e)}),d.add(") VERSION = {} PATCH = {}",(0,R.t)(o),(0,O._)(r)),{alterSqlQuery:d.toQuery(),desc:u?`${n}-set-release-directive-for-release-channel`:`${n}-set-release-directive`}},[v.Q.UNSET_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{directiveName:o,releaseChannel:r}=t,i=new s.L;return i.add("ALTER APPLICATION PACKAGE {}",(0,c.M)(e)),r&&i.add("MODIFY RELEASE CHANNEL {}",(0,R.t)(r)),i.add("UNSET RELEASE DIRECTIVE {}",(0,R.t)(o)),{alterSqlQuery:i.toQuery(),desc:r?`${n}-unset-release-directive-for-release-channel`:`${n}-unset-release-directive`}},[v.Q.MODIFY_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{directiveName:o,version:r,patch:i,releaseChannel:a}=t,l=new s.L;return l.add("ALTER APPLICATION PACKAGE {}",(0,c.M)(e)),a&&l.add("MODIFY RELEASE CHANNEL {}",(0,R.t)(a)),l.add("MODIFY RELEASE DIRECTIVE {} VERSION = {} PATCH = {}",(0,R.t)(o),(0,R.t)(r),(0,O._)(i)),{alterSqlQuery:l.toQuery(),desc:a?`${n}-modify-release-directive-for-release-channel`:`${n}-modify-release-directive`}},[v.Q.REGISTER_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,pathToVersionDirectory:r,label:i}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE {} REGISTER VERSION {} USING {} LABEL = {}",(0,c.M)(e),(0,R.t)(o),(0,m.i)(r),(0,m.i)(null!=i?i:"")).toQuery(),desc:`${n}-register-version`}},[v.Q.DEREGISTER_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE {} DEREGISTER VERSION {}",(0,c.M)(e),(0,R.t)(o)).toQuery(),desc:`${n}-deregister-version`}}},N=e=>{var t,n;let{alterSqlQuery:o,desc:r,newName:i}=(0,C[e.alterProps.alterType])(e);return{alters:[(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},o),n=n={desc:r},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)],newName:null!=i?i:""}};var A=n(113803),w=n(944799);let L=(e,t)=>{let{shareId:n,distribution:o,title:r,description:i,profile:a,targetAccounts:l,regions:u,autoFulfillment:d,reviewParameter:f="FALSE",publishParameter:E="FALSE"}=t,p={title:r,description:i,profile:null!=a?a:void 0,terms_of_service:{type:"OFFLINE"},targets:{accounts:l.length>0?l:void 0,regions:u.length>0?u:void 0},auto_fulfillment:d?{refresh_type:d.refreshType,refresh_schedule:d.refreshSchedule}:void 0};return new s.L().add("CREATE LISTING IDENTIFIER(?) FOR SHARE IDENTIFIER(?) AS {} DISTRIBUTION={} REVIEW={} PUBLISH={}",(0,c.M)(e),(0,c.M)(n),(0,w.Z)(p,{forceQuotes:!0}),(0,_.V)(o),(0,_.V)(f),(0,_.V)(E)).toQuery()},k=e=>new s.L().add("DROP LISTING IDENTIFIER(?)",(0,c.M)(e)).toQuery();var P=n(739732),D=n(934835);let M=e=>{if(e)return{featured:e}},U=e=>{var t,n;if(e)return{documentation:null!=(t=e.documentation)?t:void 0,media:null!=(n=e.media)?n:void 0}},j=e=>{var t,n,o,r,i,l;let s=U(e.resources),c=M(e.dataDictionary);return{title:e.title,subtitle:null!=(t=e.subtitle)?t:void 0,description:null!=(n=e.description)?n:void 0,custom_contact:null!=(o=e.customContact)?o:void 0,profile:null!=(r=e.profile)?r:void 0,terms_of_service:{type:e.termsOfService.type,link:null!=(i=e.termsOfService.link)?i:void 0},auto_fulfillment:e.autoFulfillment?{refresh_type:e.autoFulfillment.refreshType,refresh_schedule:e.autoFulfillment.refreshSchedule}:void 0,business_needs:e.businessNeeds,targets:{accounts:e.targetAccounts,regions:e.regions},usage_examples:e.usageExamples,categories:e.categories,resources:s,data_attributes:e.dataAttributes?{refresh_rate:e.dataAttributes.refreshRate,geography:{geo_option:e.dataAttributes.geography.geoOption,granularity:e.dataAttributes.geography.granularity,coverage:e.dataAttributes.geography.coverage},time:(0,D.l)(e.dataAttributes.time,a()),features:null!=(l=e.dataAttributes.features)?l:void 0}:void 0,data_dictionary:c}},x={[P.d.EDIT]:({id:e,alterProps:t,descPrefix:n})=>{let{listingDetails:o}=t,r=j(o);return{alterSqlQuery:new s.L("ALTER LISTING IDENTIFIER(?) AS {}",(0,c.M)(e),(0,w.Z)(r,{forceQuotes:!0})).toQuery(),desc:`${n}-edit`}},[P.d.PUBLISH]:({id:e,descPrefix:t})=>({alterSqlQuery:new s.L("ALTER LISTING IDENTIFIER(?) PUBLISH",(0,c.M)(e)).toQuery(),desc:`${t}-publish`}),[P.d.UNPUBLISH]:({id:e,descPrefix:t})=>({alterSqlQuery:new s.L("ALTER LISTING IDENTIFIER(?) UNPUBLISH",(0,c.M)(e)).toQuery(),desc:`${t}-unpublish`})},F=e=>{var t,n;let{alterSqlQuery:o,desc:r,newName:i}=(0,x[e.alterProps.alterType])(e);return{alters:[(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},o),n=n={desc:r.replaceAll("_","-").toLowerCase()},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)],newName:null!=i?i:""}};var B=n(373831),G=n(23917);function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function K(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function W(e){return(t,n)=>e(t,n)}function H(e,t){let n=`alter-${e.type.toLowerCase()}`;return`${n}-${t}`}let $=W((e,t)=>{if(!t.push)return null;if(t.secret&&t.push){let{secret:n,name:o,email:r,comment:i,to:a}=t;return[K(V({},(0,G.fd)(e,{secret:n,name:o,email:r,comment:i,to:a})),{desc:H(e,"push")})]}let{username:n,password:o,name:r,email:i,comment:a,to:l}=t;return[K(V({},(0,G.fd)(e,{username:n,password:o,name:r,email:i,comment:a,to:l})),{desc:H(e,"push")})]}),Q=W((e,t)=>{if(!0===t.add){let{from:n,live:o}=t;return[K(V({},(0,G.Hb)(e,{from:n,live:o||!n})),{desc:H(e,"add-version")})]}return null}),Y=W((e,t)=>!0===t.commit?[K(V({},(0,G.Tp)(e)),{desc:H(e,"commit")})]:null),z=W((e,t)=>!0===t.pull?[K(V({},(0,G.Qo)(e,t.enableConflictResolution)),{desc:H(e,"pull")})]:null),q=W((e,t)=>t.executeAs?[K(V({},(0,G.cA)(e,t.executeAs)),{desc:H(e,"execute-as")})]:null),Z=[Q,Y,$,z,q,W((e,t)=>t.newId?[K(V({},(0,G.U9)(e,t.newId)),{desc:H(e,"rename-to")})]:null),W((e,t)=>t.newSchema&&t.newOwner?[K(V({},(0,G.oh)(e,t.newSchema,t.newOwner)),{desc:H(e,"move-to")})]:null)];var J=n(916616),X=n.n(J);let ee=(e,t)=>{let n=[],o=[],r=[];return e.forEach(e=>{e.targetColNames?e.targetColNames.forEach(t=>{r.push({mappedColumns:e.mappedColumns,policy:e.policy,targetColName:t})}):r.push(e)}),t.forEach(e=>{e.targetColNames?e.targetColNames.forEach(t=>{o.push({mappedColumns:e.mappedColumns,policy:e.policy,targetColName:t})}):o.push(e)}),o.forEach(e=>{if(e.policy.domain===l.M.AGGREGATION_POLICY||e.policy.domain===l.M.ROW_ACCESS_POLICY){let t=r.find(t=>t.policy.domain===e.policy.domain);t&&n.push({toSet:t,toUnset:e})}else{let t=r.find(t=>t.policy.domain===e.policy.domain&&t.targetColName===e.targetColName);t&&n.push({toSet:t,toUnset:e})}}),{toRemove:o.filter(e=>!n.some(({toUnset:t})=>X()(t,e))),toAdd:r.filter(e=>!n.some(({toSet:t})=>X()(t,e))),toEdit:n}};function et(e,t){e.add("ACCOUNTS ="),t.forEach((t,n)=>{0!==n&&e.add(","),e.add("{}",(0,c.M)({type:l.M.ACCOUNT,name:t}))})}function en(e,t,n){let o=new s.L("alter");d(o,e),o.add(n);let r=t.accounts||[];return delete t.accounts,et(o,r),o.toQuery()}function eo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function er(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function ei(e){return a()(e).toUpperCase().replace("UTF_8","UTF8")}function ea(e,t){var n;e.add("{} {}",(n=t.name,(0,T.yB)(n)?(0,h.M)(n):(0,h.M)((0,E.P)(n))),(0,y.j)(t.type));let o="STRING"===t.type||"VARCHAR"===t.type||"DATE"===t.type||"TIMESTAMP"===t.type?`'${t.default}'`:String(t.default);void 0!==t.default&&e.add("DEFAULT {}",(0,_.V)(o)),t.notNull&&e.add("NOT NULL"),t.comment&&e.add("COMMENT {}",(0,m.i)(t.comment))}let el=["ALLOWED_AUTHENTICATION_SECRETS","STORAGE_INTEGRATION"];function es(e,t,n){if(t){let o=!1;for(let i of Object.keys(t)){let a=t[i],s=ei(i);switch(typeof a){case"string":"FILE_FORMAT"===s?e.add("FILE_FORMAT = (TYPE = {})",(0,S.a)(a)):"DEFAULT_SECONDARY_ROLES"===s?(e.add("{} = (",(0,S.a)(s)),a&&e.add("{}",(0,m.i)(a)),e.add(")")):el.includes(s)?e.add("{} = {}",(0,g.e)(s),(0,g.e)(a)):e.add("{} = {}",(0,S.a)(s),(0,m.i)(a));break;case"boolean":e.add("{} = {}",(0,S.a)(s),(0,b.S)(a));break;case"number":e.add("{} = {}",(0,S.a)(s),(0,O._)(a));break;case"object":if(r()(a))a.length>0?(e.add("{} = (",(0,S.a)(s)),a.forEach((t,n)=>{n>0&&e.add(","),e.add("{}",(0,m.i)(t))}),e.add(")")):n&&e.add("{} = ()",(0,S.a)(s));else if(null===a)e.add("{} = null",(0,S.a)(s));else switch(s){case"REPLICA_OF":e.add("AS REPLICA OF IDENTIFIER(?)",(0,c.M)(eo({type:l.M.DATABASE},a)));break;case"SCHEDULE":"mins"in a?e.add("{} = {}",(0,S.a)(s),(0,m.i)(`${a.mins} MINUTE`)):"expression"in a&&e.add("{} = {}",(0,S.a)(s),(0,m.i)(`USING CRON ${a.expression} ${a.timezone}`));break;case"LOCATION":e.add("{} = {}",(0,S.a)(s),(0,c.M)(a));break;case"FILE_FORMAT":e.add("{} = (FORMAT_NAME = {})",(0,S.a)(s),(0,c.M)(a));break;case"TRIGGERS":o=!0;break;case"METADATA":e.add("METADATA = '{}'",{inlineRepr:(0,f.H)(JSON.stringify(a))});break;default:e.add("{} = (",(0,S.a)(s)),es(e,a),e.add(")")}}}o&&eN(e,t.triggers)}}function ec(e){return(0,T.SD)(e)?e.toUpperCase():(0,T.r9)(e)?(0,I.b)(e):e}function eu(e){return er(eo({},e),{name:ec(e.name)})}let ed=[{keyword:"secure",renderer:e=>{e.add("secure")}},{keyword:"replace",renderer:e=>{e.add("or replace")}}],ef=[{keyword:"existsConditional",renderer:(e,t)=>{"ifNotExists"===t&&e.add("if not exists")}}],eE=[{keyword:"columns",renderer:function(e,t){e.add("("),function(e,t,n){for(let o=0;o<t.length;o++)o>0&&e.add(","),n(e,t[o])}(e,t,ea),e.add(")")}},{keyword:"sourceTable",renderer:function(e,t){e.add("on"),e.addFullyQualifiedIdentifier(t)}},{keyword:"returns",renderer:(e,t)=>{e.add("returns {}",(0,g.e)(t))}},{keyword:"withManagedAccess",renderer:e=>{e.add("WITH MANAGED ACCESS")}},{keyword:"language",renderer:(e,t)=>{e.add("language {}",(0,g.e)(t))}},{keyword:"from",renderer:(e,t)=>{e.add("FROM"),"string"==typeof t?e.add("{}",(0,m.i)(t)):e.addFullyQualifiedIdentifier(t)}}],ep=[{keyword:"definition",renderer:function(e,t,n){e.add("as"),n.type===l.M.FUNCTION||n.type===l.M.PROCEDURE?e.add("{}",(0,m.i)(t)):e.add("{}",(0,h.M)(t))}}];function eb(e,t,n,o){for(let r of t){let t=n[r.keyword];void 0!==t&&(r.renderer(e,t,o),delete n[r.keyword])}}function ey(e,t){if(e.type===l.M.ORG_EMAIL)return eA(l.M.ORG_EMAIL,"CREATE",t);if(e.type===l.M.BUDGET_BUNDLE)return(0,B.cQ)(e);if(e.type===l.M.APPLICATION){let n=t;return n.from.type===l.M.APPLICATION_PACKAGE?function(e,t){let n=t.from.name,o=t.version,r=t.patch,i=new s.L().add("create {} IDENTIFIER(?) from APPLICATION PACKAGE IDENTIFIER(?)",(0,u.T)(e.type),(0,c.M)(e),(0,c.M)({name:n,type:l.M.APPLICATION_PACKAGE}));return t.from.type===l.M.APPLICATION_PACKAGE&&o&&void 0!==r&&i.add("USING VERSION {} PATCH {}",(0,R.t)(o),(0,O._)(r)),i.toQuery()}(e,n):function(e,t){let n=t.from?t.from.name:"",o=t.using?t.using.name:"",r=t.trial,i=t.autoRenew,a=t.preferMCD,l=t.paymentMethodId,d=t.purchaseOrderId,f=t.isBackgroundInstall,E=t.isEventSharingAuthorization,p=t.offer,b=new s.L().add("create {} IDENTIFIER(?)",(0,u.T)(e.type),(0,c.M)(e)).add("from LISTING {}",(0,m.i)(n));return o&&b.add("using RELEASE CHANNEL {}",(0,_.V)(o)),f&&b.add("BACKGROUND_INSTALL = true"),E&&b.add("AUTHORIZE_TELEMETRY_EVENT_SHARING = true"),es(b,{trial:r,autoRenew:i,preferMCD:a,paymentMethodId:l,purchaseOrderId:d,offer:p}),b.toQuery()}(e,n)}if(e.type===l.M.PROVIDER_LISTING)return L(e,t);t=eo({},t);let n=new s.L("create");eb(n,ed,t,e);let o=[];for(let e of ef){let n=t[e.keyword];void 0!==n&&(o.push({keyword:e.keyword,renderer:t=>e.renderer(t,n)}),delete t[e.keyword])}n.addFullyQualifiedIdentifier(e,o),eb(n,eE,t,e);let r=eo({},t);for(let e of ep)delete r[e.keyword];return es(n,r),eb(n,ep,t,e),n.toQuery()}function eg(e,t,n){let o=new s.L("CREATE");return o.add("{}",(0,u.T)(e.type)),o.add("IDENTIFIER(?)",(0,c.M)(t)),o.add("CLONE"),o.add("IDENTIFIER(?)",(0,c.M)(e)),n.comment&&o.add("COMMENT = {}",(0,m.i)(n.comment)),o.toQuery()}function eS(e,t){if(e.type===l.M.PROVIDER_LISTING)return k(e);if(e.type===l.M.ML_MODEL_VERSION){let t={name:e.module,database:e.database,schema:e.schema,type:l.M.ML_MODEL};return new s.L().add("ALTER MODEL IDENTIFIER(?) DROP VERSION {}",(0,c.M)(t),{bindingsJSONRepr:e.name,inlineRepr:e.name}).toQuery()}let n=new s.L("drop");return e.type===l.M.BUDGET_BUNDLE?n.add("instance IDENTIFIER(?)",(0,c.M)(e)):n.addFullyQualifiedIdentifier(e),(null==t?void 0:t.cascade)&&e.type===l.M.APPLICATION&&n.add("CASCADE"),e.type===l.M.ACCOUNT&&(null==t?void 0:t.gracePeriodInDays)&&n.add("grace_period_in_days="+t.gracePeriodInDays),n.toQuery()}function eO(e,{emailType:t,oldEmail:n,newEmail:o},r){let[i,a]=function(...e){return e.map(e=>Array.isArray(e)?e:[e])}(n,o),l=i.filter(e=>!a.includes(e)),s=a.filter(e=>!i.includes(e));return{alters:[...l.map((n,o)=>er(eo({},eA(e,"DROP",{email:n,emailType:t})),{desc:`${r}-drop${0===o?"":"-"+(o+1)}`})),...s.map((n,o)=>er(eo({},eA(e,"CREATE",{email:n,emailType:t})),{desc:`${r}-create${0===o?"":"-"+(o+1)}`}))],newName:""}}function eh(e,t){let n,o=`alter-${e.type.toLowerCase()}`;if(e.type===l.M.ORG_EMAIL)return eO(l.M.ORG_EMAIL,t,o);if(e.type===l.M.ACCOUNT_EMAIL)return eO(l.M.ACCOUNT_EMAIL,t,o);if(e.type===l.M.SHARE){if(t.useAdd){let n=[];return n.push(er(eo({},en(e,t,"add")),{desc:`${o}-add-accounts`})),{alters:n,newName:""}}else if(t.useRemove){let n=[];return n.push(er(eo({},en(e,t,"remove")),{desc:`${o}-remove-accounts`})),{alters:n,newName:""}}}if(e.type===l.M.CONSUMER_LISTING&&t.unpublishByAdmin)return{alters:[er(eo({},new s.L().add("call system$unpublish_data_exchange_listing_by_admin(?, ?, ?)",(0,m.i)(e.exchangeId),(0,m.i)(e.name),(0,m.i)(t.reason)).toQuery()),{desc:`${o}-unpublish-listing-by-admin`})],newName:""};if(e.type===l.M.LISTING&&t.appPackage)return{alters:[er(eo({},new s.L().add("call SYSTEM$SETUP_LISTING_WITH_APPLICATION_PACKAGE(?, ?)",(0,c.M)(e),(0,c.M)({name:t.appPackage,type:l.M.APPLICATION_PACKAGE})).toQuery()),{desc:`${o}-setup-listing-with-app-package`})],newName:""};if(e.type===l.M.BUDGET_BUNDLE){let n,r=[],i="";if(t.budgetId){let r=t.budgetId;i=ec(r.name),n=er(eo({},(0,B.Wh)(e,r)),{desc:`${o}-rename`})}if(t.spendingLimit&&r.push(er(eo({},(0,B._w)(e,t.spendingLimit)),{desc:`${o}-set-spending-limit`})),t.emailNotification){let n=t.emailNotification;r.push(er(eo({},(0,B.FX)(e,n.recipient)),{desc:`${o}-set-email-notification-without-integration`}))}return t.activate&&r.push(er(eo({},(0,B.qz)(e)),{desc:`${o}-activate-account-budget`})),t.deactivate&&r.push(er(eo({},(0,B.wS)(e)),{desc:`${o}-deactivate-account-budget`})),t.addResources&&t.addResources.length>0&&t.addResources.forEach(t=>r.push(er(eo({},(0,B.Pl)(e,t)),{desc:`${o}-add-resource-to-budget`}))),t.removeResources&&t.removeResources.length>0&&t.removeResources.forEach(t=>r.push(er(eo({},(0,B.yu)(e,t)),{desc:`${o}-remove-resource-from-budget`}))),n&&r.push(n),{alters:r,newName:i}}if(e.type===l.M.APPLICATION_PACKAGE&&t.alterType)return N({alterProps:t,id:e,descPrefix:o});if(e.type===l.M.PROVIDER_LISTING&&t.alterType)return F({alterProps:t,id:e,descPrefix:o});if(e.type===l.M.APPLICATION&&t.reference)return{alters:(0,A.g)(t,e),newName:""};if(e.type===l.M.ACCOUNT&&t.name){let n=ec(t.name),r=[];return r.push(er(eo({},function(e,t,n){var o,r;let i=new s.L("alter");return d(i,e),i.add("rename to IDENTIFIER(?)",(0,c.M)((o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},e),r=r={name:t},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))}),o))),void 0!==n&&i.add("save_old_url = "+n),i.toQuery()}(e,n,t.saveOldUrl)),{desc:`${o}-rename`})),{alters:r,newName:n}}if(e.type===l.M.NOTEBOOK||e.type===l.M.STREAMLIT){let n=function(e,t){for(let n of Z){let o=n(e,t);if(o)return o}return null}(e,t);if(n)return{alters:n,newName:""}}let r=[],i={},a=!1,u=[],f="";for(let E in t){let b=t[E];if("name"===E)b&&ec(b)!==e.name&&(n=er(eo({},eR(e,f=ec(b))),{desc:`${o}-rename`}));else if("networkPolicy"===E&&e.type===l.M.ACCOUNT)r.push(er(eo({},function(e,t){let n=new s.L("alter");return d(n,e),"activate"===t.action?n.add("set NETWORK_POLICY = {}",(0,m.i)(t.name)):n.add("unset NETWORK_POLICY"),n.toQuery()}(e,b)),{desc:`${o}-${b.action}-${b.name.replace(" ","-")}`}));else if("action"===E)r.push(er(eo({},eC(e,b)),{desc:`${o}-${b.replace(" ","-")}`}));else if("secure"===E&&e.type===l.M.FUNCTION){let t=b?"set":"unset";r.push(er(eo({},eC(e,`${t} secure`)),{desc:`${o}-${t}-secure`}))}else if("enableReplication"===E&&e.type===l.M.DATABASE)r.push(er(eo({},ew(e,b,"enable replication")),{desc:`${o}-enable-replication`}));else if("disableReplication"===E&&e.type===l.M.DATABASE)r.push(er(eo({},ew(e,b,"disable replication")),{desc:`${o}-disable-replication`}));else if("enableFailover"===E&&e.type===l.M.DATABASE)r.push(er(eo({},ew(e,b,"enable failover")),{desc:`${o}-enable-failover`}));else if("disableFailover"===E&&e.type===l.M.DATABASE)r.push(er(eo({},ew(e,b,"disable failover")),{desc:`${o}-disable-failover`}));else if("policy"===E){let t,{toSet:n,toUnset:i,targetColumnName:a,entityColumns:s}=b,c=n?n.policy.domain:i.domain,u=c===l.M.ROW_ACCESS_POLICY,d=c===l.M.MASKING_POLICY,f=c===l.M.PROJECTION_POLICY,E=c===l.M.AGGREGATION_POLICY,p=c===l.M.PRIVACY_POLICY;u?eP({id:e,actions:r,toSet:n,toUnset:i,targetColumnName:a,descPrefix:o}):p?(n&&i?t=`${o}-drop-and-add-privacy-policy`:n?t=`${o}-add-privacy-policy`:i&&(t=`${o}-drop-privacy-policy`),r.push(er(eo({},eI({id:e,addParams:n,dropParams:i})),{desc:t}))):d?n&&i?r.push(er(eo({},eI({id:e,addParams:n,dropParams:i,targetColumnName:a})),{desc:`${o}-set-masking-policy-force`})):n?r.push(er(eo({},eI({id:e,addParams:n,targetColumnName:a})),{desc:`${o}-set-masking-policy`})):i&&r.push(er(eo({},eI({id:e,dropParams:i,targetColumnName:a})),{desc:`${o}-unset-masking-policy`})):f?n&&i?r.push(er(eo({},eI({id:e,addParams:n,dropParams:i,targetColumnName:a})),{desc:`${o}-set-projection-policy-force`})):n?r.push(er(eo({},eI({id:e,addParams:n,targetColumnName:a})),{desc:`${o}-set-projection-policy`})):i&&r.push(er(eo({},eI({id:e,dropParams:i,targetColumnName:a})),{desc:`${o}-unset-projection-policy`})):E&&eD({id:e,actions:r,toSet:n,toUnset:i,entityColumns:s,descPrefix:o})}else if("policies"===E){let{rowAccessPolicy:t,aggregationPolicy:n,projectionPolicies:i}=b;if(t){let{toSet:n,toUnset:i,targetColumnName:a}=t;eP({id:e,actions:r,toSet:n,toUnset:i,targetColumnName:a,descPrefix:o})}if(n){let{toSet:t,toUnset:i}=n;eD({id:e,actions:r,toSet:t,toUnset:i,entityColumns:null==t?void 0:t.entityColumns,descPrefix:o})}if(i){let{toSet:t,toUnset:n}=i;!function({id:e,actions:t,toSet:n,toUnset:o,descPrefix:r}){let{toAdd:i,toRemove:a,toEdit:l}=ee(null!=n?n:[],null!=o?o:[]);i.forEach(n=>{t.push(er(eo({},eI({id:e,addParams:n,targetColumnName:n.targetColName})),{desc:`${r}-set-projection-policy`}))}),a.forEach(n=>{t.push(er(eo({},eI({id:e,dropParams:n.policy,targetColumnName:n.targetColName})),{desc:`${r}-unset-projection-policy`}))}),l.forEach(n=>{t.push(er(eo({},eI({id:e,addParams:n.toSet,dropParams:n.toUnset.policy,targetColumnName:n.toSet.targetColName})),{desc:`${r}-set-projection-policy-force`}))})}({id:e,actions:r,toSet:t,toUnset:n,descPrefix:o})}}else if("tags"===E)(null==b?void 0:b.length)>0&&r.push(er(eo({},function(e,t){let n=new s.L("alter");return eL(e,n),t[0].targetColumnName&&ek(n,t[0].targetColumnName),n.add("set TAG"),t.forEach((e,t)=>{t>0&&n.add(",");let o={name:e.name,database:e.database,schema:e.schema,type:l.M.TAG};n.add("IDENTIFIER(?) = {}",(0,c.M)(o),(0,m.i)(e.value))}),n.toQuery()}(e,b)),{desc:`${o}-set`}));else if("tagsToUnset"===E)(null==b?void 0:b.length)>0&&r.push(er(eo({},function(e,t){let n=new s.L("alter");return eL(e,n),t[0].targetColumnName&&ek(n,t[0].targetColumnName),n.add("unset TAG"),t.forEach((e,t,o)=>{let r={type:l.M.TAG,name:e.name,database:e.database,schema:e.schema};t<o.length-1?n.add("IDENTIFIER(?),",(0,c.M)(r)):n.add("IDENTIFIER(?)",(0,c.M)(r))}),n.toQuery()}(e,b)),{desc:`${o}-unset`}));else if("columnToDrop"===E)r.push(er(eo({},function(e,t){let n=new s.L("alter");eL(e,n),n.add("drop COLUMN");let o={type:l.M.SCHEMA,name:t};return n.add("{}",(0,c.M)(o)),n.toQuery()}(e,b)),{desc:`${o}-drop-column`}));else if((e.type===l.M.TABLE||e.type===l.M.VIEW||e.type===l.M.DYNAMIC_TABLE||e.type===l.M.ICEBERG_TABLE||e.type===l.M.EXTERNAL_TABLE)&&"columnComment"===E){let{column:t,comment:n}=b;r.push(er(eo({},function(e,t,n){let o=new s.L("ALTER");return d(o,e),o.add(`ALTER COLUMN ${(0,p.v)(t)}`),n?o.add("COMMENT {}",(0,m.i)(n)):o.add("UNSET COMMENT"),o.toQuery()}(e,t,n)),{desc:`${o}-column-comment`}))}else{let t=e.type===l.M.WAREHOUSE&&"autoSuspend"===E;null!==b||e.type===l.M.RESOURCE_MONITOR||t?(i[E]=b,a=!0):u.push(E)}}let E=[];return r.length>0&&E.push(...r),a&&E.push(er(eo({},e_(e,i)),{desc:`${o}-set`})),u.length>0&&E.push(er(eo({},ev(e,u)),{desc:`${o}-unset`})),n&&E.push(n),{alters:E,newName:f}}let em=[l.M.NETWORK_POLICY,l.M.NOTEBOOK,l.M.STREAMLIT];function e_(e,t){let n=new s.L("alter");d(n,e);let o=Object.keys(t);if(e.type===l.M.RESOURCE_MONITOR&&1===o.length&&"triggers"===o[0])eN(n,t.triggers);else if(e.type===l.M.SHARE&&void 0!==t.accounts&&null!==t.accounts){n.add("set");let e=t.accounts;delete t.accounts,et(n,e),es(n,t)}else n.add("set"),es(n,t,em.includes(e.type));return n.toQuery()}function eI({id:e,addParams:t,dropParams:n,targetColumnName:o,entityColumns:r}){let i=new s.L("alter");eL(e,i);let a=null==t?void 0:t.policy.domain;return o&&ek(i,o),n&&t&&a!==l.M.ROW_ACCESS_POLICY&&a!==l.M.PRIVACY_POLICY?eT(i,t,o,r,!0):(n&&function(e,t){let{domain:n,name:o,schema:r,database:i}=t;n===l.M.MASKING_POLICY?e.add("unset masking policy"):n===l.M.ROW_ACCESS_POLICY?(e.add("drop row access policy"),e.add("IDENTIFIER(?)",(0,c.M)({type:n,name:o,schema:r,database:i}))):n===l.M.PRIVACY_POLICY?(e.add("drop privacy policy"),e.add("IDENTIFIER(?)",(0,c.M)({type:n,name:o,schema:r,database:i}))):n===l.M.AGGREGATION_POLICY?e.add("unset aggregation policy"):n===l.M.PROJECTION_POLICY&&e.add("unset projection policy")}(i,n),n&&t&&i.add(","),t&&eT(i,t,o,r)),i.toQuery()}function eT(e,t,n,o,r){let{policy:i,mappedColumns:a}=t,{domain:s,name:u,schema:d,database:f}=i,E={type:s,name:u,schema:d,database:f};s===l.M.MASKING_POLICY&&n&&a?(e.add("set masking policy"),e.add("IDENTIFIER(?)",(0,c.M)(E)),a.length>1&&(e.add("using ("),a.forEach((t,o,r)=>{0===o?e.add("{}",(0,c.M)({type:l.M.SCHEMA,name:n})):e.add("{}",(0,c.M)({type:l.M.SCHEMA,name:t.mappedColName})),o<r.length-1&&e.add(",")}),e.add(")")),r&&e.add("force")):s===l.M.ROW_ACCESS_POLICY&&!n&&a?(e.add("add row access policy"),e.add("IDENTIFIER(?)",(0,c.M)(E)),e.add("on ("),a.forEach((t,n,o)=>{let r={type:l.M.SCHEMA,name:t.mappedColName};e.add("{}",(0,c.M)(r)),n<o.length-1&&e.add(",")}),e.add(")")):s===l.M.AGGREGATION_POLICY?(e.add("set aggregation policy"),e.add("IDENTIFIER(?)",(0,c.M)(E)),(null==o?void 0:o.length)&&(e.add("ENTITY KEY ("),o.forEach((t,n)=>{e.add("{}",(0,c.M)({type:l.M.SCHEMA,name:t})),n<o.length-1&&e.add(",")}),e.add(")")),r&&e.add("force")):s===l.M.PROJECTION_POLICY&&n?(e.add("set projection policy"),e.add("IDENTIFIER(?)",(0,c.M)(E)),r&&e.add("force")):s===l.M.PRIVACY_POLICY&&(e.add("add privacy policy"),e.add("IDENTIFIER(?)",(0,c.M)(E)))}function ev(e,t){let n=new s.L("alter");n.addFullyQualifiedIdentifier(e),n.add("unset");for(let e=0;e<t.length;e++){let o=ei(t[e]);e<t.length-1?n.add("{},",(0,S.a)(o)):n.add("{}",(0,S.a)(o))}return n.toQuery()}function eR(e,t){let n=new s.L("alter");return d(n,e),n.add("rename to IDENTIFIER(?)",(0,c.M)(er(eo({},e),{name:t}))),n.toQuery()}function eC(e,t){let n=new s.L("alter");return n.addFullyQualifiedIdentifier(e),n.add("{}",(0,S.a)(t)),n.toQuery()}function eN(e,t){let{suspend:n,suspendImmediately:o,notify:r}=t;for(let t of((n||o||r)&&e.add("TRIGGERS"),n&&e.add("ON {} PERCENT DO SUSPEND",(0,O._)(n)),o&&e.add("ON {} PERCENT DO SUSPEND_IMMEDIATE",(0,O._)(o)),r))t&&e.add("ON {} PERCENT DO NOTIFY",(0,O._)(t))}function eA(e,t,n){let o=new s.L,r="";return e===l.M.ACCOUNT_EMAIL?"CREATE"===t?r="call system$ADD_EMAIL_STORAGE_FOR_ACCOUNT({}, {})":"DROP"===t&&(r="call system$DELETE_EMAIL_STORAGE_FOR_ACCOUNT({}, {})"):e===l.M.ORG_EMAIL&&("CREATE"===t?r="call system$ADD_EMAIL_STORAGE_FOR_ORGANIZATION({}, {})":"DROP"===t&&(r="call system$DELETE_EMAIL_STORAGE_FOR_ORGANIZATION({}, {})")),o.add(r,(0,m.i)(n.emailType),(0,m.i)(n.email)),o.toQuery()}function ew(e,t,n){let o=new s.L("alter");return d(o,e),o.add(`${n} to accounts`),t.forEach((e,t)=>{0!==t&&o.add(","),o.add("IDENTIFIER(?)",(0,c.M)(e))}),o.toQuery()}function eL(e,t){e.type===l.M.EXTERNAL_TABLE?t.add("{} IDENTIFIER(?)",(0,u.T)(l.M.TABLE),(0,c.M)(e)):e.type===l.M.MATERIALIZED_VIEW?t.add("{} IDENTIFIER(?)",(0,u.T)(l.M.VIEW),(0,c.M)(e)):t.addFullyQualifiedIdentifier(e)}function ek(e,t){let n={type:l.M.SCHEMA,name:t};e.add("modify COLUMN"),e.add("{}",(0,c.M)(n))}function eP({id:e,actions:t,toSet:n,toUnset:o,targetColumnName:r,descPrefix:i}){let a="";n&&o?a=`${i}-drop-and-add-row-access-policy`:n?a=`${i}-add-row-access-policy`:o&&(a=`${i}-drop-row-access-policy`),t.push(er(eo({},eI({id:e,addParams:n,dropParams:o,targetColumnName:r})),{desc:a}))}function eD({id:e,actions:t,toSet:n,toUnset:o,entityColumns:r,descPrefix:i}){let a="";n&&o?t.push(er(eo({},eI({id:e,addParams:n,dropParams:o,entityColumns:r})),{desc:`${i}-set-aggregation-policy-force`})):n?(a=`${i}-set-aggregation-policy`,t.push(er(eo({},eI({id:e,addParams:n,entityColumns:r})),{desc:a}))):o&&(a=`${i}-unset-aggregation-policy`,t.push(er(eo({},eI({id:e,dropParams:o})),{desc:a})))}},144306:function(e,t,n){n.d(t,{J:()=>i});var o=n(734176);let r=e=>{try{let t=JSON.parse(e);return"string"==typeof t}catch(e){return!0}},i=e=>{let t=e.filter(e=>!(0,o.U)(e));return 0===t.length?"":JSON.stringify(t.reduce((e,t)=>{var n,o;return n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},e),o=o={[t.key]:r(t.value)?t.value:JSON.parse(t.value)},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n},{}))}},201515:function(e,t,n){n.d(t,{F:()=>i});var o=n(54649),r=n(467131);function i(e){try{return(0,o.jsonParseDoubleDollarSafe)(e)}catch(e){return r.cM.error(Error(`error running jsonParseDoubleDollarSafe ${e}`)),{}}}},734176:function(e,t,n){n.d(t,{U:()=>o});let o=e=>""===e.key&&""===e.value},230981:function(e,t,n){n.d(t,{n:()=>u,y:()=>c});var o=n(693936),r=n.n(o),i=n(812598),a=n.n(i),l=n(934835),s=n(201515);function c(e){return(0,l.l)(e,r())}let u=e=>{let t=(0,s.F)(null!=e?e:"{}");return a()(t)?void 0:c(t)}},373831:function(e,t,n){n.d(t,{cQ:()=>y,Iq:()=>C,qz:()=>m,i4:()=>E,YY:()=>f,sq:()=>v,S6:()=>O,wS:()=>_,zZ:()=>T,yu:()=>A,SN:()=>b,FX:()=>S,ll:()=>h,Wh:()=>I,X7:()=>R,ny:()=>w,_w:()=>g,cC:()=>p,Pl:()=>N});var o=n(783844),r=n(408015),i=n(677967),a=n(316758),l=n(690908),s=n(868646),c=n(833030),u=n(94587);let d=e=>{var t;let n=(null==e||null==(t=e.database)?void 0:t.replace("/","."))||"",[o="",r=""]=e.name.split("/");return{tagName:[...n&&[n],o].join("."),tagValue:r}};function f(e){return new l.L().add("CALL {}!GET_SPENDING_LIMIT();",(0,s.M)(e)).toQuery()}function E(e){return new l.L().add("CALL {}!GET_NOTIFICATION_INTEGRATION_NAME();",(0,s.M)(e)).toQuery()}function p(e){return new l.L().add("CALL {}!GET_NOTIFICATION_EMAIL();",(0,s.M)(e)).toQuery()}function b(e,t){let{lowerBound:n,upperBound:o}=t;return new l.L().add("CALL {}!get_spending_history({}, {})",(0,s.M)(e),(0,u.i)(n),(0,u.i)(o)).toQuery()}function y(e){return new l.L().add("CREATE SNOWFLAKE.CORE.BUDGET {}();",(0,s.M)(e)).toQuery()}function g(e,t){return new l.L().add("CALL {}!SET_SPENDING_LIMIT({});",(0,s.M)(e),(0,c._)(t)).toQuery()}function S(e,t){return new l.L().add("CALL {}!SET_EMAIL_NOTIFICATIONS({});",(0,s.M)(e),(0,u.i)(t)).toQuery()}function O(){return new l.L("CALL SYSTEM$SHOW_BUDGETS_IN_ACCOUNT();").toQuery()}function h(){return new l.L("CALL SYSTEM$SHOW_BUDGET_DETAILS_IN_ACCOUNT();").toQuery()}function m(e){return new l.L().add("CALL {}!ACTIVATE();",(0,s.M)(e)).toQuery()}function _(e){return new l.L().add("CALL {}!DEACTIVATE();",(0,s.M)(e)).toQuery()}function I(e,t){return new l.L("ALTER SNOWFLAKE.CORE.BUDGET {} RENAME TO {};",(0,s.M)(e),(0,s.M)(t)).toQuery()}let T=e=>{let{inclusiveDateRange:t,timezone:n,serviceType:o,budgetId:c}=e,{lowerBound:d,upperBound:f}=(0,a.A)(t),E=(0,i.f)(t);return new l.L().add("CALL {}!GET_SERVICE_TYPE_USAGE({}, {}, {}, {}, {});",(0,s.M)(c),(0,u.i)(o),(0,u.i)(E),(0,u.i)(n||"UTC"),(0,u.i)((0,r.c)(d)),(0,u.i)((0,r.c)(f))).toQuery()},v=e=>new l.L().add("CALL {}!get_linked_resources();",(0,s.M)(e)).toQuery(),R=e=>new l.L().add("CALL {}!get_linked_tags();",(0,s.M)(e)).toQuery(),C=e=>new l.L().add("CALL {}!get_activation_date();",(0,s.M)(e)).toQuery(),N=(e,t)=>{if(t.type===o.M.TAG){let{tagName:n,tagValue:o}=d(t);return new l.L().add("CALL {}!ADD_TAG((SELECT SYSTEM$REFERENCE('TAG', {}, 'SESSION', 'APPLYBUDGET')), {});",(0,s.M)(e),(0,u.i)(n),(0,u.i)(o)).toQuery()}let n=t.type===o.M.APPLICATION?o.M.DATABASE:t.type;return new l.L().add("CALL {}!ADD_RESOURCE(SELECT SYSTEM$REFERENCE({}, '{}', 'SESSION', 'APPLYBUDGET'));",(0,s.M)(e),(0,u.i)(n),(0,s.M)(t)).toQuery()},A=(e,t)=>{if(t.type===o.M.TAG){let{tagName:n,tagValue:o}=d(t);return new l.L().add("CALL {}!REMOVE_TAG((SELECT SYSTEM$REFERENCE('TAG', {}, 'SESSION', 'APPLYBUDGET')), {});",(0,s.M)(e),(0,u.i)(n),(0,u.i)(o)).toQuery()}let n=t.type===o.M.APPLICATION?o.M.DATABASE:t.type;return new l.L().add("CALL {}!REMOVE_RESOURCE(SELECT SYSTEM$REFERENCE({}, '{}', 'SESSION', 'APPLYBUDGET'));",(0,s.M)(e),(0,u.i)(n),(0,s.M)(t)).toQuery()};function w(e){return new l.L().add("CALL {}!GET_CONFIG();",(0,s.M)(e)).toQuery()}},23917:function(e,t,n){n.d(t,{BW:()=>E,CG:()=>p,DS:()=>S,Hb:()=>O,M0:()=>b,Qo:()=>_,Rf:()=>I,Tp:()=>h,U9:()=>R,V1:()=>y,YK:()=>T,cA:()=>v,fd:()=>m,iv:()=>g,oh:()=>C});var o=n(783844),r=n(690908),i=n(67158),a=n(868646),l=n(833030),s=n(908545),c=n(657452),u=n(94587),d=n(244983),f=n(144306);function E(e){return new r.L().add("ALTER {} {} CHECKOUT;",(0,s.T)(e.type),(0,a.M)(e)).toQuery()}function p(e){return new r.L().add("SHOW CHECKOUTS IN {} {};",(0,s.T)(e.type),(0,a.M)(e)).toQuery()}function b(e){return new r.L().add("CALL SYSTEM$SHOW_WAREHOUSES_FOR_FILE_BASED_ENTITY({});",(0,u.i)(e)).toQuery()}function y(e){return new r.L().add("CALL SYSTEM$SHOW_SCHEMAS_IN_ACCOUNT_WITH_CREATE_FILE_BASED_ENTITY({});",(0,u.i)(e)).toQuery()}function g(e){return e.params?function({entityId:e,scheduleName:t,scheduleCronExpression:n,scheduleTimezone:i,warehouse:l,params:s}){return new r.L(`CREATE TASK IDENTIFIER(?) WAREHOUSE={} SCHEDULE={} CONFIG=$$${(0,f.J)([{id:0,key:"params",value:null!=s?s:""}])}$$ AS BEGIN LET PARAMS STRING := SYSTEM$GET_TASK_GRAPH_CONFIG('params')::string; EXECUTE {} {}(:PARAMS); END;`,(0,a.M)({type:o.M.TASK,name:t,database:e.database,schema:e.schema}),(0,u.i)(l),(0,u.i)(`USING CRON ${n} ${null!=i?i:"UTC"}`),(0,d.V)(e.type),(0,a.M)(e)).toQuery()}(e):function({entityId:e,scheduleName:t,scheduleCronExpression:n,scheduleTimezone:i,warehouse:l}){return new r.L("CREATE TASK IDENTIFIER(?) WAREHOUSE={} SCHEDULE={} AS EXECUTE {} {}();",(0,a.M)({type:o.M.TASK,name:t,database:e.database,schema:e.schema}),(0,u.i)(l),(0,u.i)(`USING CRON ${n} ${null!=i?i:"UTC"}`),(0,d.V)(e.type),(0,a.M)(e)).toQuery()}(e)}function S(e){return new r.L().add("ALTER TASK IDENTIFIER(?) RESUME",(0,a.M)(e)).toQuery()}function O(e,{from:t,live:n,versionAlias:o}){let i=new r.L("ALTER {} {} ADD",(0,s.T)(e.type),(0,a.M)(e));return n&&i.add("LIVE"),i.add("VERSION"),o&&!1===/^live$/iu.test(o)&&i.add("{}",(0,u.i)(o)),i.add("FROM {}",null==t||"last"===t?(0,d.V)("LAST"):(0,c.F)(t.gitRepository,t.path)).toQuery()}function h(e){return new r.L("ALTER {} {} COMMIT;",(0,s.T)(e.type),(0,a.M)(e)).toQuery()}function m(e,{username:t,password:n,name:o,email:i,comment:l,secret:d,to:f}){let E=new r.L("ALTER {} {} PUSH",(0,s.T)(e.type),(0,a.M)(e));return f&&E.add("TO {}",(0,c.F)(f.gitRepository,f.path)),d&&E.add("GIT_CREDENTIALS={}",(0,a.M)(d)),t&&E.add("USERNAME={}",(0,u.i)(t)),n&&E.add("PASSWORD={}",(0,u.i)(n)),o&&E.add("NAME={}",(0,u.i)(o)),i&&E.add("EMAIL={}",(0,u.i)(i)),l&&E.add("COMMENT={}",(0,u.i)(l)),E.toQuery()}function _(e,t=!1){let n=new r.L("ALTER {} {} PULL",(0,s.T)(e.type),(0,a.M)(e));return t&&n.add("ENABLE_MANUAL_CONFLICT_RESOLUTION=true"),n.toQuery()}function I({entityId:e,maxRuns:t}){return new r.L().add("CALL SYSTEM$LIST_FILE_BASED_ENTITY_EXECUTIONS({}, {}, {});",(0,u.i)(e.type),(0,u.i)((0,i.m)(e)),(0,l._)(t)).toQuery()}function T({entityId:e,queryId:t}){return new r.L().add("CALL SYSTEM$GET_FILE_BASED_ENTITY_EXECUTION({}, {}, {});",(0,u.i)(e.type),(0,u.i)((0,i.m)(e)),(0,u.i)(t)).toQuery()}function v(e,t){return new r.L(`ALTER {} IDENTIFIER(?) EXECUTE AS ${t}`,(0,s.T)(e.type),(0,a.M)(e)).toQuery()}function R(e,t){return new r.L("ALTER {} IDENTIFIER(?) RENAME TO IDENTIFIER(?)",(0,s.T)(e.type),(0,a.M)(e),(0,a.M)(t)).toQuery()}function C(e,t,n){return new r.L("ALTER {} IDENTIFIER(?) MOVE TO SCHEMA IDENTIFIER(?) GRANT OWNERSHIP TO ROLE IDENTIFIER(?)",(0,s.T)(e.type),(0,a.M)(e),(0,a.M)(t),(0,u.i)(n)).toQuery()}},998269:function(e,t,n){n.d(t,{Y:()=>r});var o,r=((o={}).terse="terse",o.show="show",o.describe="describe",o.grants="grants",o.grants_to="grants_to",o.grants_of="grants_of",o.grantable_privileges="grantable_privileges",o.future_grants="future_grants",o.visible_grants="visible_grants",o.replication_information="replication_information",o.get_ddl="get_ddl",o.bootstrap="bootstrap",o.organization_account_info="organization_account_info",o.external_table="external_table",o.query_result="query_result",o.query_history="query_history",o.query_plan="query_plan",o.user_name="user_name",o.preview="preview",o.inbound_shares="inbound_shares",o.outbound_shares="outbound_shares",o.outbound_share_details="outbound_share_details",o.share_properties="share_properties",o.provider_data_dictionary_shared_object_list="provider_data_dictionary_shared_object_list",o.pwd_change_info="pwd_change_info",o.edition="edition",o.available_databases="available_databases",o.replication="replication",o.available_roles="available_roles",o.mfa="mfa",o.mfa_optin="mfa_optin",o.authorized_actions="authorized_actions",o.metrics="metrics",o.utilization="utilization",o.cluster_utilization="cluster_utilization",o.org_contract_balance="org_contract_balance",o.anaconda_terms="anaconda_terms",o.gov_marketplace_terms="gov_marketplace_terms",o.is_marketplace_terms_accepted="is_marketplace_terms_accepted",o.marketplace_terms="marketplace_terms",o.columns="columns",o.tag_references="tag_references",o.tag_references_internal="tag_references_internal",o.related_listings="related_listings",o.tag_references_all_columns="tag_references_all_columns",o.policy_references="policy_references",o.list_entities_bottomup_check="list_entities_bottomup_check",o.entity_detail="entity_detail",o.by_name_reference="by_name_reference",o.authorized_operations="authorized_operations",o.popularity_scores="popularity_scores",o.listing_popularity_scores="listing_popularity_scores",o.provider_popularity_scores="provider_popularity_scores",o.category_popularity_scores="category_popularity_scores",o.listing_category_mapping="listing_category_mapping",o.database_refresh_history="database_refresh_history",o.imported_databases="imported_databases",o.listing_database_replication_schedules="listing_database_replication_schedules",o.listings_all_private_exchanges="listing_all_private_exchanges",o.private_listings_all_public_exchanges="private_listings_all_public_exchanges",o.listing_target_accounts="listing_target_accounts",o.listing_data_dictionary_provider_featured_objects="listing_data_dictionary_provider_featured_objects",o.available_regions="available_regions",o.listing_data_dictionary_consumer_shared_object_list="listing_data_dictionary_consumer_shared_object_list",o.listing_data_dictionary_consumer_featured_objects="listing_data_dictionary_consumer_featured_objects",o.is_database_imported="is_database_imported",o.mcd_properties="mcd_properties",o.listing_replication_schedules="listing_replication_schedules",o.listing_fulfillment_status="listing_fulfillment_status",o.share_validation_for_fulfillment="share_validation_for_fulfillment",o.compatibility_checker_for_fulfillment="compatibility_checker_for_fulfillment",o.terms_acknowledged="terms_acknowledged",o.listing_data_dictionary_consumer_object_details="listing_data_dictionary_consumer_object_details",o.exchange_regions="exchange_regions",o.spending_limit="spending_limit",o.spending_history="spending_history",o.notification_integration="notification_integration",o.notification_email="notification_email",o.show_budgets_in_account="show_budgets_in_account",o.show_budget_details_in_account="show_budget_details_in_account",o.resource_usage="resource_usage",o.get_attached_resources="get_attached_resources",o.activation_date="activation_date",o.get_config="get_config",o.get_linked_tags="get_linked_tags",o.password_policy="password_policy",o.application_instances="application_instances",o.application_metadata="application_metadata",o.owned_objects="owned_objects",o.privileges="privileges",o.references="references",o.versions="versions",o.associated_listings="associated_listings",o.release_directives="release_directives",o.version_manifest="version_manifest",o.application_package_file="application_package_file",o.application_package_validation_for_fulfillment="application_package_validation_for_fulfillment",o.dcr_versions_info="dcr_versions_info",o.application_package_size="application_package_size",o.application_package_available_regions="application_package_available_regions",o.show_in_account="show_in_account",o.show_in_account_limit="show_in_account_limit",o.eligible_objects_for_file_based_entity="eligible_objects_for_file_based_entity",o.contact_references_on_object="contact_references_on_object",o.semantic_view_references="semantic_view_references",o)},641392:function(e,t,n){n.d(t,{p:()=>r});var o,r=((o={}).unloaded="unloaded",o.loading="loading",o.loaded="loaded",o.refreshing="refreshing",o.error="error",o)},790757:function(e,t,n){n.d(t,{Q:()=>r});var o,r=((o={}).EDIT_APP_PACKAGE="EDIT_APP_PACKAGE",o.RENAME_APP_PACKAGE="RENAME_APP_PACKAGE",o.ADD_VERSION="ADD_VERSION",o.ADD_PATCH_TO_VERSION="ADD_PATCH_TO_VERSION",o.DROP_VERSION="DROP_VERSION",o.SET_RELEASE_DIRECTIVE="SET_RELEASE_DIRECTIVE",o.SET_DEFAULT_RELEASE_DIRECTIVE="SET_DEFAULT_RELEASE_DIRECTIVE",o.UNSET_RELEASE_DIRECTIVE="UNSET_RELEASE_DIRECTIVE",o.MODIFY_RELEASE_DIRECTIVE="MODIFY_RELEASE_DIRECTIVE",o.REGISTER_VERSION="REGISTER_VERSION",o.DEREGISTER_VERSION="DEREGISTER_VERSION",o)},365222:function(e,t,n){n.d(t,{X:()=>r});var o,r=((o={}).list="list",o.byid="byid",o.forwardId="forwardid",o)},739732:function(e,t,n){n.d(t,{d:()=>r});var o,r=((o={}).EDIT="EDIT",o.PUBLISH="PUBLISH",o.UNPUBLISH="UNPUBLISH",o)},60501:function(e,t,n){n.d(t,{j:()=>r});var o=n(365222);function r(e){return(null==e?void 0:e.resultType)===o.X.byid}},832072:function(e,t,n){n.d(t,{D:()=>r});var o=n(641392);function r(e){return(null==e?void 0:e.loadState)===o.p.error&&void 0==e.result&&void 0==e.resultType}},227533:function(e,t,n){n.d(t,{g:()=>r});var o=n(365222);function r(e){return(null==e?void 0:e.resultType)===o.X.list}},3291:function(e,t,n){n.d(t,{M:()=>r});var o=n(641392);function r(e){return(null==e?void 0:e.loadState)===o.p.loading}},649957:function(e,t,n){n.d(t,{O:()=>o});function o(e){return!!(null==e?void 0:e.isRefreshing)}},481642:function(e,t,n){n.d(t,{l:()=>r});var o,r=((o={}).ADD="ADD",o.REMOVE="REMOVE",o.CLEAR="CLEAR",o)},610329:function(e,t,n){n.d(t,{G:()=>a,z:()=>i});var o,r,i=((o={}).START="START",o.STOP="STOP",o.RESTART="RESTART",o.RESET="RESET",o.PAUSE="PAUSE",o),a=((r={}).IDLE="IDLE",r.RETRYING="RETRYING",r.PAUSED="PAUSED",r)},561993:function(e,t,n){n.d(t,{i:()=>a});var o=n(467131),r=n(587393),i=n(610329);function a(e,t,n){let a,l=0,s=0,c=0,u=1,{maxRetries:d=20,exponent:f=1.5,interval:E=1,constantRetryTimeInSec:p,maxBackOffIntervalInSec:b=45,shouldPauseOnInactive:y=!0,enableBackOffOnPollingFailures:g=!1,maxPollingFailuresBeforeBackOff:S=5,enforceMaxRetryOnConsecutivePollFailures:O=!1}=n||{},h=null==n?void 0:n.customBackOffTimer,m=e,_=i.G.IDLE,I={[i.z.STOP]:[]},T=()=>"hidden"===document.visibilityState&&_===i.G.RETRYING?void P(i.z.PAUSE):"visible"===document.visibilityState&&_===i.G.PAUSED?void P(i.z.RESTART):void 0,v=()=>{y&&document.removeEventListener("visibilitychange",T,!1)},R=0,C=()=>{clearTimeout(l),u=1,l=0,s=0,R=0,a=void 0},N=()=>{let e=u>d&&!p||R>d&&O;I[i.z.STOP].forEach(t=>t(e,a))},A=e=>{let t=e;if(h){let t=Math.max(c,h(e,u,R,n));return c=0,t}!p||p&&R>=S?(t+=Number(Math.pow(E*f,g?R:u).toFixed(2)),t=Math.min(t,b)):t=p;let r=c>t?c:t;return c>0&&o.cM.info(`Retriable backoff set: ${r} ${new Date}`),c=0,r},w=async()=>{if(_===i.G.RETRYING){if((null==t?void 0:t.isUserIdle())&&y){o.cM.info("Retriable User idle. Skipping retry"),s||(s=A(s)),l=window.setTimeout(w,1e3*s);return}if(u>d&&!p)return o.cM.info("Retriable Max retries reached. Stopping retries"),k(i.G.IDLE);try{await m(),R=0,a=void 0}catch(e){o.cM.error(Error(`Retriable Async function execution failed with: ${e}`)),e instanceof r.M&&(c=e.retryAfterMs/1e3,o.cM.info(`Retriable Have Http429, setting "minBackoffTimeFrom429" to ${c} ${new Date}`)),R+=1,a=e}if(O&&R>d)return o.cM.info("Retriable Max retries reached. Stopping retries"),k(i.G.IDLE);_===i.G.RETRYING&&(u+=1,s=A(s),l=window.setTimeout(w,1e3*s))}},L={[i.G.IDLE]:{[i.G.RETRYING]:{action:[w,()=>{y&&document.addEventListener("visibilitychange",T,!1)}]}},[i.G.PAUSED]:{[i.G.IDLE]:{action:[N,C,v]},[i.G.RETRYING]:{action:w}},[i.G.RETRYING]:{[i.G.IDLE]:{action:[N,C,v]},[i.G.PAUSED]:{action:()=>clearTimeout(l)}}},k=e=>{if(L[_][e]){let t=L[_][e];_=e,t&&("function"==typeof t.action&&t.action(),Array.isArray(t.action)&&t.action.map(e=>e()))}},P=(e,t)=>{switch(e){case i.z.RESTART:k(i.G.IDLE),k(i.G.RETRYING);break;case i.z.STOP:k(i.G.IDLE);break;case i.z.START:k(i.G.RETRYING);break;case i.z.PAUSE:k(i.G.PAUSED);break;case i.z.RESET:{let e=_;k(i.G.IDLE);let{asyncFunction:n,retriableOptions:o}=t||{};n&&(m=n),o&&(d=o.maxRetries||d,f=o.exponent||f,E=o.interval||E,p=o.constantRetryTimeInSec||p,b=o.maxBackOffIntervalInSec||b,y=o.shouldPauseOnInactive||y,g=o.enableBackOffOnPollingFailures||g,S=o.maxPollingFailuresBeforeBackOff||S,O=o.enforceMaxRetryOnConsecutivePollFailures||O),k(e)}break;default:throw`Unrecognized event: ${e}`}};return{start:()=>P(i.z.START),stop:()=>P(i.z.STOP),restart:()=>P(i.z.RESTART),reset:e=>P(i.z.RESET,e),currentState:()=>_,onStop:e=>(I[i.z.STOP].includes(e)||I[i.z.STOP].push(e),()=>{let t=I[i.z.STOP].indexOf(e);-1!==t&&I[i.z.STOP].splice(t,1)})}}},493098:function(e,t,n){n.d(t,{IG:()=>E,cf:()=>f,cs:()=>b});var o,r=n(184168),i=n(751544),a=n(77822),l=n(429207),s=n(336902),c=n(100591),u=n(233174),d=n(499924),f=((o={}).WEB_SOCKET_LOGGING="WEB_SOCKET_LOGGING",o.NOTEBOOK_EDIT_LOCK_CHECK="NOTEBOOK_EDIT_LOCK_CHECK",o.NOTEBOOK_EDIT_STATUS_SHORT_POLL="NOTEBOOK_EDIT_STATUS_SHORT_POLL",o);function E(e){return"true"===localStorage.getItem(p(e))}function p(e){return`debug:${e}`}function b({onHide:e}){let t=(0,d.useRef)(null),[n,o]=(0,i._)(p("WEB_SOCKET_LOGGING"),!1),[f,E]=(0,i._)(p("NOTEBOOK_EDIT_LOCK_CHECK"),!1),[b,y]=(0,i._)(p("NOTEBOOK_EDIT_STATUS_SHORT_POLL"),!1);return(0,r.jsxs)(a.Vq,{manuallyShown:!0,causalElement:t,onHide:e,children:[(0,r.jsx)(a.fK,{children:"Debug menu"}),(0,r.jsxs)(a.a7,{children:[(0,r.jsxs)(l.X,{align:"justify",children:[(0,r.jsx)(s._,{htmlFor:"log-web-socket-setting",children:"Log web socket messages"}),(0,r.jsx)(c.r,{id:"log-web-socket-setting",checked:n,onChange:()=>o(!n),value:"1"})]}),(0,r.jsxs)(l.X,{align:"justify",marginTop:12,children:[(0,r.jsx)(s._,{htmlFor:"log-notebook-edit-lock-check",children:"Log notebook concurrent edit check"}),(0,r.jsx)(c.r,{id:"log-notebook-edit-lock-check",checked:f,onChange:()=>E(!f),value:"1"})]}),(0,r.jsxs)(l.X,{align:"justify",verticalAlign:"middle",marginTop:12,children:[(0,r.jsx)(s._,{htmlFor:"log-notebook-edit-lock-poll",children:"Use short poll frequency for notebook edit status (10s)"}),(0,r.jsx)(c.r,{id:"log-notebook-edit-lock-poll",checked:b,onChange:()=>y(!b),value:"1"})]})]}),(0,r.jsx)(a.cN,{children:(0,r.jsx)(u.zx,{use:"primary",onClick:e,children:"Close"})})]})}b.displayName="DebugMenuDialog"},408015:function(e,t,n){n.d(t,{c:()=>o});function o(e){return`${e.format("YYYY-MM-DD")}T00:00:00Z`}},677967:function(e,t,n){n.d(t,{f:()=>i});var o=n(767793),r=n(860194);let i=(e,t)=>(0,o.d)(e)?"month":(0,r.e)(e)||t?"day":"hour"},316758:function(e,t,n){n.d(t,{A:()=>o});function o(e){let t=e.endDate.clone().add(1,e.unitOfTime);return{lowerBound:e.startDate.clone(),upperBound:t}}},767793:function(e,t,n){n.d(t,{d:()=>o});function o({startDate:e,endDate:t}){return t.diff(e,"months",!0)>6}},860194:function(e,t,n){function o({startDate:e,endDate:t}){return t.diff(e,"days")>7}function r({startDate:e,endDate:t}){return t.diff(e,"days")>0}n.d(t,{e:()=>o,f:()=>r})},934835:function(e,t,n){n.d(t,{l:()=>function e(t,n){return r()(t)?t.map(t=>e(t,n)):a()(t)?s()(u()(t,t=>e(t,n)),(e,t)=>n(t)):t}});var o=n(268598),r=n.n(o),i=n(303266),a=n.n(i),l=n(84676),s=n.n(l),c=n(297561),u=n.n(c)},709711:function(e,t,n){n.d(t,{CZ:()=>p,LU:()=>E,pD:()=>u,q$:()=>d,qv:()=>f,uf:()=>c});var o=n(794221),r=n.n(o),i=n(759388),a=n.n(i);let l=[["",1],["K",1e3],["M",1e6],["B",1e9],["T",1e12]],s=(e=0)=>0===e?"0,0":`0,0.${"0".repeat(e)}`,c=(e,t=1)=>{let n=r()(e)?0:t;return a()(e).format(s(n))};function u(e,t=!1){let n=0;e>=3600&&(n=Math.floor(e/3600));let o="";return n>0&&(o+=String(n),t?(o+=" hour",n>1&&(o+="s")):o+="h"),o}function d(e,t=!1){let n=0;e>=60&&(n=Math.floor(e/60));let o="";return n>0&&(o+=String(n),t?(o+=" minute",n>1&&(o+="s")):o+="m"),o}function f(e){return e>=1e3?E(e/1e3):`${e.toFixed(0)}ms`}function E(e,t=!1,n=!1){let o=e,r=u(o,t);r.length&&(r+=" ");let i=+(o<10);o>=3600&&(o%=3600);let a=d(o,t);return a.length&&(r+=`${a} `),o>=60&&(o%=60),t?(n&&r.length&&(r+="and "),o>=60?r+=`${o.toFixed(i)} second`:Number.isInteger(o)?r+=`${o} second`:r+=`${o.toFixed(i)} second`,o>1&&(r+="s")):r+=`${o.toFixed(i)}s`,r}let p=(e,t,n)=>b(e,t,n,l),b=(e,t,n,o)=>{let r=0,i="";if(e<0)return"";for(let t=o.length-1;t>=0;t--)if(e/o[t][1]>=1){i=o[t][0],r=o[t][1];break}0===r&&(r=1);let a=c(e/(r||1),t)+i;return n&&1!==r?`${a} (${c(e,t)})`:a}},371743:function(e,t,n){n.d(t,{J:()=>i});var o=n(581775),r=n(516727);function i(e,t){let n=(0,o.v)(e);if(7!==n.length)throw Error(`Invalid identifier: '${e}'`);let i=n[1],a=n[3],l=n[5];return{type:t,database:(0,r.b)(i),schema:(0,r.b)(a),name:(0,r.b)(l)}}},931147:function(e,t,n){n.d(t,{m:()=>i});let o=/(\([^\(\)]+\))\s*RETURN/u,r=/(\(.+\))\s*/u;function i(e){if(!e)return"";let t=e.match(o),n=e.match(r);return t&&t.length>1?t[1]:n&&n.length>1?function(e){let t=e;if(!t)return"";let n=t.indexOf(" RETURN");if(-1===n&&(n=t.length),-1===(n=(t=t.slice(0,n)).lastIndexOf(")"))||-1===(n=t.lastIndexOf(")")))return"()";let o=n-1,r=1;for(;o>=0&&r>0;)")"===t[o]?r+=1:"("===t[o]&&(r-=1),o-=1;return 0!==r?"()":t.slice(o+1,n+1)||"()"}(e):"()"}},884407:function(e,t,n){n.d(t,{L:()=>r});var o=n(931147);function r(e){if(!e)return{name:"",args:""};let t=(0,o.m)(e),n=e.indexOf(t);return -1===n?{name:e,args:"()"}:{args:t,name:e.slice(0,n)}}},150543:function(e,t,n){n.d(t,{$:()=>i});var o=n(470946),r=n(645807);function i(e){let{database:t,schema:n,name:i}=e;return[t,n,i].map(e=>(0,r.v)((0,o.H)(e))).join(".")}},581775:function(e,t,n){n.d(t,{v:()=>o});function o(e){return e.split(/((?:[^."]|"(?:[^"]|"")*")+)/u)}},988209:function(e,t,n){n.d(t,{S:()=>o});function o(e){if(!!e!==e)throw Error("Didn't pass a boolean");return{bindingsJSONRepr:e,inlineRepr:String(e)}}},971478:function(e,t,n){n.d(t,{j:()=>o});function o(e){if(!/^[A-Za-z0-9_]+(\([0-9, ]+\))?$/u.test(e))throw Error(`String is not a valid datatype: ${e}`);return{inlineRepr:e}}},253833:function(e,t,n){n.d(t,{e:()=>o});function o(e){if(!e.match(/^[A-Za-z_][A-Za-z_0-9]*$/))throw Error(`String is not a valid keyword: ${e}`);return{inlineRepr:e}}},610280:function(e,t,n){n.d(t,{a:()=>o});function o(e){if(!e.match(/^[A-Za-z_][A-Za-z0-9_ ]*$/))throw Error(`String is not a valid set of keywords: ${e}`);return{inlineRepr:e}}},833030:function(e,t,n){n.d(t,{_:()=>o});function o(e){if(!Number.isFinite(e))throw Error("Didn't pass a finite number");return{bindingsJSONRepr:e,inlineRepr:String(e)}}},802402:function(e,t,n){n.d(t,{M:()=>o});function o(e){return{inlineRepr:e}}},11043:function(e,t,n){n.d(t,{Q:()=>r});var o=n(150543);function r(e){let t=`'@${(0,o.$)(e)}'`;return{bindingsJSONRepr:t,inlineRepr:t}}},657452:function(e,t,n){n.d(t,{F:()=>i});var o=n(470946),r=n(150543);function i(e,t){let n=`'@${(0,r.$)(e)}/${(0,o.H)(t)}'`;return{bindingsJSONRepr:n,inlineRepr:n}}},72949:function(e,t,n){n.d(t,{K:()=>r});var o=n(470946);function r(e){return{inlineRepr:e.map(e=>`'${(0,o.H)(e)}'`).join(",")}}},223819:function(e,t,n){n.d(t,{t:()=>r});var o=n(645807);let r=e=>{let t=(0,o.v)(e);return{bindingsJSONRepr:t,inlineRepr:t}}},944799:function(e,t,n){n.d(t,{Z:()=>r});var o=n(772598);function r(e,t){let n=o.$w(e,t);return{inlineRepr:`$$${n}$$`}}},802118:function(e,t,n){n.d(t,{RT:()=>l,Z2:()=>a,ZL:()=>i});var o,r=n(516727),i=((o={}).OnlyWhenFullySurrounding="onlyWhenFullySurrounding",o.WhenAtLeastOnOneSide="whenAtLeastOnOneSide",o);function a(e,t="onlyWhenFullySurrounding"){return e?l(e,t):e}function l(e,t="onlyWhenFullySurrounding"){let n,o=(0,r.b)(e);if(e!==o)return o;return n=e,"whenAtLeastOnOneSide"===t&&n?('"'===n.charAt(0)&&(n=n.substr(1,n.length-1)),'"'===n.charAt(n.length-1)&&(n=n.substr(0,n.length-1))):n&&'"'===n.charAt(0)&&'"'===n.charAt(n.length-1)&&(n=n.substr(1,n.length-2)),n}},902417:function(e,t,n){n.d(t,{U:()=>u});var o=n(51723),r=n(975477),i=n.n(r),a=n(499924),l=n(475165),s=n(750671),c=n(254759);function u(e,t,n,r){var u;let d=a.useContext(c.L),f=(0,s.h)(null==d||null==(u=d.user)?void 0:u.api,"UserStore is not loaded"),E=a.useContext(o.TelemetryPerformanceContext);return(0,a.useMemo)(()=>({executeQuery:(o,a,s,c,u)=>{var d,p,b,y,g,S,O,h,m;return d=f,p=o,b=e,y=n,g=a,S=s,O=c,h=r,m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({profiler:E,secondaryRoles:t},u),(0,l.O)(h,{getCacheKey:()=>{var e;let t={sqlQuery:p,currentRole:b,currentWarehouse:y,description:g,fetchId:S,hideFromQueryHistory:O,secondaryRoles:null==m?void 0:m.secondaryRoles},n=null==m||null==(e=m.requestContext)?void 0:e.userKey;return n&&(t[n]=n),i()(t)},getData:async()=>{var e;let t=null==m||null==(e=m.profiler)?void 0:e.group(`executeSqlQuery:${g}`);null==t||t.addContext("role",b),null==t||t.addContext("warehouse",y),null==t||t.addContext("sqlText",p.sqlText),null==t||t.addContext("pid",null==m?void 0:m.pid);try{return null==t||t.start(),{tableData:await d.query(p,{isInternal:O,role:b,warehouse:y,desc:g,context:null==m?void 0:m.context,requestContext:null==m?void 0:m.requestContext,pid:null==m?void 0:m.pid,secondaryRoles:null==m?void 0:m.secondaryRoles}),timestamp:new Date(Date.now())}}finally{null==t||t.end()}}})}}),[f,r,E,e,t,n])}},782649:function(e,t,n){n.d(t,{O:()=>f,l:()=>E});var o=n(237257),r=n(975477),i=n.n(r),a=n(499924),l=n(475165),s=n(433915),c=n(854162),u=n(172274),d=n(702268);let[f,E]=(0,o.Z)(()=>(function(){let e=(0,s.b)(),t=(0,a.useCallback)(async(t,n,o,r=c.U.urc.requestContext())=>{var i;let a=await (0,l.O)(e,{getCacheKey:()=>{var e;return p(t,n,o,null!=(e=r.role)?e:"")},getData:async()=>await (0,u._)(t,n,o,r)});return e.clearEntry(p(t,n,o,null!=(i=r.role)?i:"")),a},[e]),n=(0,a.useCallback)(async(t,n,o,r,i=c.U.urc.requestContext())=>{let a=await (0,d.u)(t,n,o,r,i);if(a.success){var l;e.clearEntry(p(t,n,o,null!=(l=i.role)?l:""))}return a},[e]);return(0,a.useMemo)(()=>({read:t,write:n}),[t,n])})());function p(e,t,n,o){return i()({role:o,stage:e,path:t,fileName:n})}},168333:function(e,t,n){n.d(t,{J:()=>c,R:()=>u});var o=n(609737),r=n(117043),i=n(11043),a=n(392313);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}let s="/files/download";async function c(e,t,n,i){return(0,a.a)()?await function(e,t,n,i={}){var a,c;let u=o.flags._DP_DISABLE_DEFAULT_REQUEST_CONTEXT_FOR_STAGE_FILE_OPERATIONS(),d={stage:e,filePath:t,role:u?n.role:null!=(a=n.role)?a:"PUBLIC",secondaryRoles:u?n.secondaryRoles:null!=(c=n.secondaryRoles)?c:"ALL"};return(0,r.nufetchForm)(s,n,{body:JSON.stringify(d),method:"POST",headers:l({"Content-Type":"application/json"},i)},"/v1")}(e,t,n,i):await function(e,t,n,i){var a,c,u,d,f;let E=o.flags._DP_DISABLE_DEFAULT_REQUEST_CONTEXT_FOR_STAGE_FILE_OPERATIONS(),p=new FormData;return p.set("stage",e),p.set("relativePath",t),p.set("allowUnencryptedReadWrite","true"),E?n.secondaryRoles&&p.set("secondaryRoles",n.secondaryRoles):p.set("secondaryRoles",null!=(a=n.secondaryRoles)?a:"ALL"),(0,r.nufetchForm)(s,E?n:(d=l({},n),f=f={role:null!=(c=n.role)?c:"PUBLIC",secondaryRoles:null!=(u=n.secondaryRoles)?u:"ALL"},Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(f)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(f)).forEach(function(e){Object.defineProperty(d,e,Object.getOwnPropertyDescriptor(f,e))}),d),l({method:"POST",body:p},i?{headers:i}:{}))}(e,t,n,i)}function u(e){return(0,i.Q)(e).inlineRepr}},392313:function(e,t,n){n.d(t,{a:()=>r,z:()=>i});var o=n(740591);function r(){return o.IL.services.featureFlags.isEnabled("UI_ENABLE_WAW_DEX_FEATURE_12")}function i(){return o.IL.services.featureFlags.isEnabled("UI_ENABLE_WAW_DEX_FEATURE_13")}},447978:function(e,t,n){n.d(t,{L:()=>r});var o=n(407486);function r(e,t){return(0,o.Vo)([e,t],!0)}},407486:function(e,t,n){function o(e){return e?e.startsWith("/")?e:`/${e}`:""}function r(e,t=!1){let n=e.map(e=>e?e.replace(/^\/|\/$/gu,""):"").filter(e=>""!==e).join("/");return t?`/${n}`:n}n.d(t,{Vo:()=>r,yx:()=>o})},172274:function(e,t,n){n.d(t,{J:()=>l,_:()=>a});var o=n(854162),r=n(168333),i=n(447978);async function a(e,t,n,l=o.U.urc.requestContext()){try{let o=await (0,r.J)(e,(0,i.L)(t,n),l,{Accept:"text/plain"});return{success:!0,content:o.textContent,error:null}}catch(e){if(e instanceof Error)return{success:!1,error:e,content:null};return{success:!1,error:Error("Unknown Error"),content:null}}}async function l(e){let{success:t,error:n,content:o}=await e;if(t)return o;throw n}},702268:function(e,t,n){n.d(t,{g:()=>u,u:()=>d});var o=n(609737),r=n(117043),i=n(854162),a=n(392313),l=n(407486);function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function c(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}async function u(e,t,n,d,f=i.U.urc.requestContext()){var E,p,b;let y=o.flags._DP_DISABLE_DEFAULT_REQUEST_CONTEXT_FOR_STAGE_FILE_OPERATIONS(),g=new FormData;if(g.set("stage",e),g.set("path",(0,l.yx)(t)||"/"),f.secondaryRoles&&g.set("secondaryRoles",f.secondaryRoles),(0,a.z)()){g.set("fileName",n),y?f.role&&g.set("role",f.role):g.set("role",null!=(E=f.role)?E:"PUBLIC");let e=new URLSearchParams;g.forEach((t,n)=>{e.append(n,t.toString())});let t=`/files/upload?${e.toString()}`;await (0,r.nufetchForm)(t,y?f:c(s({},f),{role:null!=(p=f.role)?p:"PUBLIC"}),{method:"POST",body:d,headers:{"Content-Type":"application/octet-stream",Accept:"text/plain"}},"/v1")}else g.set("file",new File([d],n)),await (0,r.nufetchForm)("/files/upload",y?f:c(s({},f),{role:null!=(b=f.role)?b:"PUBLIC"}),{method:"POST",body:g})}async function d(e,t,n,o,r=i.U.urc.requestContext()){try{return await u(e,t,n,o,r),{success:!0,error:null}}catch(e){if(e instanceof Error)return{success:!1,error:e};return{success:!1,error:Error("Unknown Error")}}}},336400:function(e,t,n){n.d(t,{k:()=>i});var o=n(499924),r=n(254759);function i(e){let t=(0,r.m)(["user"]).user;return(0,o.useMemo)(()=>!!t&&t.userRequestContext(e),[t,e])}},964743:function(e,t,n){n.d(t,{Z:()=>s});var o=n(467131),r=n(485387),i=n.n(r),a=n(805018),l=n(609290);let s=new class{registerEventListeners(){document.addEventListener("mousemove",this.onGlobalMouseMoveDebounced),document.addEventListener("mousedown",this.onGlobalMouseDownDebounced),document.addEventListener("visibilitychange",this.onVisibilityChangeHandler)}unregisterEventListeners(){document.removeEventListener("mousemove",this.onGlobalMouseMoveDebounced),document.removeEventListener("mousedown",this.onGlobalMouseDownDebounced),document.removeEventListener("visibilitychange",this.onVisibilityChangeHandler),this.stopUserSessionValidityCheck()}constructor(e={}){this.registerUserActivityListener=e=>{this.onUserActivityListeners.push(e),this.validityCheckTimer||this.registerEventListeners()},this.unregisterUserActivityListener=e=>{this.onUserActivityListeners=this.onUserActivityListeners.filter(t=>t!==e),this.onUserActivityListeners.length||this.unregisterEventListeners()},this.onVisibilityChangeHandler=()=>{"hidden"===document.visibilityState&&(o.cM.info("Tracker: Turning off timers"),this.stopUserSessionValidityCheck()),"visible"===document.visibilityState&&(o.cM.info("Tracker: Turning on timers"),this.startUserSessionValidityCheck())},this.isUserIdle=()=>(this.lastView?i()().diff(this.lastView):6e4)>6e4,this.checkForSessionValidity=async()=>{let e=this.lastView?i()().diff(this.lastView):6e4,t=window.location.pathname;if("/"==t&&(t=""),e>6e4){o.cM.info("Tracker: Check","Checking session with bootstrap activity");try{await l.U.checkUserSession()}catch(e){o.cM.error(e,{message:"User session check failed."});return}}this.validityCheckTimer=window.setTimeout(this.checkForSessionValidity,6e4)},this.startUserSessionValidityCheck=()=>{this.validityCheckTimer||this.checkForSessionValidity()},this.stopUserSessionValidityCheck=()=>{this.validityCheckTimer&&clearTimeout(this.validityCheckTimer),this.validityCheckTimer=null},this.view=async()=>{this.lastView=i()(),this.onUserActivityListeners&&this.onUserActivityListeners.map(e=>e(this.lastView))},this.onGlobalMouseMove=()=>{this.view()},this.onGlobalMouseDown=()=>{this.view()},this.lastView=i()(),this.onUserActivityListeners=e.onViewListeners||[],this.onGlobalMouseMoveDebounced=(0,a.D)(this.onGlobalMouseMove,100),this.onGlobalMouseDownDebounced=(0,a.D)(this.onGlobalMouseDown,100),this.registerEventListeners()}}},962689:function(e,t,n){n.d(t,{fc:()=>s,xK:()=>c,zp:()=>l});var o=n(500140),r=n(499924),i=n(561993),a=n(964743);function l(e,t={}){let{pollingIntervalInSec:n=10,maxBackOffIntervalInSec:o=45,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:s,maxPollingFailuresBeforeBackOff:c}=t;return(0,i.i)(e,a.Z,{maxRetries:1/0,constantRetryTimeInSec:n,maxBackOffIntervalInSec:o,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:s,maxPollingFailuresBeforeBackOff:c})}function s(e,t={}){let[n]=r.useState(l(e,t)),i=(0,o.N)(t);return r.useEffect(()=>{let{pollingIntervalInSec:t=10,maxBackOffIntervalInSec:o=45,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:a,maxPollingFailuresBeforeBackOff:l}=i;n.reset({asyncFunction:e,retriableOptions:{constantRetryTimeInSec:t,maxBackOffIntervalInSec:o,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:a,maxPollingFailuresBeforeBackOff:l}})},[e,i]),r.useEffect(()=>()=>{n.stop()},[n]),n}function c(e,t){let{maxRetries:n,shouldPauseOnInactive:o,enforceMaxRetryOnConsecutivePollFailures:r}=t;return(0,i.i)(e,a.Z,{maxRetries:n,shouldPauseOnInactive:o,enforceMaxRetryOnConsecutivePollFailures:r})}},254759:function(e,t,n){n.d(t,{L:()=>l,m:()=>c});var o=n(500140),r=n(257606),i=n(499924),a=n(621335);let l=i.createContext(void 0),s=()=>{};function c(e,t=s,n=a.I){var u,d;let f=i.useContext(l),E=(0,o.N)(e.reduce((e,t)=>(e[t]=f[t],e),{})),p=(0,o.N)(Object.keys(E).map(e=>E[e])),b=(0,o.N)((u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},E),d=d={untracked:f},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(d)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(d)).forEach(function(e){Object.defineProperty(u,e,Object.getOwnPropertyDescriptor(d,e))}),u)),y=i.useCallback((e,n)=>{t(e,b,n)},[t,b]),g=(0,r.N)(),S=i.useCallback((e,t)=>{n(e,t)&&g()},[g,n]);return i.useEffect(()=>(p.forEach(e=>{e.__subscribe(y,S)}),()=>p.forEach(e=>{e.__unsubscribe(y,S)})),[p,y,S]),b}},551276:function(e,t,n){n.d(t,{d:()=>a});var o=n(609737),r=n(499924),i=n(238257);let a=()=>(0,r.useCallback)(()=>!!o.flags.UI_ENABLE_IS_PRIVATELINK_OVERRIDE_FOR_INTERNAL_TEST()||(0,i.r)(window.location.hostname),[])},927514:function(e,t,n){n.d(t,{T:()=>s});var o=n(374318),r=n(993914),i=n(482148),a=n(13715),l=n(42218);let s=({error:e,isUserError:t})=>{let n,s,c;if(e instanceof a.Z?n=e.payload:e instanceof l.a||e instanceof Error?n=e.message:"string"==typeof e?n=e:null!=e&&(n="unknown error"),e instanceof o.M){if(s=e.logDetailMessage,!(c=e.externalErrorCause.code)&&e.message){let t=e.message.match(/^(\d+):/u);t&&(c=t[1])}}else e instanceof i.P?c=e.errorCode:e instanceof a.Z?c=e.topic.toString():e instanceof l.a&&(s=e.errors.map(e=>e.message).join(", "));return{error:n,isUserError:t||(0,r.e)(e),errorDetail:s,errorCode:c}}},689708:function(e,t,n){n.d(t,{aR:()=>l,ho:()=>a,ur:()=>i});let o="streamlit-",r=["embed","embed_options","__parentOrigin","__clientVersion"];function i(e){let t=new URLSearchParams;for(let[n,o]of e)!r.includes(n)&&n.length>0&&t.append(n,o);return t}function a({snowsightQueryParams:e,iframeQueryParams:t}){let n=new URLSearchParams;for(let[t,r]of e)t.startsWith(o)||n.append(t,r);for(let[e,r]of i(t))n.append(`${o}${e}`,r);return n}function l(e){let t=new URLSearchParams;for(let[n,r]of e)if(n.startsWith(o)){let e=n.replace(o,"");e.length>0&&t.append(e,r)}return i(t)}},65662:function(e,t,n){n.d(t,{Du:()=>l,FF:()=>g,Sz:()=>E,VP:()=>f,YT:()=>c,fY:()=>s,fe:()=>u,hk:()=>y,mR:()=>b,s9:()=>p,zL:()=>d});var o=n(690908),r=n(67158),i=n(988209),a=n(94587);function l({fullStreamlitIdentifier:e,isPrivatelink:t}){let n=new o.L().add("CALL SYSTEM$GENERATE_STREAMLIT_URL_FROM_NAME({}",(0,a.i)((0,r.m)(e)));return n.add(", {}",(0,i.S)(t)),n.add(");"),n.toQuery()}function s(e){return new o.L().add("CALL SYSTEM$GENERATE_STREAMLIT_TOKEN({});",(0,a.i)((0,r.m)(e))).toQuery()}function c(e){return new o.L().add("CALL SYSTEM$GET_STREAMLIT_API_TOKEN({});",(0,a.i)((0,r.m)(e))).toQuery()}function u(e){return new o.L().add("CALL SYSTEM$STREAMLIT_RELOAD({});",(0,a.i)((0,r.m)(e))).toQuery()}function d(e,t){return new o.L().add("CALL SYSTEM$ASSOCIATE_STAGE_WITH_STREAMLIT({}, {});",(0,a.i)((0,r.m)(e)),(0,a.i)((0,r.m)(t))).toQuery()}function f(e){return new o.L().add("CALL SYSTEM$STREAMLIT_RERUN({});",(0,a.i)((0,r.m)(e))).toQuery()}function E(e,t,n={}){return new o.L().add("CALL SYSTEM$LOG_STREAMLIT_TELEMETRY({},{},{});",(0,a.i)(null===e?"":(0,r.m)(e)),(0,a.i)(t),(0,a.i)(JSON.stringify(n))).toQuery()}function p(e,t){return new o.L().add("CALL SYSTEM$LOG_STREAMLIT_TELEMETRY_BATCH({},{});",(0,a.i)(null===e?"":(0,r.m)(e)),(0,a.i)(JSON.stringify(t))).toQuery()}function b({fullStreamlitIdentifier:e,appViewRequestId:t,isPrivatelink:n,historyQueryId:l}){let s=new o.L().add("CALL SYSTEM$STREAMLIT_BOOTSTRAP({}",(0,a.i)((0,r.m)(e))),c=(0,a.i)(null!=t?t:""),u=[{param:c,couldIgnore:!t},{param:(0,i.S)(n),couldIgnore:!1},{param:(0,a.i)(null!=l?l:""),couldIgnore:!l}];return u.slice(0,u.findLastIndex(e=>!e.couldIgnore)+1).forEach(e=>s.add(", {}",e.param)),s.add(");"),s.toQuery()}function y(e){return new o.L().add("CALL SYSTEM$STREAMLIT_BOOTSTRAP_STARTUP_STATUS({});",(0,a.i)((0,r.m)(e))).toQuery()}function g({srcStreamlitIdentifier:e,newStreamlitName:t,newStreamlitTitle:n}){return new o.L().add("CALL SYSTEM$DUPLICATE_STREAMLIT_WITHOUT_EMBEDDED_STAGE({}, {}, {});",(0,a.i)((0,r.m)(e)),(0,a.i)(t),(0,a.i)(n)).toQuery()}},689398:function(e,t,n){n.d(t,{$g:()=>y,AU:()=>C,C1:()=>A,EX:()=>D,F2:()=>p,I:()=>V,I1:()=>M,JI:()=>N,Jd:()=>i,MI:()=>g,Wh:()=>L,YL:()=>a,Yb:()=>j,ZR:()=>k,_t:()=>S,_y:()=>R,b2:()=>v,bH:()=>E,c:()=>c,cQ:()=>O,dr:()=>B,fY:()=>G,gN:()=>h,gf:()=>T,kL:()=>I,lO:()=>w,lU:()=>x,nQ:()=>l,p0:()=>r,pN:()=>F,qE:()=>u,qK:()=>U,rc:()=>P,sB:()=>_,tS:()=>d,tt:()=>f,uy:()=>b,wd:()=>m,x3:()=>s});var o=n(609737);function r(){return o.flags.UI_ENABLE_STREAMLIT_HIDE_PREVIEW_PILL()}function i(){return o.flags.FEATURE_UI_ENABLE_STREAMLIT_CONFIG_TOML()}function a(){return o.flags.UI_ENABLE_STREAMLIT_QUERY_PARAMS()}function l(){return o.flags.UI_ENABLE_STREAMLIT_SUB_PAGE_LINKS()}function s(){return o.flags.UI_ENABLE_STREAMLIT_EMBEDDED_STAGES()}function c(){return o.flags.ENABLE_STREAMLIT_VERSIONED_STAGE()}function u(){return o.flags.UI_ENABLE_STREAMLIT_WITH_SNOWSIGHT_THEME()}function d(){return o.flags.UI_ENABLE_STREAMLIT_NEW_MENU_BUTTON()}function f(){return o.flags.UI_ENABLE_STREAMLIT_SEND_THEME_POST_MESSAGE_ON_SCRIPT_STATE_CHANGED()}function E(){return o.flags.FEATURE_UI_ENABLE_STREAMLIT_SCHEDULING()}function p(){return o.flags.UI_ENABLE_STREAMLIT_THEMING()}function b(){return o.flags.UI_ENABLE_STREAMLIT_DEBUG_CONSOLE_LOGGING_FOR_TESTING()}function y(){return o.flags.UI_ENABLE_STREAMLIT_DEBUG_FATAL_EXCEPTION_OVERRIDE_FOR_TESTING()}function g(){return o.flags.UI_ENABLE_STREAMLIT_ON_SPCS()}function S(){return o.flags.UI_ENABLE_STREAMLIT_PREAMBLE_CSP_VIOLATION_DETECTION()}function O(){return o.flags.UI_ENABLE_STREAMLIT_PREAMBLE_SERVICE_WORKER()}function h(){return o.flags.UI_ENABLE_STREAMLIT_BATCH_TELEMETRY_ENDPOINT()}function m(){return o.flags.UI_ENABLE_STREAMLIT_PIPE_TELEMETRY_TO_BATCH_ENDPOINT()}function _(){return o.flags.STREAMLIT_BATCH_TELEMETRY_QUEUE_THROTTLE_IN_MS()}function I(){return o.flags.UI_ENABLE_STREAMLIT_INDIVIDUAL_LOAD_METRICS()}function T(){return o.flags.ENABLE_STREAMLIT_SERVICE_WORKER()}function v(){return o.flags.ENABLE_STREAMLIT_ALLOW_FILE_UPLOADER()}function R(){return o.flags.UI_ENABLE_STREAMLIT_LOAD_SEQUENCE_IN_SNOWSIGHT()}function C(){return o.flags.UI_ENABLE_STREAMLIT_DISPLAY_SPCS_DETAILED_LOAD_SEQUENCE()}function N(){return o.flags.UI_ENABLE_STREAMLIT_RESTRICTED_CALLERS_RIGHTS()}function A(){return o.flags.UI_ENABLE_STREAMLIT_INITIAL_RETRY_SKIP()}function w(){return o.flags.UI_ENABLE_STREAMLIT_CONSUME_SLEEP_TIMER_DURATION_FROM_BOOTSTRAP()}function L(){return o.flags.FEATURE_COPILOT_STREAMLIT()}function k(){return o.flags.UI_ENABLE_MLPF_FEATURE_16()}function P(){return o.flags.UI_ENABLE_STREAMLIT_FEATURE_2()}function D(){return o.flags.UI_ENABLE_STREAMLIT_APP_STATE_MACHINE()}function M(){return o.flags._DP_UI_ENABLE_STREAMLIT_LOG_TELEMETRY_TO_DATADOG_RUM()}function U(){return o.flags._DP_UI_ENABLE_STREAMLIT_LIST_VIEW_RUNTIME_STATUS_COLUMN()}function j(){return o.flags._DP_UI_ENABLE_STREAMLIT_ENHANCED_APP_LIFECYCLE_TELEMETRY()}function x(){return o.flags.UI_ENABLE_CHROMELESS_SIS_APPS()}function F(){return o.flags.UI_ENABLE_STREAMLIT_FEATURE_1()}function B(){return o.flags._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_HEALTHCHECK()}function G(){return o.flags._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_HEALTHCHECK_SHADOW_MODE()}function V(){return o.flags._DP_UI_ENABLE_STREAMLIT_TRUNCATE_LEADING_SLASH_FROM_UPLOAD()}},40532:function(e,t,n){n.d(t,{H:()=>s,h:()=>l});var o=n(499924),r=n(783844),i=n(371743);let a=o.createContext(""),l=a.Provider,s=e=>{let t=(0,o.useContext)(a),n=e||t;return{entityId:(0,o.useMemo)(()=>(0,i.J)(n,r.M.STREAMLIT),[n]),entityIdStr:n}}},80550:function(e,t,n){n.d(t,{A:()=>r});var o=n(106564);function r(e){let t=(0,o.f)({iframeUrl:e,page:void 0});return t?new URL(t).origin:void 0}},106564:function(e,t,n){n.d(t,{f:()=>d});var o=n(218899),r=n(499924),i=n(383151),a=n(750671),l=n(102078),s=n(207036),c=n(689708),u=n(689398);function d({iframeUrl:e,page:t,rawParams:n=(0,s.s)()}){let{theme:d}=(0,o.Z)(),f=(0,u.YL)(),E=(0,u.nQ)(),p=(0,u.F2)();return(0,r.useMemo)(()=>{let o;if(!e)return;(0,a.N)(""===new URL(e).search,"Base URL must not contain search parameters"),(o=E?new URL(null!=t?t:"",e.endsWith("/")?e:`${e}/`):new URL(e)).searchParams.set("embed","true"),o.searchParams.append("embed_options","show_padding"),p&&("dark"===d&&o.searchParams.append("embed_options","dark_theme"),"light"===d&&o.searchParams.append("embed_options","light_theme")),o.searchParams.set("__parentOrigin",window.location.origin),o.searchParams.set("__clientVersion",encodeURIComponent(i.X.clientVersion||""));let r=(0,c.ur)(o.searchParams);if((0,a.N)((0,l.r)(r),`Unknown query parameter(s) [${r.toString()}] set on Streamlit iFrame URL.`),f)for(let[e,t]of(0,c.aR)(n))o.searchParams.append(e,t);return o.toString()},[e,t,p,f,E,d,n])}},423882:function(e,t,n){n.d(t,{I:()=>r});var o,r=((o={}).loading="loading",o.loaded="loaded",o.suspended="suspended",o)},482148:function(e,t,n){n.d(t,{P:()=>o});class o extends Error{}},13715:function(e,t,n){n.d(t,{Z:()=>o});class o extends Error{constructor({topic:e,level:t,payload:n}){super(n),this.topic=e,this.level=t,this.payload=n}}},42218:function(e,t,n){n.d(t,{a:()=>o});class o extends AggregateError{}},403842:function(e,t,n){n.d(t,{GK:()=>s,hb:()=>o,mM:()=>c,sd:()=>l});let o=1;var r,i,a,l=((r={}).CacheStarted="cache started",r.InteractiveStarted="Interactive message stream started",r.NativeAppPermissions="NA_PERMISSIONS",r),s=((i={}).InitializationState="INITIALIZATION_STATE",i.LifecycleMessage="LIFECYCLE_MESSAGE",i.Error="ERROR",i),c=((a={}).NOT_RUNNING="notRunning",a.RUNNING="running",a.RERUN_REQUESTED="rerunRequested",a.STOP_REQUESTED="stopRequested",a.COMPILATION_ERROR="compilationError",a)},459510:function(e,t,n){n.d(t,{e:()=>o});let o={CONNECTED:"CONNECTED",DISCONNECTED_FOREVER:"DISCONNECTED_FOREVER",INITIAL:"INITIAL",PINGING_SERVER:"PINGING_SERVER",CONNECTING:"CONNECTING"}},243100:function(e,t,n){function o(e,t){let n=e,o=null;for(;n;){let e=n;if(e.getAttribute&&(o=e.getAttribute(t)))return o;n=n.parentNode}return null}function r(e,t){return o(e,"data-"+t)}function i(e,t){for(;e;){if(t(e))return!0;e=e.parentNode}return!1}function a(){}function l(e){e.preventDefault(),e.stopPropagation()}function s(e){return e.stopPropagation()}function c(e){e.dataTransfer.setData("text/plain",""),d(e)}function u(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function d(e){if(e.dataTransfer.effectAllowed="move",e.dataTransfer.setDragImage){let t=document.createElement("img");t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.dataTransfer.setDragImage(t,0,0)}}function f(e){for(;e;){if(e.getAttribute&&e.getAttribute("data-is-popover"))return e;e=e.parentNode}}function E(e,t){let n=f(e),o=f(t);return n&&o&&n===o}n.d(t,{DY:()=>i,EI:()=>a,Jf:()=>d,Ob:()=>E,QO:()=>u,UW:()=>s,aC:()=>o,nm:()=>c,qf:()=>l,um:()=>r})},421141:function(e,t,n){n.d(t,{z:()=>d});var o=n(499924),r=n(225532),i=n(979991),a=n(846036),l=n(783844),s=n(775136);function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function u(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let d=e=>{let t=(0,s.h)(),{logEventToSnowflakeAndDatadog:n}=(0,i.z)(),d=sessionStorage.getItem(r.VE);return(0,o.useCallback)(o=>{let{fullIdentifier:r,forceLog:i}=o,s=function(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(o,["fullIdentifier","forceLog"]);switch(e){case l.M.STREAMLIT:t(u(c({fullStreamlitIdentifier:r},s),{eventType:s.eventType}));break;case l.M.NOTEBOOK:n({component:o.componentName,event:o.eventName,type:o.eventType,data:u(c({},o.additionalTelemetryParams),{windowId:d,fullNotebookIdentifier:r})});break;default:throw(0,a.U)(e),Error(`Received call to logFileBasedEntityEvent with unsupported type: ${e}`)}},[n,t,e,d])}},787679:function(e,t,n){n.d(t,{_:()=>l});var o=n(499924),r=n(778098),i=n(320241),a=n(254759);function l(){let e=(0,o.useContext)(i.V1),t=(0,a.m)(["user"]),{formatMessage:n}=(0,r.Z)();return(0,o.useCallback)(async(o,r,i)=>{let a={lastUpdatedUser:t.user.currentUserId,lastUpdatedTime:Date.now()};try{await e.alter(r,o,{comment:JSON.stringify(a)},{secondaryRoles:i})}catch(e){throw Error(n({id:"Could not refresh last updated information. Error: {message}"},{message:e instanceof Error?e.message:"unknown error"}))}},[n,e,t.user.currentUserId])}},164090:function(e,t,n){n.d(t,{j:()=>N});var o=n(184168),r=n(651489),i=n(567410),a=n(821034),l=n(239243),s=n(751907),c=n(429207),u=n(628587),d=n(145753),f=n(236689),E=n(702679),p=n(77822),b=n(233174),y=n(982055),g=n(499924),S=n(778098),O=n(374318),h=n(896426),m=n(810339),_=n(471864),I=n(67158),T=n(674337),v=n(3535),R=n(421141);function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}let N=g.memo(({hideLayer:e,sourceEntityIdentifier:t,sourceEntityTitle:n,dialogTitle:N,navigateToNewEntity:A,embeddedStageEnabled:w=!1,versionedStageEnabled:L=!0,openNewEntityButtonText:k,duplicate:P,readyForDuplication:D,entityShared:M,validateName:U,additionalTelemetryParams:j})=>{var x,F;let{formatMessage:B}=(0,S.Z)(),[G,V]=(0,g.useState)(""),K=(0,g.useRef)(!1),[W,H]=(0,g.useState)(r.Yg.NONE),[$,Q]=(0,g.useState)(!1),[Y,z]=(0,g.useState)(null),q=(0,R.z)(t.type),Z=(0,g.useRef)(!1),J=(0,g.useRef)(null),X=(0,m.Z)(t);(0,g.useEffect)(()=>{K.current||V(n?`Copy of ${n}`:"")},[n]);let ee=(0,g.useCallback)(e=>{K.current=!0,V(e.target.value)},[]),et=W!==r.Yg.INVALID&&G&&!$&&D,en=(0,g.useCallback)(async()=>{if(!et)return;Q(!0);let e=null,n=null,o=null,r=!1,a=null,l=(0,I.m)(t);try{(0,h.H$)(v.g3,l),a=await P({newEntityName:G,newEntityTitle:G}),z(a),r=!0}catch(a){var s;let t;n=a instanceof O.M?null==(s=a.externalErrorCause)?void 0:s.code:void 0,o=a instanceof O.M?a.statusCode:void 0,t=n===y.SFDBErrorCode.ALREADY_EXISTS_002002?B({id:"This name is used by another notebook. Try a different name."}):(a instanceof Error?a.message:void 0)||B({id:"Error when duplicating the object. Try again later."}),(0,i.w)({type:"alert",content:t,autoDismiss:!1}),r=!1,e=null==a?void 0:a.message}finally{Q(!1);let i=(0,h.Oi)({event:v.g3,markers:[l],isUserE2E:!1}),{duration:s}=(0,h.bR)(v.g3,i);q({fullIdentifier:t,componentName:T.jNi,eventName:T.LGO,eventType:r?"ui_response_success":"ui_response_error",forceLog:!1,additionalTelemetryParams:C({success:r,embeddedStageEnabled:w,versionedStageEnabled:L,error:null!=e?e:void 0,errorStatusCode:null!=o?o:void 0,errorCode:null!=n?n:void 0,hasUserChangedTitle:K.current,runtime:X?"spcs":"wh",durationMs:s,newEntityIdentifier:r?(0,I.m)(a):void 0},j)})}},[et,P,w,B,X,q,G,t,L,j]),eo=(0,g.useCallback)(()=>{Y&&(e(),A(Y))},[e,A,Y]),er=(0,g.useMemo)(()=>(0,o.jsx)(a.q,{minHeight:30,paddingTop:4,paddingBottom:4,borderRadius:8,width:"100%"}),[]),ei=(0,g.useMemo)(()=>(0,o.jsxs)(l.g,{children:[(0,o.jsx)(s.lt,{layout:"compact",children:(0,o.jsx)(s.MR,{label:B({id:"Name"}),input:{value:G,disabled:$,validation:e=>U?U(e):(0,_.hs)(e,B),onValidationChange:H,onChange:ee,spellCheck:!1,autoFocus:!0}})}),M&&(0,o.jsxs)(c.X,{marginTop:16,verticalAlign:"middle",children:[(0,o.jsx)(u.JO,{icon:"warning-triangle",color:d.Q2.iconColor,flexShrink:0,marginRight:8,size:16}),(0,o.jsx)(f.x,{size:"small",display:"inline-flex",verticalAlign:"middle",weight:400,color:d.Il.Gray70,children:B({id:"The duplicated app will not be shared with the same roles."})})]})]}),[M,B,ee,$,G,U]),ea=(0,g.useMemo)(()=>(0,o.jsxs)(E.s,{align:"center",children:[(0,o.jsx)(u.JO,{flexShrink:0,color:d.Q2.statusSuccessColor,icon:"status-success",height:64,width:64}),(0,o.jsx)(f.x,{size:"default",display:"inline-flex",verticalAlign:"middle",weight:400,marginTop:24,color:d.Q2.primaryTextColor,children:B({id:"Copy of {sourceEntityTitle} created!"},{sourceEntityTitle:n})})]}),[B,n]);(0,g.useEffect)(()=>{Z.current||(q({fullIdentifier:t,componentName:T.jNi,eventName:T.mL4,eventType:"ui_impression",forceLog:!1,additionalTelemetryParams:{embeddedStageEnabled:w,versionedStageEnabled:L}}),Z.current=!0)},[w,q,t,L]);let el=(0,g.useRef)(null),[es,ec]=(0,g.useState)("auto");(0,g.useEffect)(()=>{el.current&&ec(el.current.scrollHeight)},[Y,D]);let eu=(0,g.useMemo)(()=>Y?{transitionProperty:"height",transitionDuration:"1000ms",transitionTimingFunction:"ease"}:{},[Y]);return(0,o.jsxs)(p.Vq,{manuallyShown:!0,onHide:e,causalElement:J,children:[(0,o.jsx)(p.fK,{children:N}),(0,o.jsx)(p.a7,{children:(0,o.jsx)(l.g,(x=C({height:es},eu),F=F={ref:el,children:Y?ea:D?ei:er},Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(F)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(F)).forEach(function(e){Object.defineProperty(x,e,Object.getOwnPropertyDescriptor(F,e))}),x))}),(0,o.jsxs)(p.cN,{children:[(0,o.jsx)(b.zx,{use:"default",onClick:e,disabled:$,marginRight:8,telemetryComponent:T.jNi,telemetryName:T.c6E,telemetryData:{sourceEntityIdentifier:t,embeddedStageEnabled:w,versionedStageEnabled:L,hasUserChangedTitle:K.current},children:Y?B({id:"Close"}):B({id:"Cancel"})}),(0,o.jsx)(b.zx,{use:"primary",onClick:Y?eo:en,disabled:!et,inProgress:$,telemetryComponent:T.jNi,telemetryName:Y?T.RVD:T.J9z,telemetryData:{sourceEntityIdentifier:t,newEntityIdentifier:null!=Y?Y:void 0,embeddedStageEnabled:w,versionedStageEnabled:L,hasUserChangedTitle:K.current},children:Y?null!=k?k:B({id:"Open app"}):B({id:"Duplicate"})})]})]})});N.displayName="DuplicateFileBasedEntityDialog"},137040:function(e,t,n){n.d(t,{Jf:()=>b,Gk:()=>y,Oz:()=>O,Fx:()=>m,C$:()=>T,XJ:()=>I,xe:()=>h,qL:()=>_});var o,r=n(184168),i=n(467131),a=n(485387),l=n.n(a),s=n(499924),c=n(665007),u=n(649683);let d={},f=({epochName:e,callbackFreqMs:t,shouldCleanUpDangledTicker:n=!0})=>{let o=`${e}//${t}`,[r,i]=s.useState(0),a=s.useRef(n);a.current=n;let l=(0,u.t)(),c=s.useCallback(()=>{d[o]&&(d[o].startTimeMs=Date.now()),l.current&&i(0)},[o,l]),f=s.useCallback(()=>{delete d[o],l.current&&i(0)},[o,l]);return s.useEffect(()=>{if(null===t)return;d[o]||(d[o]={startTimeMs:Date.now(),callbacks:new Set,intervalId:void 0});let e=()=>i(Date.now()-d[o].startTimeMs);return e(),d[o].callbacks.add(e),d[o].intervalId||(d[o].intervalId=setInterval(()=>{d[o].callbacks.forEach(e=>e())},t)),()=>{d[o].callbacks.delete(e),0===d[o].callbacks.size&&(clearInterval(d[o].intervalId),a.current?f():d[o].intervalId=void 0)}},[t,f,o,l]),{elapsedTimeMs:r,reset:c}};var E=n(783844),p=n(709711),b=((o={}).initializingMessage="initializingMessage",o.startingComputePoolMessage="startingComputePoolMessage",o.startingContainerServiceMessage="startingContainerServiceMessage",o.connectingServiceMessage="connectingServiceMessage",o.waitingEndpointMessage="waitingEndpointMessage",o.waitingEndpointMessageStreamlit="waitingEndpointMessageStreamlit",o.runningAppMessage="runningAppMessage",o.runningAppMessageStreamlit="runningAppMessageStreamlit",o.fullComputePoolMessage="fullComputePoolMessage",o.insufficientCapacityErrorMessage="insufficientCapacityErrorMessage",o.generalContainerClientErrorMessage="generalContainerClientErrorMessage",o.unreachableContainerErrorMessage="unreachableContainerErrorMessage",o.generalContainerRunErrorMessage="generalContainerRunErrorMessage",o.reusingExistingServiceMessage="reusingExistingServiceMessage",o.oomWarehouseErrorMessage="oomWarehouseErrorMessage",o.generalWarehouseErrorMessage="generalWarehouseErrorMessage",o);let y=e=>{if(!e)return;let t=e.name;if(!(t in b))throw Error(`Unknown FormattedMessageSupplier key: ${t}`);return t},g=(e,t)=>({initializingMessage:()=>(0,r.jsx)(c.Z,{id:"Initializing connection and scanning existing service…"}),startingComputePoolMessage:e=>(null==e?void 0:e.duration)?(0,r.jsx)(c.Z,{id:"{duration} \xb7 Starting compute pool. This can take 3–5 minutes…",values:e}):(0,r.jsx)(c.Z,{id:"Starting compute pool. This can take 3–5 minutes…"}),startingContainerServiceMessage:e=>(null==e?void 0:e.duration)?(0,r.jsx)(c.Z,{id:"{duration} \xb7 Starting container service. This can take 3–5 minutes…",values:e}):(0,r.jsx)(c.Z,{id:"Starting container service. This can take 3–5 minutes…"}),connectingServiceMessage:()=>(0,r.jsx)(c.Z,{id:"Connecting to container service…"}),waitingEndpointMessage:()=>(0,r.jsx)(c.Z,{id:"Waiting for notebook endpoint to be ready…"}),waitingEndpointMessageStreamlit:()=>(0,r.jsx)(c.Z,{id:"Waiting for Streamlit endpoint to be ready…"}),runningAppMessage:()=>(0,r.jsx)(c.Z,{id:"Running notebook application…"}),runningAppMessageStreamlit:()=>(0,r.jsx)(c.Z,{id:"Running Streamlit…"}),fullComputePoolMessage:()=>(0,r.jsx)(c.Z,{id:"Couldn’t start session because compute pool is full. Try a different compute pool or contact your admin."}),insufficientCapacityErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Couldn't start session due to insufficient capacity from cloud provider. Try a different compute pool or try again later."}),generalContainerRunErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Couldn't start session due to an issue with Snowpark Container Services: {errorDetail}",values:t}),unreachableContainerErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Session ended due to unreachable container."}),generalContainerClientErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Encountered error with service connection: {errorDetail}",values:t}),reusingExistingServiceMessage:e=>(null==e?void 0:e.duration)?(0,r.jsx)(c.Z,{id:"{duration} \xb7 Trying to reuse existing service. This can take 1–5 minutes…",values:e}):(0,r.jsx)(c.Z,{id:"Trying to reuse existing service. This can take 1–5 minutes…"}),oomWarehouseErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Notebook session ended due to out of memory issue. Try limiting your dataset or use a Snowpark-optimized warehouse."}),generalWarehouseErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Notebook session ended due to error: {errorDetail}",values:t})})[e],S={STARTING_COMPUTE_POOL_INFO_STRING:"Compute pool node(s) are being provisioned",STARTING_SERVICE_INFO_STRING:"Waiting to start",FULL_COMPUTE_POOL_ERROR_SUBSTRING:"Notebook service is unschedulable in full compute pool",INSUFFICIENT_RESOURCES_ERROR_SUBSTRING:"Unschedulable due to insufficient",INSUFFICIENT_CAPACITY_ERROR_SUBSTRING:"Compute pool insufficient capacity error",UNREACHABLE_CONTAINER_ERROR_PREFIX:"UNAVAILABLE:",RUNNING_STRING:"Running",OOM_WAREHOUSE_ERROR_SUBSTRING:"Function available memory exhausted"},O=()=>(0,r.jsx)(c.Z,{id:"Packages updated successfully."}),h=(e,t)=>{var n,o,r;switch(e.topic){case 1:return g("initializingMessage");case 2:{let t=e.payload?JSON.parse(e.payload):void 0,o=Object.values(null!=(n=null==t?void 0:t.containers)?n:{}).flat().map(e=>e.message);if(o.includes(S.STARTING_COMPUTE_POOL_INFO_STRING))return g("startingComputePoolMessage");return o.includes(S.STARTING_SERVICE_INFO_STRING)||o.includes(S.RUNNING_STRING)||i.cM.warn(`Unrecognized service status message: ${e.payload}`),g("startingContainerServiceMessage")}case 3:return g("connectingServiceMessage");case 4:if(t===E.M.STREAMLIT)return g("waitingEndpointMessageStreamlit");return g("waitingEndpointMessage");case 5:if(t===E.M.STREAMLIT)return g("runningAppMessageStreamlit");return g("runningAppMessage");case 6:{let t=e.payload;if(null==t?void 0:t.includes(S.FULL_COMPUTE_POOL_ERROR_SUBSTRING))return g("fullComputePoolMessage");if((null==t?void 0:t.includes(S.INSUFFICIENT_CAPACITY_ERROR_SUBSTRING))||(null==t?void 0:t.includes(S.INSUFFICIENT_RESOURCES_ERROR_SUBSTRING)))return g("insufficientCapacityErrorMessage");return g("generalContainerRunErrorMessage",{errorDetail:t})}case 7:if(null==(o=e.payload)?void 0:o.startsWith(S.UNREACHABLE_CONTAINER_ERROR_PREFIX))return g("unreachableContainerErrorMessage");return g("generalContainerClientErrorMessage",{errorDetail:e.payload});case 8:return g("reusingExistingServiceMessage");case 101:if(null==(r=e.payload)?void 0:r.includes(S.OOM_WAREHOUSE_ERROR_SUBSTRING))return g("oomWarehouseErrorMessage");return g("generalWarehouseErrorMessage",{errorDetail:e.payload});default:return void i.cM.warn(`Unrecognized lifecycle message topic: ${e.topic}`)}},m=(e,t,n=!1)=>{let o=(null==t?void 0:t.type)==="ReceivedStreamlitLifecycleMsg"?h(t.data,e):void 0,r=y(o),i="startingComputePoolMessage"===r||"startingContainerServiceMessage"===r||"reusingExistingServiceMessage"===r,{elapsedTimeMs:a}=f({epochName:"startingService",callbackFreqMs:i?1e3:null}),s=i?n?(0,p.qv)(a):l().duration(a,"milliseconds").format("h[h] m[m] s[s]",0,{trim:"all"}):void 0;return{displayTextSupplier:o,values:i?{duration:s}:void 0}},_=(e,t,n=!1)=>{let{displayTextSupplier:o,values:r}=m(e,t,n);return null==o?void 0:o(r)},I=e=>(null==e?void 0:e.length)?e.map(e=>e.error).join("\n"):null,T=e=>(null==e?void 0:e.length)?e.map(e=>e.message).join("\n"):null},278928:function(e,t,n){n.d(t,{a$:()=>i,fs:()=>l,gE:()=>a,gK:()=>s,tZ:()=>o,yN:()=>r});let o="ui_click",r="ui_visit",i="ui_impression",a="ui_keyboard",l="ui_response_success",s="ui_response_error"},562940:function(e,t,n){n.d(t,{J:()=>i});var o=n(307134),r=n(609737);function i(){let e=r.flags.UI_ENABLE_NOTEBOOK_FEATURE_33();return o.v.addFeatureFlagEvaluation("EnableRunWhileCacheLoading",e),e}},936057:function(e,t,n){n.d(t,{S:()=>l});var o=n(499924),r=n(514248),i=n(920597);let a=r.H.cacheFiller;function l(e,t){let n=(0,i.q)(e,(e,t,n)=>{a.debug("New Start Document Cache Load Effect"),e.registerHandler(t.docCacheHandler)}),r=(0,i.q)(e,(e,t,n)=>{a.debug("New End Document Cache Load Effect"),e.unregisterHandler(t.docCacheHandler)}),l=(0,i.q)(e,(e,n,o)=>{a.debug("New Fetch Cache Results called");let r=n.cellIds.map(e=>({cellId:e})),i=0;e.connection.isConnected()&&r&&r.length>0&&(i=1e3*t,e.registerHandler(n.messageHandler),e.sendMessage({previousResults:{warmStart:!1,cellIds:r,allowResultsAfterStart:!0}})),setTimeout(()=>{a.debug("Cells Timedout",{cellIds:n.cellIds}),n.messageHandler.onCancel(n.cellIds,"Timeout")},i)}),s=(0,i.q)(e,(e,t,n)=>{a.debug("New Fetch Cache Results DONE called"),e.unregisterHandler(t.messageHandler)});return(0,o.useMemo)(()=>({newStartDocumentCachedLoad:n,newEndDocumentCachedLoad:r,newFetchCachedResults:l,newFetchCachedResultsDone:s}),[r,l,s,n])}},771661:function(e,t,n){n.d(t,{j:()=>a});var o=n(514248),r=n(399696);let i=o.H.cacheFiller,a={NEW_START_DOCUMENT_CACHE_LOAD:function(e,t,n){if(i.debug("NEW_START_DOCUMENT_CACHE_LOAD",{cacheLoadId:t.cacheLoadId}),"pending"===e.cacheStatus)return void i.reportError("unexpected_nested_document_cache_start","Should not get a start documnet cache load in pending",{action:t});e.cacheLoadId=t.cacheLoadId,e.cacheStatus="pending";let{id:o,role:r,secondaryRoles:a}=t;n({type:"newStartDocumentCachedLoad",id:o,role:r,secondaryRoles:a,docCacheHandler:t.docCacheHandler}),e.cacheLoadId=t.cacheLoadId,e.cacheStatus="pending"},NEW_END_DOCUMENT_CACHE_LOAD:function(e,t,n){if(i.debug("NEW_END_DOCUMENT_CACHE_LOAD"),null==t.cacheLoadId||e.cacheLoadId===t.cacheLoadId){e.cacheLoadId=void 0;let o=e.cacheStatus;i.assertOrReport("pending"===e.cacheStatus||"loaded"===e.cacheStatus,"end_document_cache_load_without_pending_cache_status","Running a cache load batch with the cacheStatus in a non-pending state",{cacheStatus:o,cacheLoadId:t.cacheLoadId}),"error"!==o&&(e.cacheStatus="loaded");let{id:r,role:a,secondaryRoles:l}=t;n({type:"newEndDocumentCachedLoad",id:r,role:a,secondaryRoles:l,docCacheHandler:t.docCacheHandler})}},NEW_START_FETCHING_CACHED_RESULT:function(e,t,n){let{id:o,role:r,secondaryRoles:a,cellIds:l}=t;i.debug("NEW_START_FETCHING_CACHED_RESULT",{cellIds:l}),(null==t.cacheLoadId||e.cacheLoadId===t.cacheLoadId)&&l&&l.length>0&&(i.assertOrReport("pending"===e.cacheStatus||"loaded"===e.cacheStatus,"active_batch_without_pending_cache_status","Running a cache load batch with the cacheStatus in a non-pending state",{cacheStatus:e.cacheStatus,cellIds:l,cacheLoadId:t.cacheLoadId}),"pending"!==e.cacheStatus&&"loaded"!==e.cacheStatus?t.messageHandler.onCancel(l,"RunAlreadyHappened"):n({type:"newFetchCachedResults",id:o,role:r,secondaryRoles:a,cellIds:t.cellIds,messageHandler:t.messageHandler,cacheLoadId:t.cacheLoadId}))},NEW_END_FETCHING_CACHED_RESULT:function(e,t,n){let{id:o,role:r,secondaryRoles:a}=t;i.debug("NEW_END_FETCHING_CACHED_RESULT"),n({type:"newFetchCachedResultsDone",id:o,role:r,secondaryRoles:a,messageHandler:t.messageHandler})},NEW_SET_CACHE_RESULTS:function(e,t,n){i.debug("NEW_SET_CACHE_RESULTS",{cellId:t.cellId});let o=e.notebookState;if(!o)return void i.error("No Notebook state when setting cache results");if(null==t.cacheLoadId||e.cacheLoadId===t.cacheLoadId){var a;let{cellId:n,messages:l}=t;i.debug("Updating cache state for cell",{cellId:n});let s=null==(a=e.notebookState)?void 0:a.getCellById(n);if(null==s||"neverRun"!==s.result.status.cellRunStatus)return void i.error("Cell is already updated before the cache result, so ignoring the cache result");if("pending"===e.cacheStatus||"loaded"===e.cacheStatus){let a=o.updateCellResult(n,{message:l});if(null!=t.cellCacheMetadata&&(i.debug("Cell has cellCacheMetadata",{cellId:n,cellCacheMetadata:t.cellCacheMetadata}),a=a.updateCellResult(n,{selfContentHash:t.cellCacheMetadata.selfContentHash,fullContentHash:t.cellCacheMetadata.fullContentHash,runId:t.cellCacheMetadata.runId,parentExecutionId:t.cellCacheMetadata.parentExecutionId,executionId:t.cellCacheMetadata.executionId,tempSelfContentHash:void 0,tempFullContentHash:void 0,tempRunId:void 0,tempParentExecutionId:void 0,tempExecutionId:void 0})),t.queryId){let o=t.messages.some(e=>(0,r.G)(e));e.notebookState=a.updateCellStatus(n,{cellRunStatus:o?"error":"success"})}else e.notebookState=a.updateCellStatus(n,{cellRunStatus:"idle"});i.debug("Updated cache state for cell",{cellId:n})}else i.reportError("active_batch_without_pending_cache_status","Running a cache load batch with the cacheStatus in a non-pending state",{cacheStatus:e.cacheStatus,cellId:n,cacheLoadId:t.cacheLoadId})}}}},228989:function(e,t,n){n.d(t,{W:()=>O});var o=n(184168),r=n(499924),i=n(778098),a=n(865386),l=n(67158),s=n(164090),c=n(609737),u=n(613159),d=n(810339),f=n(461376),E=n(527565),p=n(294098);let b=({sourceNotebookId:e,sessionSettings:t})=>{let n=c.flags.UI_ENABLE_NOTEBOOKS_WH_PYTHON_ENVIRONMENT(),o=!!(0,d.Z)(e),i=(0,r.useCallback)(e=>{var r,i,a,l,s,c;let u=(null!=(r=null==t?void 0:t.runtimeName)?r:e.runtimeName)||E.U;return s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({runtimeName:u,queryWarehouse:(null!=(i=null==t?void 0:t.queryWarehouse)?i:e.queryWarehouse)||void 0,warehouse:(null!=(a=null==t?void 0:t.codeWarehouse)?a:e.codeWarehouse)||void 0},(0,f.V)(n&&!o&&(!!e.runtimeEnvironmentVersion||!!(null==t?void 0:t.runtimeEnvironmentVersion)),{runtimeEnvironmentVersion:(null==t?void 0:t.runtimeEnvironmentVersion)||e.runtimeEnvironmentVersion||void 0})),c=c={computePool:u===E.U?void 0:(null!=(l=null==t?void 0:t.computePool)?l:e.computePool)||void 0},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(c)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(c)).forEach(function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(c,e))}),s},[n,o,t]),{sourceEntityDetails:a,duplicate:l,readyForDuplication:s}=(0,u.z)(e),b=(0,r.useCallback)(async e=>{var t,n;let o=null!=(n=null==e?void 0:e.newEntityName)?n:`Copy of ${null!=(t=null==a?void 0:a.name)?t:""}`,r=(0,p._t)(o);return await l({newEntityName:r,getAdditionalProps:i})},[l,null==a?void 0:a.name,i]);return{sourceNotebookDetails:a,duplicate:b,readyForDuplication:s}};var y=n(247174),g=n(432532),S=n(523692);let O=r.memo(({hideLayer:e,sourceFullNotebookIdentifier:t,urlData:n,sessionSettings:c})=>{var u;let{formatMessage:d}=(0,i.Z)(),{sourceNotebookDetails:f,duplicate:E,readyForDuplication:p}=b({sourceNotebookId:t,sessionSettings:c}),O=(0,r.useCallback)(e=>{a.k.navigate({region:n.region,org:n.org,entityIdStr:(0,l.m)(e)})},[n.org,n.region]),h=(0,r.useCallback)(e=>{let t=(0,S.V)(e);return(0,y.t)(t,d)},[d]),m=(0,r.useMemo)(()=>({notebookRuntime:(0,g.e)(null==f?void 0:f.runtimeName)}),[null==f?void 0:f.runtimeName]);return(0,o.jsx)(s.j,{hideLayer:e,sourceEntityIdentifier:t,sourceEntityTitle:null!=(u=null==f?void 0:f.name)?u:"",dialogTitle:d({id:"Duplicate Notebook"}),openNewEntityButtonText:d({id:"Open notebook"}),readyForDuplication:p,duplicate:E,navigateToNewEntity:O,validateName:h,additionalTelemetryParams:m})});O.displayName="DuplicateNotebookDialog"},893538:function(e,t,n){n.d(t,{z:()=>g});var o=n(184168),r=n(77822),i=n(155382),a=n(236689),l=n(145753),s=n(239243),c=n(233174),u=n(367746),d=n(499924),f=n(665007),E=n(320241),p=n(998269),b=n(783844),y=n(3291);let g=({hide:e,fullNotebookIdentifier:t})=>{var n,u;let g=(0,d.useRef)(null),O=(0,E.fo)(),h=O.useGetSkippableNoThrow(t,p.Y.describe),m=(null==h||null==(u=h.result)||null==(n=u.columns[0])?void 0:n.externalAccessIntegrations)||[],[_,I]=O.useHydratedListNoThrow(b.M.EXTERNAL_ACCESS_INTEGRATION,p.Y.show,void 0);if(null==_||(0,y.M)(I)||(0,y.M)(h))return(0,o.jsx)(S,{});let T={};for(let e of _)T[e.name]=e;let v=m.filter(e=>{var t;return!(null==(t=T[e])?void 0:t.enabled)});return(0,o.jsxs)(r.Vq,{manuallyShown:!0,onHide:e,causalElement:g,children:[(0,o.jsx)(r.fK,{children:(0,o.jsx)(f.Z,{id:"Can't start Notebook"})}),(0,o.jsxs)(r.a7,{children:[(0,o.jsx)(i.n,{marginBottom:24,children:(0,o.jsx)(a.x,{color:l.Q2.secondaryTextColor,children:(0,o.jsx)(f.Z,{id:"There was a problem attaching one or more external access integrations to this notebook:"})})}),(0,o.jsx)("ul",{children:v.map(e=>(0,o.jsx)("li",{children:e},e))})]}),(0,o.jsx)(r.cN,{children:(0,o.jsxs)(s.g,{children:[(0,o.jsx)(c.zx,{onClick:e,children:(0,o.jsx)(f.Z,{id:"Close"})}),(0,o.jsx)(c.zx,{use:"primary",onClick:async function(){await O.alter(t,{externalAccessIntegrations:m.filter(e=>!v.includes(e))}),e()},marginLeft:8,children:(0,o.jsx)(f.Z,{id:"Remove unavailable integrations"})})]})})]})};function S(){let e=(0,d.useRef)(null);return(0,o.jsxs)(r.Vq,{manuallyShown:!0,causalElement:e,children:[(0,o.jsx)(r.fK,{}),(0,o.jsx)(r.a7,{display:"flex",justifyContent:"center",alignItems:"center",children:(0,o.jsx)(u.T,{})}),(0,o.jsx)(r.cN,{})]})}g.displayName="NotebookExternalAccessIntegrationErrorDialog",S.displayName="LoadingDialog"},367092:function(e,t,n){n.d(t,{T:()=>l,b:()=>a});var o=n(184168),r=n(499924);let i=(0,r.createContext)({triggerDialog:()=>{}}),a=()=>(0,r.useContext)(i);function l({children:e,triggerDialog:t}){let n=(0,r.useMemo)(()=>({triggerDialog:t}),[t]);return(0,o.jsx)(i.Provider,{value:n,children:e})}l.displayName="NotebookPaneShowDialogProvider"},255379:function(e,t,n){n.d(t,{k:()=>s});var o=n(499924),r=n(501188),i=n(735736),a=n(243181),l=n(254759);let s=()=>{let{dataDiscoverRole:e,secondaryRoles:t}=(0,r.j)(),{user:n}=(0,l.m)(["user"]),s=(0,i.U)();return(0,o.useCallback)(async({notebookId:o,sessionSettings:r})=>{let i=await s(o,e,t);await n.api.query((0,a.HS)({notebookUrlId:i.urlId,sessionSettingsData:JSON.stringify(r)}),{role:e,secondaryRoles:t,isInternal:!0,desc:"save-notebook-session-settings"})},[e,t,n,s])}},327879:function(e,t,n){n.d(t,{e:()=>i});var o=n(888890),r=n(438635);function i(e){let t=(0,r.h)(e),n=e===o.GF,i=e===o.rJ;return t||n||i}},730434:function(e,t,n){n.d(t,{E:()=>u,U:()=>c});var o=n(184168),r=n(237257),i=n(499924);let[a,l]=(0,r.Z)(function(){let[e,t]=(0,i.useState)(null),n=(0,i.useCallback)(e=>{t(e)},[]),o=(0,i.useCallback)(()=>{t(null)},[]);return(0,i.useMemo)(()=>({openDialog:n,dialog:e,hideDialog:o}),[n,e,o])});function s(){let{dialog:e}=l();return(0,o.jsx)(o.Fragment,{children:e})}function c({children:e}){return(0,o.jsxs)(a,{children:[(0,o.jsx)(s,{}),e]})}function u(){let{openDialog:e,hideDialog:t}=l();return{openDialog:e,hideDialog:t}}s.displayName="Dialog",c.displayName="NotebookDialogProvider"},34589:function(e,t,n){n.d(t,{$:()=>o});let o=4},139545:function(e,t,n){n.d(t,{K7:()=>i,Q8:()=>r,hj:()=>o});let o=604800,r=15,i=3600},116952:function(e,t,n){n.d(t,{L:()=>b});var o=n(630455),r=n(609737),i=n(778098),a=n(369859),l=n(735736),s=n(274753),c=n(731694),u=n(750671),d=n(67158),f=n(815877),E=n(98047);let p=()=>{let e=(0,f.KP)(),t=(0,E.N)();return(0,o.z)(async n=>{try{return await e(n)}catch(e){if(e.message.match(/failed paddingTrim/iu))return console.error(e),t.logError({notebookIdentifier:(0,d.m)(n.id),error:"failed paddingTrim"}),Promise.resolve("");throw e}})},b=()=>{let e=(0,l.U)(),t=(0,s.h)(),n=(0,c.iA)(),d=p(),{formatMessage:f}=(0,i.Z)(),E=r.flags.UI_ENABLE_NOTEBOOK_FEATURE_0();return(0,o.z)(async(o,r,i)=>{let l=await e(o,r,i),{mainFile:s}=l,{rootLocation:c,kind:p,isLive:b}=(0,a.R)(l);if("checkouts"===p)return await t({id:o,role:r,secondaryRoles:i}),d({id:o,rootLocation:c,mainFile:s,throwRawError:E});if("versioned"===p){if(b)return d({id:o,rootLocation:c,mainFile:s,throwRawError:E});let e=await n({id:o,role:r,secondaryRoles:i});return d({id:o,rootLocation:(0,u.h)(e.liveVersionLocationUri,f({id:"Live version could not be created."})),mainFile:s,throwRawError:E})}throw Error(f({id:"Could not fetch notebook. Invalid or unsupported notebook location."}))})}},882682:function(e,t,n){n.d(t,{l:()=>u});var o=n(499924),r=n(501188),i=n(527565),a=n(254759),l=n(327879),s=n(708792),c=n(994106);let u=()=>{let{dataDiscoverRole:e,secondaryRoles:t}=(0,r.j)(),n=(0,a.m)([]).untracked.user,u=(0,s.U)();return(0,o.useCallback)(async o=>{let r=await u(o,e,t),a=!r.runtimeName||r.runtimeName===i.U,s=(0,l.e)(e);if(!a&&s)return{additionalProtoParams:[],activeInstanceJobId:null,activeNotebookInstancesNum:0,additionalMetadata:{}};let d=(await (0,c.jX)({userStore:n,fullNotebookIdentifier:o,role:e,secondaryRoles:t})).filter(e=>e.isInteractive&&(!e.serviceType||a&&"WAREHOUSE_INSTANCE_TYPE"===e.serviceType||!a&&"SERVICE_INSTANCE_TYPE"===e.serviceType)),f=d.length,E={additionalProtoParams:[],activeInstanceJobId:f>0?d[0].serviceId:null,activeNotebookInstancesNum:f,additionalMetadata:{}};return f>0&&(!a||n.isUiSpecifiedSnowflakeFeatureEnabled("_DP_UI_NOTEBOOK_GET_STREAMLIT_VERSION_FOR_WH_ACTIVE_INSTANCE"))&&(E.additionalMetadata.streamlitVersionOfAlreadyRunningInstance=d[0].streamlitVersion),a&&(E.additionalProtoParams.push("reconnectEnabled"),f>0&&E.additionalProtoParams.push(`reconnect-job-${d[0].serviceId}`)),E},[e,t,n,u])}},962624:function(e,t,n){n.d(t,{M:()=>g});var o=n(499924),r=n(254759),i=n(437239),a=n(674337),l=n(278928),s=n(690908),c=n(868646);let u=e=>new s.L().add("CALL SYSTEM$LIST_RUNNING_NOTEBOOK_INSTANCES(?)",(0,c.M)(e)).toQuery(),d=e=>{let[[t]]=e.rows;return JSON.parse(t)},f=async(e,t)=>{let{fullNotebookIdentifier:n,role:o,secondaryRoles:r}=t,i=u(n);return d(await e.api.query(i,{role:o,secondaryRoles:r,isInternal:!0,desc:"system-list-running-notebook-instance"}))};var E=n(994106);async function p({deleteAllRunningNotebookInstances:e,userStore:t,id:n,role:o,secondaryRoles:r,logNotebookEvent:s}){try{let i=await b({userStore:t,id:n,role:o,secondaryRoles:r,logNotebookEvent:s});e||(i=i.slice(0,1)),i.length>0&&(await Promise.all(i.map(e=>(0,E.Dy)(t,{fullNotebookIdentifier:n,role:o,secondaryRoles:r,serviceIdentifier:e}))),s({notebookId:n,event:a.fA1,eventType:l.fs,eventData:{}}))}catch(t){let e=`SPCS Notebooks: Failed to delete notebook instance. ${t}`;(0,i.k)(e,{fullNotebookIdentifier:n}),s({notebookId:n,event:a.XTd,eventType:l.gK,eventData:{error:e}})}}async function b({userStore:e,id:t,role:n,secondaryRoles:o,logNotebookEvent:r}){let s=(await f(e,{fullNotebookIdentifier:t,role:n,secondaryRoles:o})).filter(e=>e.isInteractive&&e.serviceId).map(e=>e.serviceId);return 0===s.length?((0,i.k)("SPCS Notebooks: No running service instance ID found",{fullNotebookIdentifier:t}),r({notebookId:t,event:a.phx,eventType:l.gK,eventData:{}}),[]):(s.length>1&&((0,i.k)("SPCS Notebooks: Found multiple running service instance IDs for interactive notebook.",{fullNotebookIdentifier:t}),r({notebookId:t,event:a.SKU,eventType:l.gK,eventData:{}})),s)}var y=n(98047);function g(){let{user:e}=(0,r.m)(["user"]),t=(0,y.N)(),n=e.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_NOTEBOOK_FEATURE_44");return(0,o.useCallback)(async({id:o,role:r,secondaryRoles:i})=>await p({deleteAllRunningNotebookInstances:n,userStore:e,id:o,role:r,secondaryRoles:i,logNotebookEvent:t.logNotebookEvent}),[n,e,t.logNotebookEvent])}},838783:function(e,t,n){n.d(t,{P:()=>a});var o=n(499924),r=n(243181),i=n(254759);let a=()=>{let{user:e}=(0,i.m)(["user"]);return(0,o.useCallback)(async({id:t,queryId:n,role:o,secondaryRoles:i,isHistoryQueryResultEnabled:a})=>(await e.api.query((0,r.Zl)({fullNotebookIdentifier:t,queryId:a?n:void 0}),{isInternal:!0,role:o,secondaryRoles:i,desc:"generate-notebook-token"})).rows[0][0],[e.api])}},862399:function(e,t,n){n.d(t,{W:()=>a});var o=n(499924),r=n(243181),i=n(254759);let a=()=>{let{user:e}=(0,i.m)(["user"]);return(0,o.useCallback)(async({id:t,role:n,secondaryRoles:o,isPrivatelink:i,isNotebookPrivateLinkEnabled:a})=>{let l=await e.api.query((0,r.eO)({fullNotebookIdentifier:t,isAccountUsingPrivateLink:i,isPrivatelinkEnabled:a}),(0,r.wZ)(n,o));return(0,r.Te)(l.rows[0][0])},[e.api])}},681671:function(e,t,n){n.d(t,{X:()=>l,n:()=>s});var o=n(499924),r=n(783844),i=n(371743);let a=o.createContext(""),l=a.Provider,s=e=>{let t=(0,o.useContext)(a);return(0,o.useMemo)(()=>(0,i.J)(e||t,r.M.NOTEBOOK),[e,t])}},983339:function(e,t,n){n.d(t,{w:()=>r});var o=n(609737);function r(){return o.flags.UI_ENABLE_NOTEBOOK_SINGLE_IFRAME()}},337211:function(e,t,n){n.d(t,{P:()=>c});var o=n(499924),r=n(501188),i=n(446013),a=n(681131),l=n(65180),s=n(681671);function c(){let{dataDiscoverRole:e,secondaryRoles:t}=(0,r.j)(),n=(0,s.n)(),c=(0,i.P)(),{getNotebookEditorState:u,dispatchNotebookEditorStatesMap:d,connectToWebSocket:f,disconnectWebsocket:E,subscribe:p,setHeartbeatPollEndTimeUpdateCallback:b,getWebsocketConnection:y}=(0,l.PW)(),{childFrame:g}=(0,a.KE)()||{},S=(0,o.useCallback)(o=>{var r;(null==g||null==(r=g.snowbooks)?void 0:r.dispatchNotebookEditorState)?g.snowbooks.dispatchNotebookEditorState(o):d(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({id:n,role:e,secondaryRoles:t,queryId:null==c?void 0:c.queryId},o))},[d,null==c?void 0:c.queryId,n,e,t,g]);return{editorState:u(n,e,t),dispatchNotebookEditorState:S,disconnectWebsocket:(0,o.useCallback)(o=>E(n,e,t,o),[E,n,e,t]),connectToWebSocket:(0,o.useCallback)(o=>f({id:n,role:e,secondaryRoles:t,urlInfo:o,queryId:null==c?void 0:c.queryId}),[f,null==c?void 0:c.queryId,n,e,t]),subscribe:p,setHeartbeatPollEndTimeUpdateCallback:b,getWebsocketConnection:(0,o.useCallback)(()=>y(n,e,t),[y,n,e,t])}}},743532:function(e,t,n){n.d(t,{U:()=>s});var o=n(499924),r=n(501188),i=n(755388),a=n(243181),l=n(902417);function s(){let e="get-notebook-history-file-url",{dataDiscoverRole:t,secondaryRoles:n}=(0,r.j)(),{executeQuery:s}=(0,l.U)(t,n,""),{fetchId:c}=(0,i.m)(e);return(0,o.useCallback)(async({notebookId:t,historyQueryId:n})=>{var o,r;let i=(0,a.zd)({fullNotebookIdentifier:t,queryId:n}),{tableData:l}=await s(i,e,c,!0);if(null==(r=l.rows)||null==(o=r[0])?void 0:o[0]){let e=JSON.parse(l.rows[0][0]);if(e.content)return e.content}return""},[e,s,c])}},98047:function(e,t,n){n.d(t,{N:()=>h});var o=n(51723),r=n(499924),i=n(67158),a=n(362779),l=n(307134),s=n(979991),c=n(551276),u=n(674337),d=n(3535),f=n(7042);function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function p(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let b="ui_response_success",y="ui_response_error",g="ui_click",S="ui_visit",O=new Set([u.AzE,u.K5H,u.Uzq,u.RSw,u.y10,u.ua8,u.MSS,u.ImF,u.lWk,u.zrf,u.d0B,u.Mhg,u.zGh,u.iJ8,u.UcJ,u.xAk,u.Ht5,u.vwS,u.wi4,u.dJY,u.MKg,u._KU,u.Hn4,u.YeT,u.foX,u.aDE,u.QuQ,u.z_f,u.yzn,u.F1$,u.AK5,u.Ari,u.ZOT,u.$aC,u.DsD,u.mBO,u.FXf]);function h(){let{logEventToSnowflakeAndDatadog:e,markEventStart:t,measureEventDuration:n,markE2EEventStart:h,isMarkerSet:m,_getDurationsFromMarker:_}=(0,s.z)(),{logEvent:I}=(0,o.useTelemetry)(),T=(0,c.d)(),v=(0,r.useCallback)(t=>{t.data=p(E({},t.data),{isPrivateLink:T()}),O.has(t.event)&&a.A.isDisallowedDatadogEvent(t)?e(t):I(t)},[T,e,I]),R=(0,r.useCallback)(e=>{var t;v({event:u.ImF,type:"ui_performance",data:p(E({},e),{notebookRuntime:null!=(t=e.notebookRuntime)?t:"unknown"})})},[v]),C=(0,r.useCallback)((e,t)=>{var n,o;let r=t?_(t):{};v({event:u.lWk,type:b,data:p(E({},e,r),{notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown",sourceType:null!=(o=e.sourceType)?o:"unknown"})})},[v,_]),N=(0,r.useCallback)((e,t)=>{var n,o;let r=t?_(t):{};v({event:u.zrf,type:y,data:p(E({},e,r),{notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown",sourceType:null!=(o=e.sourceType)?o:"unknown"})})},[v,_]),A=(0,r.useCallback)((e,t)=>{var n;let o=t?_(t):{};v({event:u.ua8,type:b,data:p(E({},e,o),{notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"})})},[v,_]),w=(0,r.useCallback)((e,t)=>{var n;let o=t?_(t):{};v({event:u.MSS,type:y,data:p(E({},e,o),{notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"})})},[v,_]),L=(0,r.useCallback)((e,t)=>{var n;let o=t?_(t):{};v({event:u.AzE,type:S,data:p(E({},e,o),{notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"})})},[v,_]),k=(0,r.useCallback)(e=>{v({event:u.G$y,type:y,data:e})},[v]),P=(0,r.useCallback)((e,t,n,o)=>{v({event:t,type:g,data:p(E({},n,o?_(o):{}),{notebookIdentifier:(0,i.m)(e)})})},[v,_]),D=(0,r.useCallback)((e,t,n,o,r)=>{let a=r?_(r):{};t===u.Hn4&&(a.e2eDurationMs=(r?_(p(E({},r),{event:d.QX,isUserE2E:!0})):{}).e2eDurationMs),v({event:t,type:o?"ui_response_success":"ui_response_error",data:p(E({},n,a),{notebookIdentifier:(0,i.m)(e)})})},[v,_]),M=(0,r.useCallback)((e,t,n)=>{let o=n?_(n):{};v({event:u.Mhg,type:b,data:p(E({},t,o),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),U=(0,r.useCallback)((e,t)=>{v({event:u.zGh,type:b,data:p(E({},t),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v]),j=(0,r.useCallback)((e,t)=>{v({event:u.QtC,type:b,data:p(E({},t),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v]),x=(0,r.useCallback)((e,t,n)=>{let o=n?_(n):{},r=(0,f.ne)(t.reason);v({event:r?u.YeT:u.iJ8,type:r?y:b,data:p(E({},t,o),{error:t.error?t.error:r?t.reason:void 0,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),F=(0,r.useCallback)((e,t,n)=>{let o=p(E({},t,n?_(n):{}),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)});v({event:u.d0B,type:S,data:o}),t.isReconnect&&v({event:u.foX,type:S,data:o})},[v,_]),B=(0,r.useCallback)((e,t,n)=>{let o=n?_(n):{};v({event:u.xAk,type:S,data:p(E({},t,o),{notebookIdentifier:(0,i.m)(e)})})},[_,v]),G=(0,r.useCallback)((e,t,n)=>{let o=n?_(n):{};v({event:u.Ht5,type:S,data:p(E({},t,o),{notebookIdentifier:(0,i.m)(e)})})},[_,v]),V=(0,r.useCallback)((e,t,n)=>{let o=n?_(n):{};v({event:u.vwS,type:S,data:p(E({},t,o),{notebookIdentifier:(0,i.m)(e)})})},[_,v]),K=(0,r.useCallback)((e,t,n)=>{let o=n?_(n):{};v({event:u.UcJ,type:y,data:p(E({},t,o),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e),isReconnect:!!t.isReconnect})}),t.isReconnect&&v({event:u.YeT,type:y,data:p(E({},t,o),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),W=(0,r.useCallback)((e,t)=>{var n;let o=_({event:d.Sc,markers:[(0,i.m)(e),null!=(n=t.connectionId)?n:""]})||{};v({event:u.K5H,type:g,data:p(E({},t,o),{notebookRuntime:t.notebookRuntime,notebookIdentifier:(0,i.m)(e)})})},[_,v]),H=(0,r.useCallback)((e,n)=>{t(d.Ti,(0,i.m)(e),n.connectionId||""),v({event:u.Uzq,type:g,data:p(E({},n),{notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,t]),$=(0,r.useCallback)((e,t)=>{var n;let o=_({event:d.Ti,markers:[(0,i.m)(e),null!=(n=t.connectionId)?n:""]})||{};v({event:u.y10,type:b,data:p(E({},t,o),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[_,v]),Q=(0,r.useCallback)((e,t)=>{var n;let o=_({event:d.Ti,markers:[(0,i.m)(e),null!=(n=t.connectionId)?n:""]})||{};v({event:u.RSw,type:y,data:p(E({},t,o),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[_,v]),Y=(0,r.useCallback)((e,t)=>{v({event:u.b0z,type:y,data:p(E({},t),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v]),z=(0,r.useCallback)((e,t)=>{var n;let o=_({event:d.Ff,markers:[(0,i.m)(e),null!=(n=t.connectionId)?n:""]})||{};v({event:t.error?u.YeT:u.aDE,type:t.error?y:b,data:p(E({},t,o),{reconnectDurationMs:o.durationMs,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})}),(null==o?void 0:o.durationMs)&&l.v.addDurationVital(u.qyZ,{startTime:Date.now()-o.durationMs,duration:o.durationMs})},[v,_]),q=(0,r.useCallback)((e,t,n,o)=>{let r=o?_(o):{};v({event:u.wi4,type:null!=n?n:b,data:p(E({},t,r),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),Z=(0,r.useCallback)((e,t,n,o)=>{let r=o?_(o):{};v({event:u.wi4,type:null!=n?n:y,data:p(E({},t,r),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),J=(0,r.useCallback)((e,t,n,o,r)=>{v({event:t,type:o?b:y,data:p(E({},n,r?_(r):{}),{notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),X=(0,r.useCallback)((e,t,n,o,r)=>{v({event:t,type:null!=o?o:b,data:p(E({},n,r?_(r):{}),{notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),ee=(0,r.useCallback)(({notebookId:e,event:t,eventData:n,eventType:o,markerInfo:r})=>{v({event:t,type:o,data:p(E({},n,r?_(r):{}),{notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),et=(0,r.useCallback)((e,t,n,o,r)=>{v({event:t,type:null!=o?o:b,data:p(E({},n,r?_(r):{}),{notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v,_]),en=(0,r.useCallback)((e,n,o)=>{t(d.nL,(0,i.m)(e),n.connectionId||"");let r=p(E({},n),{notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)});v({event:u.QuQ,type:g,data:r})},[v,t]),eo=(0,r.useCallback)((e,t)=>{var n;let o=_({event:d.nL,markers:[(0,i.m)(e),null!=(n=t.connectionId)?n:""]})||{};v({event:t.error?u.yzn:u.z_f,type:t.error?y:b,data:p(E({},t,o),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[_,v]),er=(0,r.useCallback)((e,t)=>{var n;let o=_({event:d.Ff,markers:[(0,i.m)(e),null!=(n=t.connectionId)?n:""]})||{};v({event:u.FXf,type:t.error?y:b,data:p(E({},t,o),{reconnectDurationMs:o.durationMs,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[_,v]),ei=(0,r.useCallback)((e,t)=>{v({event:u.Nr9,type:"ui_impression",data:p(E({},t),{notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,i.m)(e)})})},[v]);return(0,r.useMemo)(()=>({logCreateStarted:R,logCreateSuccess:C,logCreateFailed:N,logRenameSuccess:A,logRenameFailed:w,logNotebookEditEvent:et,logOpenDetailPage:L,logError:k,logCellUITelemetry:P,logCellRunTelemetry:D,logWebsocketConnected:M,logWebsocketDisconnected:x,logWebsocketControlMessage:U,logWebsocketStartConnecting:F,logWebsocketHeartbeat:B,logWebsocketHeartbeatStart:G,logWebsocketHeartbeatEnd:V,logWebsocketConnectError:K,logWebsocketConnectionStateChange:j,logSessionReconnectCompleted:z,logSessionEnd:W,logSessionStarting:H,logSessionStartSuccess:$,logSessionStartFailed:Q,logSessionErrorMessage:Y,logKernelRestartBegin:en,logKernelRestartEnd:eo,logRunRequested:q,logRunRequestedError:Z,logRunEvent:J,logIPYNBEvent:X,markEventStart:t,markE2EEventStart:h,measureEvent:n,isMarkerSet:m,logNotebookEvent:ee,logSessionReconnectDetails:er,logNotebookPackageUpdateAlert:ei}),[D,P,R,N,et,C,k,X,L,w,A,J,q,Z,K,M,U,F,x,j,B,G,V,z,W,H,$,Q,Y,en,eo,t,h,n,m,ee,er,ei])}},759331:function(e,t,n){n.d(t,{J0:()=>y,ZN:()=>p});var o=n(184168),r=n(436081),i=n(77822),a=n(236689),l=n(145753),s=n(233174),c=n(499924),u=n(778098),d=n(475085),f=n(337211);let E=[],p=e=>{E.push(e)},b=({reconnect:e})=>{var t;let{formatMessage:n}=(0,u.Z)(),p=n({id:"Cancel"}),b=n({id:"Restart session"}),y=n({id:"OK"}),g=null==(t=c.useContext(r.iL).current)?void 0:t.hideLayer,{editorState:S}=(0,f.P)(),O=(null==S?void 0:S.udfConnectionStatus)===d.Q.NotConnected,h=c.useCallback(()=>{null==g||g()},[g]),m=c.useCallback(()=>{null==g||g(),E.forEach(e=>{e.hide()}),E.length=0},[g]),_=c.useCallback(()=>{e(),E.forEach(e=>{e.hide()}),E.length=0,null==g||g()},[g,e]);return(0,o.jsxs)(i.Pb,{width:500,children:[(0,o.jsx)(i.fK,{children:n({id:"Session ended"})}),(0,o.jsx)(i.a7,{children:(0,o.jsx)(a.x,{color:l.Q2.secondaryTextColor,paddingLeft:8,paddingRight:8,children:n(O?{id:"There was an unexpected problem with the container, and your session ended. Do you want to restart your session?"}:{id:"There was an unexpected problem with the container, and your session ended. A new container will be in use after the session restarts."})})}),(0,o.jsx)(i.cN,{children:O?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.zx,{onClick:h,label:p,marginRight:8,children:p}),(0,o.jsx)(s.zx,{onClick:_,label:b,use:"primary",children:b})]}):(0,o.jsx)(s.zx,{onClick:m,label:y,use:"primary",children:y})})]})};b.displayName="RestartContainerDialog";let y=e=>{let[t,{showLayer:n}]=(0,i.Rh)((0,o.jsx)(b,{reconnect:e}));return c.useLayoutEffect(()=>()=>{},[n]),t}},514248:function(e,t,n){n.d(t,{H:()=>i});var o=n(437239);let r={debug:10,info:20,error:30,reportError:40},i={cacheFiller:new class{constructor(e,t){this.debug=(e,t)=>{if(this.logLevel<=r.debug){let n=null!=t?JSON.stringify(t):"";console.debug(this.category+e,n)}},this.error=(e,t)=>{if(this.logLevel<=r.error){let n=null!=t?JSON.stringify(t):"";console.error(this.category+e,n)}},this.info=(e,t)=>{if(this.logLevel<=r.info){let n=null!=t?JSON.stringify(t):"";console.info(this.category+e,n)}},this.reportError=(e,t,n)=>{this.logLevel<=r.reportError&&(0,o.k)(t,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({domain:"notebooks",loggingCategory:this.rawCategory,type:e},n))},this.assertOrReport=(e,t,n,o)=>{e||this.reportError(t,n,o)},this.logLevel=null!=t?t:r.reportError,this.rawCategory=null!=e?e:"NOTEBOOK",this.category="["+this.rawCategory+"] "}}("CACHE_FILLER",r.error)}},681131:function(e,t,n){n.d(t,{KE:()=>l,QI:()=>a,r9:()=>i});var o=n(184168),r=n(499924);let i=(0,r.createContext)(null),a=e=>{var{children:t}=e,n=function(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,["children"]);let[a,l]=(0,r.useState)(null),[s,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(n.methods||null),[f,E]=(0,r.useState)(n.iframeSrcProps||null),p=(0,r.useMemo)(()=>({methods:u,childFrame:a,childIframeEl:s,iframeSrcProps:f,setMethods:d,setChildFrame:l,setChildIframeEl:c,setIframeSrcProps:E}),[u,a,s,f]);return(0,o.jsx)(i.Provider,{value:p,children:t})};a.displayName="NotebookIframeProvider";let l=()=>{let e=(0,r.useContext)(i);return e||null}},557078:function(e,t,n){n.d(t,{JM:()=>s,VN:()=>l,ZF:()=>c,k$:()=>u});var o=n(750129),r=n(237257),i=n(526014),a=n(499924);let[l,s,c,u]=(0,r.Z)(function({parentOrigin:e}){let t=(0,a.useRef)(null),n=(0,a.useRef)(null),[r,l]=(0,a.useState)(null),[s,c]=(0,a.useState)(void 0),[u,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{n.current=u},[u]),(0,a.useEffect)(()=>{null===t.current&&(t.current=(0,i.y1)({parentOrigin:e,methods:{snowbooks:{syncState:e=>{c(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},e))},dispatchNotebookEditorState:e=>{var t;null==(t=n.current)||t.call(n,e)}}},debug:!1}),t.current.promise.then(e=>{l(e)}).catch(e=>{o.log.error("[Snowbooks] Error connecting to parent:",e)}))},[e]),(0,a.useEffect)(()=>()=>{var e;null==(e=t.current)||e.destroy(),l(null)},[]),{snowbooksParent:r,snowbooksState:s,setDispatchNotebookEditorState:d}},e=>e.snowbooksParent,e=>e.snowbooksState,e=>e.setDispatchNotebookEditorState)},708792:function(e,t,n){n.d(t,{U:()=>l});var o=n(735736),r=n(557078),i=n(242574);function a(){let e=(0,r.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.describeFileBasedEntity}function l(){return(0,i.U)(o.U,a)()}},699395:function(e,t,n){n.d(t,{Z:()=>l});var o=n(810339),r=n(557078),i=n(242574);function a(){var e;let t=(0,r.ZF)();return!!(null==t||null==(e=t.notebookMetadata)?void 0:e.isContainerRuntime)}function l(e){return(0,i.U)(o.Z,a)(e)}},559159:function(e,t,n){n.d(t,{L:()=>l});var o=n(116952),r=n(557078),i=n(242574);function a(){let e=(0,r.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.checkoutOrAddVersionAndRead}function l(){return(0,i.U)(o.L,a)()}},148211:function(e,t,n){n.d(t,{HE:()=>a,LU:()=>i});var o=n(750129),r=n(164214);class i{send(e){if(this.readyState===WebSocket.CONNECTING)return void this.messageQueue.push(e.toString());if(this.readyState!==WebSocket.OPEN)throw Error("WebSocket is not open");window.parent.postMessage({type:"NOTEBOOK_IFRAME_WEBSOCKET_SEND",connectionId:this.connectionId,payload:e},this.origin)}close(e,t){this.readyState!==WebSocket.CLOSED&&(this.readyState=WebSocket.CLOSING,window.parent.postMessage({type:"NOTEBOOK_IFRAME_WEBSOCKET_CLOSE",connectionId:this.connectionId,payload:{code:e,reason:t}},this.origin))}destroy(){window.removeEventListener("message",this.handleParentMessage)}constructor(e,t){this.messageQueue=[],this.readyState=WebSocket.CONNECTING,this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.CONNECTING=WebSocket.CONNECTING,this.OPEN=WebSocket.OPEN,this.CLOSING=WebSocket.CLOSING,this.CLOSED=WebSocket.CLOSED,this.binaryType="blob",this.protocol="",this.url="",this.bufferedAmount=0,this.extensions="",this.handleParentMessage=e=>{var t,n,o,r;if(e.origin!==window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN||e.source!==window.parent)return;let{type:i,connectionId:a,payload:l}=e.data;if(a===this.connectionId)switch(i){case"NOTEBOOK_PARENT_WEBSOCKET_OPEN":this.readyState=WebSocket.OPEN,null==(t=this.onopen)||t.call(this,new Event("open")),this.messageQueue.forEach(e=>this.send(e)),this.messageQueue=[];break;case"NOTEBOOK_PARENT_WEBSOCKET_MESSAGE":null==(n=this.onmessage)||n.call(this,new MessageEvent("message",{data:l}));break;case"NOTEBOOK_PARENT_WEBSOCKET_ERROR":null==(o=this.onerror)||o.call(this,new Event("error"));break;case"NOTEBOOK_PARENT_WEBSOCKET_CLOSE":this.readyState=WebSocket.CLOSED,null==(r=this.onclose)||r.call(this,new CloseEvent("close",l))}},this.url=e,this.protocol=Array.isArray(t)?t[0]:t||"",this.origin=window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN||"null",this.connectionId=(0,r.Z)(),window.addEventListener("message",this.handleParentMessage),window.parent.postMessage({type:"NOTEBOOK_IFRAME_WEBSOCKET_CREATE",connectionId:this.connectionId,payload:{url:e,protocols:t}},this.origin)}}i.CONNECTING=0,i.OPEN=1,i.CLOSING=2,i.CLOSED=3;class a{createWebSocket(e,t,n){if(!this.supportedUrls.includes(t))return void o.log.error("Unsupported URL");let r=new WebSocket(t,n);r.binaryType="arraybuffer";let i={websocket:r,childWindow:this.childWindow,origin:this.origin};this.connections.set(e,i),r.onopen=()=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_OPEN",connectionId:e},this.origin)},r.onmessage=t=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_MESSAGE",connectionId:e,payload:t.data},this.origin)},r.onerror=()=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_ERROR",connectionId:e},this.origin)},r.onclose=t=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_CLOSE",connectionId:e,payload:{code:t.code,reason:t.reason,wasClean:t.wasClean}},this.origin),this.connections.delete(e)}}destroy(){for(let[e,t]of(window.removeEventListener("message",this.handleChildMessage),this.connections))t.websocket.close(),this.connections.delete(e)}constructor(e,t,n){this.connections=new Map,this.handleChildMessage=e=>{let t;if(e.origin!==this.origin||e.source!==this.childWindow)return;let{type:n,connectionId:o,payload:r}=e.data;switch(n){case"NOTEBOOK_IFRAME_WEBSOCKET_CREATE":this.createWebSocket(o,r.url,r.protocols);break;case"NOTEBOOK_IFRAME_WEBSOCKET_SEND":var i;null==(i=this.connections.get(o))||i.websocket.send(r);break;case"NOTEBOOK_IFRAME_WEBSOCKET_CLOSE":(t=this.connections.get(o))&&(t.websocket.close(r.code,r.reason),this.connections.delete(o))}},this.childWindow=e,this.origin=t,this.supportedUrls=n,window.addEventListener("message",this.handleChildMessage)}}},242574:function(e,t,n){n.d(t,{U:()=>i});var o=n(499924),r=n(983339);function i(e,t){let n=(0,o.useRef)(e),i=(0,o.useRef)(!1),a=(0,r.w)();return window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN&&a&&!i.current&&(i.current=!0,n.current=t),n.current}},65180:function(e,t,n){n.d(t,{Hx:()=>tE,PW:()=>tu,QE:()=>td});var o=n(184168),r=n(630455),i=n(567410),a=n(467131),l=n(237257),s=n(269782),c=n.n(s),u=n(499924),d=n(778098),f=n(657321),E=n(164214),p=n(67158),b=n(962689),y=n(254759),g=n(551276),S=n(243100),O=n(708792),h=n(307134),m=n(609737),_=n(896426),I=n(459510),T=n(562940),v=n(936057),R=n(228989),C=n(893538),N=n(367092),A=n(888890);let w=(e,t)=>{let n={primaryRole:e};if(t===A.Bq||""===t)n.allSelected=!0;else if(t===A.sM)n.noneSelected=!0;else if(t){let e=t.split(",").map(e=>e.trim()).filter(e=>!!e);e.length>0&&(n.selected={role:e})}return n},L=e=>{var t;return e.allSelected?A.Bq:e.noneSelected?A.sM:(null==(t=e.selected)?void 0:t.role)?e.selected.role.join(","):""};var k=n(77822),P=n(233174),D=n(665007);let M=({hide:e,restart:t})=>(0,o.jsxs)(k.Vq,{manuallyShown:!0,causalElement:{current:null},children:[(0,o.jsx)(k.fK,{children:(0,o.jsx)(D.Z,{id:"Restart required"})}),(0,o.jsx)(k.a7,{children:(0,o.jsx)(D.Z,{id:"Due to a conflict with updated packages, a session restart is required. This will reset any variables you might have created."})}),(0,o.jsxs)(k.cN,{children:[(0,o.jsx)(P.zx,{onClick:e,children:(0,o.jsx)(D.Z,{id:"Not now"})}),(0,o.jsx)(P.zx,{use:"primary",marginLeft:8,onClick:()=>{try{t()}finally{e()}},children:(0,o.jsx)(D.Z,{id:"Restart session"})})]})]});M.displayName="PackageUpdateAlertDialog";var U=n(730434),j=n(139545),x=n(983339),F=n(993914),B=n(787679),G=n(557078),V=n(242574);function K(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.refreshLastUpdatedInfo}var W=n(559159),H=n(743532);function $(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.getNotebookHistoryFile}var Q=n(815877);function Y(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.writeToStageByObject}var z=n(261042),q=n(571902);let Z=()=>{let e=(0,V.U)(H.U,$)(),{user:t}=(0,y.m)(["user"]),n=(0,W.L)(),o=t.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_APEX_FEATURE_32"),a=m.flags.FEATURE_UI_ENABLE_NOTEBOOKS_SCHEDULING(),l=m.flags.UI_ENABLE_NOTEBOOK_FEATURE_10();return(0,r.z)(async(t,r)=>{let{id:s,role:c,secondaryRoles:u,queryId:d}=t;try{let t=d?await e({notebookId:s,historyQueryId:d}):await n(s,c,u);d&&!t&&(t=await n(s,c,u)),r({type:"LOAD_SUCCEEDED",id:s,role:c,secondaryRoles:u,error:null,result:t,enforceUUIDAsCellId:o,enableSafeCellIdGeneration:a,isCellNameAndVariableConflictDetectionEnabled:l})}catch(e){(0,i.w)({content:e.message,type:"alert",autoDismiss:!1}),r({type:"LOAD_FAILED",id:s,role:c,secondaryRoles:u,error:e})}})},J=()=>{let e=(0,V.U)(Q.Nk,Y)(),t=(0,V.U)(B._,K)(),n=(0,O.U)(),{localTimeToServerTime:o}=(0,q.h)(),a=m.flags.UI_ENABLE_NOTEBOOK_FEATURE_24(),l=m.flags.UI_ENABLE_NOTEBOOK_FEATURE_0(),s=(0,z.d)(),c=(0,y.m)(["user"]);return(0,r.z)(async(r,u)=>{var d,f,E,p,b,y,g,S,O;let h,m,{id:_,role:I,secondaryRoles:T,content:v,lastEditStatus:R,isSourceCodeChange:C,lastestNotebookLoadTime:N,currentNotebookViewId:A}=r,w=v,L="",k="canSave";try{if(a){let{urlId:e}=await n(_,I,T);L=e;let{checkStatus:t,lastEditStatusRetrieved:o}=await s({id:_,urlId:e,currentNotebookViewId:A,lastEditStatusInMemory:R,lastestNotebookLoadTime:N});k=t,m=null!=o?o:void 0,h=null!=(d=null!=o?o:R)?d:void 0}if("canSave"!==k){if(!C)return void u({type:"SAVE_SUCCEEDED",id:_,role:I,secondaryRoles:T,error:null,editStatusToUpdate:m,saveDone:!1,isSourceCodeChange:C});u({type:"SAVE_FAILED",id:_,role:I,secondaryRoles:T,error:null,editStatusToUpdate:m,isSourceCodeChange:C,saveEligibilityCheckStatus:k,editingUserId:null!=(f=null==h?void 0:h.authorId)?f:"",editingUserName:null!=(E=null==h?void 0:h.authorName)?E:"",editingUserEmail:null==h?void 0:h.authorEmail,lastEditTime:null==h?void 0:h.lastEditTime});return}if(a&&C){let e=Date.now(),t=o(e);m={notebookId:L,authorId:null!=(y=c.user.currentUserId)?y:"",authorName:null!=(g=null==(p=c.user.currentUser)?void 0:p.username)?g:"",authorEmail:null==(b=c.user.currentUser)?void 0:b.email,sessionId:A,lastEditTime:t};let n=JSON.parse(v);n.metadata.lastEditStatus=m,w=JSON.stringify(n,null,1),h=m}await e(_,I,T,w,!0),u({type:"SAVE_SUCCEEDED",id:_,role:I,secondaryRoles:T,error:null,editStatusToUpdate:m,saveDone:!0,isSourceCodeChange:C}),await t(_,I,T)}catch(e){if(l&&(0,F.e)(e))return void u({type:"NETWORK_CONDITION_CHANGED",id:_,role:I,secondaryRoles:T,onlineToSnowflakeServer:!1});if(a&&!C)return void u({type:"SAVE_SUCCEEDED",id:_,role:I,secondaryRoles:T,error:null,editStatusToUpdate:m,saveDone:!1,isSourceCodeChange:C});(0,i.w)({content:e.message,type:"alert"}),u({type:"SAVE_FAILED",id:_,role:I,secondaryRoles:T,error:e,editStatusToUpdate:m,editingUserId:null!=(S=null==h?void 0:h.authorId)?S:"",editingUserName:null!=(O=null==h?void 0:h.authorName)?O:"",editingUserEmail:null==h?void 0:h.authorEmail,lastEditTime:null==h?void 0:h.lastEditTime,isSourceCodeChange:C})}})},X=()=>{let e=Z(),t=J();return(0,u.useMemo)(()=>({readFromStage:e,writeToStage:t}),[e,t])};var ee=n(98047),et=n(882682);function en(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.createWebsocketProtoParams}var eo=n(962624);function er(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.deleteNotebookInstances}var ei=n(838783);function ea(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.fetchNotebookAuthToken}var el=n(862399);function es(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.fetchNotebookUrlInfo}var ec=n(255379);function eu(){let e=(0,G.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.saveNotebookUserSessionSettings}function ed(){let e=(0,G.JM)();return(null==e?void 0:e.snowbooks)?t=>{var n,o,r;if(!t.notebookState)return;let i=(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},t),r=r={notebookState:null==(n=t.notebookState)?void 0:n.toJson()},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))}),o);e.snowbooks.reifyNotebookEditorState(i)}:()=>{}}function ef(){return()=>{}}let eE=()=>(0,V.U)(ef,ed)();var ep=n(148211),eb=n(3535),ey=n(475085),eg=n(79517),eS=n(436978),eO=n(499269),eh=n(771661);let em=["SAVE_SUCCEEDED","SAVE_FAILED","START_NOTEBOOK","RUN_NOTEBOOK","CANCEL_EXECUTION","UPDATE_PACKAGE"],e_=e=>!!em.includes(e.type)&&("RUN_NOTEBOOK"!==e.type&&"START_NOTEBOOK"!==e.type||!1!==e.userTriggered);var eI=n(900352),eT=n(674337),ev=n(952624),eR=n(408195);let eC=()=>(0,o.jsx)(D.Z,{id:"Can’t start container notebooks using the ACCOUNTADMIN, SECURITYADMIN, or ORGADMIN roles. Switch your role by clicking your profile icon in the left navigation menu, and then try again."});var eN=n(327879),eA=n(523692);function ew(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function eL(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function ek(e,t,n){var r,i,a;let l=e.notebookState,s=e.udfConnectionStatus,c="spcs"===e.notebookRuntime,u=(0,eN.e)(t.role)&&c;if(!l)return void console.debug("Notebook state is not yet loaded");if(u)return void n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"alert",content:eC(),autoDismiss:!1}});if(c){let e=function(e){switch(e){case"valid":return null;case"empty":return(0,o.jsx)(D.Z,{id:"Missing"});case"tooLong":return(0,o.jsx)(D.Z,{id:"Couldn’t start notebook. Notebook name exceeds maximum length of 255 characters"});case"invalidCharacters":return(0,o.jsx)(D.Z,{id:"Couldn’t start notebook. Notebook name can only include letters, numbers, spaces, underscores, -, $, and :"})}}((0,eA.V)(t.id.name));if(e)return void n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"alert",content:e,autoDismiss:!1}})}if((null==(r=e.sessionLifecycleState)?void 0:r.isReplayingMessagesAfterReconnect)||s!==ey.Q.Connecting&&s!==ey.Q.Reconnecting)s===ey.Q.NotConnected&&(e.udfConnectionStatus=ey.Q.Connecting,e.sessionLifecycleState=eL(ew({},null!=(a=e.sessionLifecycleState)?a:{}),{sessionStartTimeMs:Date.now(),sessionEndTimeMs:void 0,sessionEndReason:void 0,sessionStartId:E.Z()}),n({type:"logNotebookStartingSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles}));else{(null==(i=e.sessionLifecycleState)?void 0:i.sessionEndReason)&&(e.sessionLifecycleState.sessionEndReason=void 0);return}"running"!==e.runStatus&&(e.runStatus="waiting");let d=l.getCellsProto().filter(e=>"markdown"!==e.type);t.clearCodeResults&&(d=d.map(e=>eL(ew({},e),{code:""}))),n({id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,type:"runCells",cellRunType:t.cellRunType,runCellId:t.runCellId,clientState:t.clientState,cells:d,eventType:t.eventType,notebookRuntime:e.notebookRuntime})}function eP(e,t,n){var o,r,i,a,l;let s=e.notebookState;if(!s)return;let c=null==(o=e.notebookState)?void 0:o.data.cells,u=(0,eR.i)(null!=c?c:[]),d=(0,ev.B)(t.cellType,u),f=s.addCell(t.index,d);return e.notebookState=f,e.selectedCell=d.id,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:f.toJson(),currentNotebookViewId:null!=(i=null==(r=e.sessionLifecycleState)?void 0:r.notebookViewId)?i:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(l=e.notebookState.getLastEditStatus())?l:null}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.JW3,data:{cellId:d.id,cellIndex:t.index,cellType:t.cellType}}),f}var eD=n(689500),eM=n(429523),eU=n(750671),ej=n(783844),ex=n(137040);let eF=()=>(0,o.jsx)(D.Z,{id:"Kernel restarted. Your notebook is ready to run."});var eB=n(759331);function eG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function eV(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eK=n(750129),eW=n(399696),eH=n(137757),e$=n(437239),eQ=n(274438);function eY(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}let ez={UPDATE_RESULT:(e,t)=>{let n=t.cellId,o=e.notebookState;if(!o)return;let r=o.getCellResult(n);if(!r)return;let i=o,a=r.runId,l=r.tempRunId;if(!l||l!==a)if("running"===r.status.cellRunStatus)i=i.updateCellResult(n,{message:[t.result]});else{let e=r.message;i=i.updateCellResult(n,{message:[...e,t.result]})}let s=r.status.cellRunStatus;(0,eQ.be)(s)?(0,e$.k)("Received forward message for a cell already done",{cellId:n}):i=i.updateCellStatus(n,{cellRunStatus:(0,eW.G)(t.result)?"unfinishedError":"populatingResults"}),e.notebookState=i},CELL_RUN_STARTED:(e,t)=>{var n,o,r,i,a,l;let s=t.cellRunInfo.cellId,c=e.notebookState;c&&s&&(e.notebookState=c.updateCellResult(s,{tempSelfContentHash:null!=(o=t.cellRunInfo.selfContentHash)?o:void 0,tempFullContentHash:null!=(r=t.cellRunInfo.fullContentHash)?r:void 0,tempRunId:null!=(i=t.cellRunInfo.runId)?i:void 0,tempParentExecutionId:null!=(a=t.cellRunInfo.parentExecutionId)?a:void 0,tempExecutionId:null!=(l=t.cellRunInfo.executionId)?l:void 0}).updateCellStatus(s,{cellRunStatus:"running",startedAt:t.cellRunInfo.startedAt?"number"==typeof t.cellRunInfo.startedAt?t.cellRunInfo.startedAt:null==(n=t.cellRunInfo.startedAt)?void 0:n.toNumber():void 0,endAt:void 0,pushdownQueries:[]}))},CELL_RUN_FINISHED:(e,t)=>{let{cellId:n}=t,o=e.notebookState;if(!o)return;let r=o.getCellResult(n);if(!r)return;let i=o;"error"!==t.state&&(i=(i=i.updateCellResult(n,{selfContentHash:r.tempSelfContentHash,fullContentHash:r.tempFullContentHash,runId:r.tempRunId,parentExecutionId:r.tempParentExecutionId,executionId:r.tempExecutionId,tempSelfContentHash:void 0,tempFullContentHash:void 0,tempRunId:void 0,tempParentExecutionId:void 0,tempExecutionId:void 0})).updatePredictExecutionId(n)),"running"===r.status.cellRunStatus&&(i=i.updateCellResult(n,{message:[]})),i="unfinishedError"===r.status.cellRunStatus?i.updateCellStatus(n,{cellRunStatus:"idle"===t.state?"idle":"error"}):i.updateCellStatus(n,{cellRunStatus:"errorStopRunning"===t.state?"error":t.state}),0!==t.timestamp&&(i=i.updateCellStatus(n,{endAt:t.timestamp})),e.notebookState=i},NOTEBOOK_RUN_FINISHED:(e,t)=>{let n=e.notebookState;if(!n)return;let o=n;for(let e of n.data.cells)("running"===e.result.status.cellRunStatus||"populatingResults"===e.result.status.cellRunStatus)&&(o=o.updateCellStatus(e.id,{cellRunStatus:"error"})),"waiting"===e.result.status.cellRunStatus&&(3===t.state||4===t.state)&&(o=o.updateCellStatus(e.id,{cellRunStatus:e.result.status.cellRunStatusBeforeExecution}));e.notebookState=o,e.runStatus="idle"},NOTEBOOK_RUN_STARTED:(e,t)=>{var n,o,r,i;e.runStatus="running",e.cacheStatus="loaded";let a=e.notebookState;if(!a)return;let l=a;for(let e of t.cellIdsToRun)l=l.updateCellStatus(e,{cellRunStatus:"waiting",cellRunStatusBeforeExecution:null!=(o=null==(n=l.getCellById(e))?void 0:n.result.status.cellRunStatus)?o:"neverRun"});e.notebookState=l,e.udfConnectionStatus!==ey.Q.Connected&&(e.udfConnectionStatus=ey.Q.Connected,r=eY({},e.sessionLifecycleState),i=i={sessionEndReason:void 0},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))}),e.sessionLifecycleState=r),e.bottomBarState=void 0},NOTEBOOK_CACHE_STARTED:e=>{e.cacheStatus="fetching"},NOTEBOOK_CACHE_DONE:e=>{e.cacheStatus="loaded"},NOTEBOOK_CELL_STATUS:(e,t)=>{let n=e.notebookState;if(!n)return;let o=t.cellStatus.cellId,r=n.getCellById(o);if(r){if((0,eD.ro)(r))e.notebookState=n.updateCellStatus(t.cellStatus.cellId,{pushdownQueries:[]});else if((0,eD.XN)(r)){var i,a;e.notebookState=n.updateCellStatus(t.cellStatus.cellId,{pushdownQueries:null!=(a=null==(i=t.cellStatus.sqlCellStatus)?void 0:i.pushdownQueries)?a:[]})}}},NOTEBOOK_UPDATE_RESOURCE_USAGE:(e,t)=>{var n;e.resourceStats=null==(n=t.resourceUtilization)?void 0:n.resourceStats},NOTEBOOK_SESSION_SETTINGS_UPDATED:(e,t,n)=>{let{id:o,role:r,secondaryRoles:i,sessionSettings:a}=t,{queryWarehouse:l,role:s}=a,c=eY({},e.notebookSessionSettingsState.settings);l&&(c.queryWarehouse=l),s&&(c.role=s.primaryRole||c.role,c.secondaryRoles=L(s)||c.secondaryRoles),e.notebookSessionSettingsState.settings=c,e.notebookSessionSettingsState.settingsUpdateSource="RuntimeCodes",e.notebookSessionSettingsState.settingsUpdateTime=Date.now(),e.notebookSessionSettingsState.settingsCheckResponse={status:"success"},n({type:"saveNotebookSessionSettings",id:o,role:r,secondaryRoles:i,sessionSettings:c})}},eq=(e,t,n)=>{let o=ez[t.type];void 0!==o&&o(e,t,n)};function eZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function eJ(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eX=n(7042);function e0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function e1(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function e9({notebookViewId:e,notebookUrlInfo:t}){return{loadStatus:"notLoaded",notebookState:null,runStatus:"notStarted",websocketStatus:{status:ey.Q.NotConnected,error:null},selectedCell:void 0,cacheStatus:"notLoaded",cacheLoadId:void 0,udfConnectionStatus:ey.Q.NotConnected,sessionLifecycleState:{notebookViewId:null!=e?e:E.Z(),onlineToSnowflakeServer:!0},urlId:"",resultHeightMap:{},cellContentMetadata:{},notebookUrlInfo:t,notebookSessionSettingsState:{settings:{}}}}function e4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}let e2=e4({START_LOADING:(e,t,n)=>{n({type:"readFromStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,queryId:t.queryId}),e.loadStatus="loading",n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.weH,eventType:"ui_visit"})},LOAD_SUCCEEDED:(e,t,n)=>{try{var o,r;e.notebookState=eM.v.fromJson(t.result,{enforceUUIDAsCellId:null!=(o=t.enforceUUIDAsCellId)&&o,enableSafeCellIdGeneration:null!=(r=t.enableSafeCellIdGeneration)&&r,isCellNameAndVariableConflictDetectionEnabled:t.isCellNameAndVariableConflictDetectionEnabled}),e.loadStatus="loaded",e.lastestNotebookLoadTime=Date.now(),n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.j4e,eventType:"ui_response_success"})}catch(o){e.error=o,e.loadStatus="error",n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.vJg,eventType:"ui_response_error",data:{error:null==o?void 0:o.message}})}},LOAD_FAILED:(e,t,n)=>{var o;e.error=t.error,e.loadStatus="error",n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.vJg,eventType:"ui_response_error",data:{error:null==(o=t.error)?void 0:o.message}})},START_SAVING:(e,t,n)=>{var o,r,i,a;let l=e.notebookState;"loaded"===e.loadStatus&&l&&n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:l.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(a=l.getLastEditStatus())?a:null})},SAVE_SUCCEEDED:function(e,t,n){let{editStatusToUpdate:o,saveDone:r,isSourceCodeChange:i}=t;r&&(e.lastestNotebookLoadTime=Date.now()),(null==e?void 0:e.notebookState)&&o&&(e.notebookState=e.notebookState.updateLastEditStatus(o)),n({type:"logNotebookEditTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.ZOT,eventType:"ui_response_success",data:{currentEditingUser:null==o?void 0:o.authorId,lastEditTime:null==o?void 0:o.lastEditTime,saveEligibilityCheckStatus:"canSave",saveDone:r,isSourceCodeChange:i}})},SAVE_FAILED:function(e,t,n){var o;e.error=t.error;let{editStatusToUpdate:r,saveEligibilityCheckStatus:i,editingUserId:a,editingUserName:l,editingUserEmail:s,lastEditTime:c,isSourceCodeChange:u}=t;(null==e?void 0:e.notebookState)&&r&&(e.notebookState=e.notebookState.updateLastEditStatus(r)),i&&"canSave"!==i&&n({type:"onNotebookConcurrentEditAlert",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,saveEligibilityCheckStatus:i,editingUserName:null!=l?l:"",editingUserEmail:s}),n({type:"logNotebookEditTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.Ari,eventType:"ui_response_error",error:i&&"canSave"!==i?i:String(null!=(o=t.error)?o:""),data:{currentEditingUser:a,lastEditTime:c,saveEligibilityCheckStatus:i,isSourceCodeChange:u}})},UPDATE_NOTEBOOK_RUNTIME:function(e,t){e.notebookRuntime=t.notebookRuntime},SET_URL_ID_AND_RESULT_HEIGHT_MAP:function(e,t){e.urlId=t.urlId,e.resultHeightMap=t.resultHeightMap},FETCH_RESOURCE_USAGE:function(e,t,n){let{id:o,role:r,secondaryRoles:i}=t;e.udfConnectionStatus===ey.Q.Connected&&n({type:"fetchResourceUsage",id:o,role:r,secondaryRoles:i})},SET_BOTTOM_BAR_STATE:function(e,t){var n;t.expectedPrevType&&(null==(n=e.bottomBarState)?void 0:n.type)!==t.expectedPrevType||(e.bottomBarState=t.bottomBarState)},UPDATE_EDIT_STATUS:function(e,t){let{editStatusToUpdate:n}=t;(null==e?void 0:e.notebookState)&&n&&(e.notebookState=e.notebookState.updateLastEditStatus(n))},SET_NOTEBOOK_URL_INFO:function(e,t){let{urlInfo:n}=t;e.notebookUrlInfo=n},ADD_CELL:eP,MODIFIED_CELL:function(e,t,n){let o=t.writeToStage,r=e.notebookState;if(!r)return;let i=r.modifyCell(t.index,t.content);if(t.language&&(i=i.setLanguage(t.index,t.language)),t.isProgrammaticContentUpdate){e.cellContentMetadata||(e.cellContentMetadata={});let n=i.data.cells[t.index].id;e.cellContentMetadata[n]||(e.cellContentMetadata[n]={}),e.cellContentMetadata[n].lastProgrammaticUpdateTime=Date.now()}if(e.notebookState=i,o){var a,l,s,c;n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:i.toJson(),currentNotebookViewId:null!=(l=null==(a=e.sessionLifecycleState)?void 0:a.notebookViewId)?l:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(s=e.lastestNotebookLoadTime)?s:0,lastEditStatus:null!=(c=e.notebookState.getLastEditStatus())?c:null})}return i},ADD_AND_MODIFY_CELL:function(e,t,n){var o,r,i,a,l,s,c;let u=e.notebookState;if(!u)return;let d=e.selectedCell,f=u.data.cells.findIndex(e=>e.id===d),E=-1===f?u.data.cells.length:f+1,p=null==(o=e.notebookState)?void 0:o.data.cells,b=(0,eR.i)(null!=p?p:[]),y=(0,ev.B)(t.cellType,b,t.content),g=u.addCell(E,y);e.notebookState=g,e.selectedCell=y.id,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:g.toJson(),currentNotebookViewId:null!=(i=null==(r=e.sessionLifecycleState)?void 0:r.notebookViewId)?i:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(l=e.notebookState.getLastEditStatus())?l:null}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.JW3,data:{cellId:y.id,cellIndex:E,cellType:t.cellType}}),t.runCellAfterCreation&&ek(e,(s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},t),c=c={type:"RUN_NOTEBOOK",runCellId:y.id,cellRunType:0,userTriggered:!0},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(c)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(c)).forEach(function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(c,e))}),s),n)},CELL_LANGUAGE:(e,t,n)=>{var o,r,i,a;let l=e.notebookState;if(!l)return;let s=l.setLanguage(t.index,t.language);e.notebookState=s,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:s.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(a=e.notebookState.getLastEditStatus())?a:null})},CELL_CONTENT_STATE:(e,t)=>{let n=e.notebookState;n&&(e.notebookState=n.setContentState(t.index,t.contentState))},CELL_RESULT_HEIGHT:(e,t,n)=>{e.resultHeightMap[t.cellId]=t.resultHeight,t.shouldSave&&n({type:"saveResultHeight",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,urlId:e.urlId,cellId:t.cellId,resultHeight:t.resultHeight})},REMOVE_CELL:(e,t,n)=>{var o,r,i,a;let l=e.notebookState;if(!l)return;let s=l.data.cells[t.index],c=s.id,u=(0,eD.DA)(s),d=l.removeCell(t.index);e.notebookState=d;let f=Math.min(d.data.cells.length-1,t.index);e.selectedCell=f>=0?d.data.cells[f].id:void 0,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:d.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(a=e.notebookState.getLastEditStatus())?a:null}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.Q_$,data:{cellId:c,cellIndex:t.index,cellType:u}})},INSERT_BEFORE_CELL:(e,t,n)=>{var o,r,i,a;let l=e.notebookState;if(!l)return;e.selectedCell=l.data.cells[t.from].id;let s=l.insertBefore(t.from,t.to);e.notebookState=s,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:s.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(a=e.notebookState.getLastEditStatus())?a:null}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.jSd})},MOVE_CELL_UP:(e,t,n)=>{var o,r,i,a;let l=e.notebookState;if(!l)return;let s=l.data.cells[t.index],c=s.id,u=(0,eD.DA)(s),d=l.moveCellUp(t.index);e.notebookState=d;let f=l.getCellResult(c);n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:d.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(a=e.notebookState.getLastEditStatus())?a:null}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.ETJ,data:{cellId:c,cellIndex:t.index,cellType:u,runId:null==f?void 0:f.runId}})},MOVE_CELL_DOWN:(e,t,n)=>{var o,r,i,a;let l=e.notebookState;if(!l)return;let s=l.data.cells[t.index],c=s.id,u=(0,eD.DA)(s),d=l.moveCellDown(t.index);e.notebookState=d;let f=l.getCellResult(c);n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:d.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(a=e.notebookState.getLastEditStatus())?a:null}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.G1R,data:{cellId:c,cellIndex:t.index,cellType:u,runId:null==f?void 0:f.runId}})},ADVANCE_CELL:function(e,t,n){let o=e.notebookState;if(!o)return;let r=o.data.cells,i=o.getCellById(t.runCellId),a=o.getCellIndexById(t.runCellId);i&&void 0!==a&&(a+1>=r.length?eP(e,{type:"ADD_CELL",cellType:(0,eD.M1)(i)?i.metadata.language:"markdown",index:a+1,role:t.role,secondaryRoles:t.secondaryRoles,id:t.id},n):e.selectedCell=r[a+1].id||void 0)},UPDATE_SELECTED_CELL:function(e,t){e.selectedCell=t.cellId},UNSELECT_CELL:function(e){e.selectedCell=void 0},RENAME_CELL:function(e,t,n){let o=e.notebookState;if(!o)return;let{newCellName:r,index:i,id:a,role:l,secondaryRoles:s}=t;e.runStatus="idle";let{isValid:c}=(0,eg.Ke)(r,o.getGlobalVariables()),u=(0,eg.ae)(o.data.cells,r,i);if(c&&u){var d,f,E,p;let t=o.renameCell(i,r);n({type:"writeToStage",id:a,role:l,secondaryRoles:s,content:t.toJson(),currentNotebookViewId:null!=(f=null==(d=e.sessionLifecycleState)?void 0:d.notebookViewId)?f:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(E=e.lastestNotebookLoadTime)?E:0,lastEditStatus:null!=(p=t.getLastEditStatus())?p:null}),e.notebookState=t}u||n({type:"onNotebookError",id:a,role:l,secondaryRoles:s,error:eg._y.DUPLICATE,logError:!1})},UPDATE_MARKDOWN_CELL_RESULT:function(e,t){let n=e.notebookState;if(!n)return void console.error("Cannot update markdown result as Notebook state is not initialized yet");let{cellId:o,message:r}=t;e.notebookState=n.updateCellResult(o,{message:[r]}).updateCellStatus(o,{cellRunStatus:"idle"})},RECEIVE_MESSAGE:(e,t,n)=>{var o,r,i,a,l,s,c,u,d,f,E,p,b,y,g,S,O,h,m,I;let{message:T,id:v,role:R,secondaryRoles:C}=t;if(null==(o=T.notebookStart)?void 0:o.isCache)eq(e,{type:"NOTEBOOK_CACHE_STARTED"},n),n({type:"logNotebookRunTelemetry",event:eT.F1$,id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{isCache:!0}});else if(null==(r=T.notebookStart)?void 0:r.cellIdsToRun){let o=e.udfConnectionStatus;eq(e,{type:"NOTEBOOK_RUN_STARTED",cellIdsToRun:T.notebookStart.cellIdsToRun},n),o!==e.udfConnectionStatus&&e.udfConnectionStatus===ey.Q.Connected&&(o===ey.Q.Reconnecting?(e.sessionLifecycleState&&(e.sessionLifecycleState.reconnectResultInfo={}),n({type:"fetchLatestNotebookSessionSettings",id:v,role:R,secondaryRoles:C}),n({type:"logSessionReconnectCompleted",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{}}),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles})):o===ey.Q.Connecting&&n({type:"logNotebookSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{isSuccess:!0,previousUdfStatus:o}}));let r=(0,eO.Js)(e),i=[];for(let e of T.notebookStart.cellIdsToRun){let t=null==r||null==(a=r.notebookState)?void 0:a.getCellById(e);t?i.push((0,eD.DA)(t)):i.push("unknown")}n({type:"logNotebookRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.dJY,data:{cellIdsToRun:T.notebookStart.cellIdsToRun,cellTypes:i}}),n({type:"startRunningNotebookHeartbeat",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles})}else if(T.cellRunInfo&&T.cellRunInfo.cellId&&T.cellRunInfo.runId){let o=(0,eO.Js)(e),r=T.cellRunInfo.cellId?null==o||null==(l=o.notebookState)?void 0:l.getCellById(T.cellRunInfo.cellId):void 0;eq(e,{type:"CELL_RUN_STARTED",cellRunInfo:T.cellRunInfo},n);let i=T.cellRunInfo.cellId;(0,_.H$)(eb.kk,i),n({type:"logNotebookCellRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT._KU,data:{cellId:i,runId:T.cellRunInfo.runId,cellType:r?(0,eD.DA)(r):""},markerInfo:{event:eb.QX,markers:[i]}})}else if(T.cellRunDone&&T.cellRunDone.cellId){let o=e.cacheStatus,r=1===T.cellRunDone.state,i=T.cellRunDone.cellId,a="success";"fetching"===o?a="idle":r||(a=4===T.cellRunDone.state?"errorStopRunning":"error"),eq(e,{type:"CELL_RUN_FINISHED",cellId:i,state:a,timestamp:"number"==typeof T.cellRunDone.timestamp?T.cellRunDone.timestamp:T.cellRunDone.timestamp.toNumber(),role:R,secondaryRoles:C,id:v},n);let l=e.notebookState;if(!l)return;let u=l.getCellResult(i),d=l.getCellById(i),f=d?(0,eD.DA)(d):"",E=l.getCellResultSize(i),p=l.getCellResultQueryId(i);n({type:"logNotebookCellRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.Hn4,data:{cellId:T.cellRunDone.cellId,isSuccess:r,error:r?void 0:null!=(s=T.cellRunDone.errorId)?s:void 0,cause:r?void 0:null!=(c=T.cellRunDone.additionalErrorMessage)?c:void 0,cellType:f,bytesLoaded:E,queryId:p,runId:null==u?void 0:u.runId},markerInfo:{event:eb.kk,markers:[T.cellRunDone.cellId]}})}else if(T.cellForwardMsg){let o=null==(u=T.cellForwardMsg)?void 0:u.forwardMsg,r=T.cellForwardMsg.cellId;if(!r&&o&&(0,eW.G)(o)){let r=null==o||null==(p=o.delta)||null==(E=p.newElement)||null==(f=E.exception)?void 0:f.message,i=e.udfConnectionStatus===ey.Q.Connecting,a=e.udfConnectionStatus===ey.Q.Reconnecting;(i||a)&&(e.udfConnectionStatus=ey.Q.NotConnected),i?n({type:"logNotebookSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{isSuccess:!1,error:r}}):a?(e.sessionLifecycleState&&(e.sessionLifecycleState.reconnectResultInfo={error:r}),n({type:"logSessionReconnectCompleted",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{error:r}}),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles})):n({type:"logNotebookSessionErrorMessage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{error:r}}),n(r&&(0,eH.T)(r)?{type:"onExternalAccessIntegrationError",id:v,role:R,secondaryRoles:C,error:r}:{type:"onNotebookError",id:v,role:R,secondaryRoles:C,error:null!=r?r:""}),eq(e,{type:"NOTEBOOK_RUN_FINISHED",state:2},n)}if(!r)return;let i=null==(d=e.notebookState)?void 0:d.getCellById(r);if(void 0===i)return;(null==o?void 0:o.delta)&&eq(e,{type:"UPDATE_RESULT",cellId:i.id,result:o},n)}else if(null==(i=T.notebookDone)?void 0:i.isCache){eq(e,{type:"NOTEBOOK_CACHE_DONE"},n);let o=e.udfConnectionStatus===ey.Q.Reconnecting;n({type:"logNotebookRunTelemetry",event:eT.AK5,id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{isCache:!0,isReconnect:o}})}else if(T.controlResponse){if(T.controlResponse.resourceUtilization)eq(e,{type:"NOTEBOOK_UPDATE_RESOURCE_USAGE",resourceUtilization:T.controlResponse.resourceUtilization},n);else if(T.controlResponse.requestId){let e=null!=(y=T.controlResponse.requestId)?y:"";eK.log.warn(`Received controlResponse with id: ${e}`),n({type:"controlResponseStatus",id:v,role:R,secondaryRoles:C,requestId:T.controlResponse.requestId,status:null!=(g=null==(b=T.controlResponse)?void 0:b.status)?g:void 0})}}else if(T.notebookDone&&T.notebookDone.state){let o=2===T.notebookDone.state,r=null==(S=e.sessionLifecycleState)?void 0:S.isReplayingMessagesAfterReconnect;m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},null!=(O=e.sessionLifecycleState)?O:{}),I=I={isReplayingMessagesAfterReconnect:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(I)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(I)).forEach(function(e){Object.defineProperty(m,e,Object.getOwnPropertyDescriptor(I,e))}),e.sessionLifecycleState=m,o&&T.notebookDone.additionalErrorMessage&&n({type:"onNotebookError",id:v,role:R,secondaryRoles:C,error:T.notebookDone.additionalErrorMessage}),eq(e,{type:"NOTEBOOK_RUN_FINISHED",state:T.notebookDone.state},n),n({type:"logNotebookRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.MKg,data:{isSuccess:!o,error:o&&null!=(h=T.notebookDone.additionalErrorMessage)?h:void 0,isReplayingMessagesAfterReconnect:r}}),n({type:"stopRunningNotebookHeartbeat",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles})}else T.cellStatus?eq(e,{type:"NOTEBOOK_CELL_STATUS",cellStatus:T.cellStatus},n):T.sessionSettings&&eq(e,{type:"NOTEBOOK_SESSION_SETTINGS_UPDATED",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,sessionSettings:T.sessionSettings},n)},RECEIVE_CONTROL_MESSAGE:(e,t,n)=>{var o,r,i,a,l,s,c,u,d,f,E,p,b,y,g,S,O;let{message:h,updatePackageTimeoutId:_,isNotebookRestartKernelEnabled:I}=t,T=e.notebookState,v=m.flags._DP_UI_NOTEBOOK_PACKAGE_UPDATE_ALERT(),R=t=>{(0,eU.h)(0===t.level),e.bottomBarState={type:"ReceivedStreamlitLifecycleMsg",data:{level:0,topic:t.topic,payload:t.payload}}};switch(h.type){case"lifecycleMsg":{let i=(0,eU.h)(h.lifecycleMsg);switch(i.level){case 0:switch(i.topic){case 2:{let t=i.payload?JSON.parse(i.payload):void 0;(null==t?void 0:t.serviceStatus)==="RUNNING"&&(e.serviceStatusInfo=t),R(i);break}case 3:case 4:I&&e.udfConnectionStatus===ey.Q.RestartingKernel&&(e.notebookState=T.clearAllExecutionStates(),e.runStatus="notStarted"),R(i);break;case 5:I&&e.udfConnectionStatus===ey.Q.RestartingKernel&&(e.udfConnectionStatus=ey.Q.Connected,n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"success",content:eF(),autoDismiss:!0}}),n({type:"logNotebookKernelRestartEnd",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles})),R(i);break;case 1:case 8:R(i)}break;case 1:{let a=7===i.topic&&(null==(o=i.payload)?void 0:o.startsWith("UNAVAILABLE")),l=null==(r=(0,ex.xe)(i,ej.M.NOTEBOOK))?void 0:r(),s=`${i.topic}. ${i.payload}`;e.udfConnectionStatus===ey.Q.Connecting?(e.udfConnectionStatus=ey.Q.NotConnected,n({type:"logNotebookSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{isSuccess:!1,error:s}})):e.udfConnectionStatus===ey.Q.Reconnecting?(e.udfConnectionStatus=ey.Q.NotConnected,e.sessionLifecycleState&&(e.sessionLifecycleState.reconnectResultInfo={error:s}),n({type:"logSessionReconnectCompleted",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{error:s}}),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles})):n(e.udfConnectionStatus===ey.Q.RestartingKernel&&I?{type:"logNotebookKernelRestartEnd",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{error:s}}:{type:"logNotebookSessionErrorMessage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,data:{error:s}}),n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"alert",content:l,autoDismiss:!1},notificationRefCallback:a?eB.ZN:void 0}),n({type:"onNotebookError",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,error:(null==l?void 0:l.props.id)||s,silent:!0})}}break}case"clientControlResponse":{clearTimeout(_);let o=(0,eU.h)(h.clientControlResponse);if(o.executeConfigurationUpdateResponse){let r=o.executeConfigurationUpdateResponse,u=!!(null==r||null==(i=r.resolutionErrors)?void 0:i.length);if(e.notebookSessionSettingsState.settingsCheckResponse={status:u?"error":"success",resolutionErrors:null!=(a=r.resolutionErrors)?a:void 0},u&&"UserActionOnPage"===e.notebookSessionSettingsState.settingsUpdateSource)n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"alert",content:(0,ex.XJ)(null!=(l=r.resolutionErrors)?l:void 0),autoDismiss:!1}});else if(!u){let o=e.notebookSessionSettingsState.settings,i=eV(eG({},o),{runtimeName:o.runtimeName||r.runtime||"SYSTEM$WAREHOUSE_RUNTIME",runtimeEnvironmentVersion:o.runtimeEnvironmentVersion||void 0,queryWarehouse:o.queryWarehouse||r.queryWarehouse||void 0,codeWarehouse:o.codeWarehouse||r.codeWarehouse||void 0,computePool:o.computePool||r.computePool||void 0,externalAccessIntegrations:o.externalAccessIntegrations||r.externalIntegrations||void 0,role:o.role||(null==(s=r.roleSelection)?void 0:s.primaryRole)||void 0,secondaryRoles:null!=(c=o.secondaryRoles)?c:r.roleSelection?L(r.roleSelection):""});(i.queryWarehouse!==o.queryWarehouse||i.role!==o.role||i.secondaryRoles!==o.secondaryRoles||i.runtimeName!==o.runtimeName||i.computePool!==o.computePool||i.codeWarehouse!==o.codeWarehouse||i.externalAccessIntegrations!==o.externalAccessIntegrations||i.runtimeEnvironmentVersion!==o.runtimeEnvironmentVersion)&&(e.notebookSessionSettingsState.settings=i,e.notebookSessionSettingsState.settingsUpdateSource="ExecutionConfigurationsResponse",e.notebookSessionSettingsState.settingsUpdateTime=Date.now(),e.notebookSessionSettingsState.settingsCheckResponse={status:"success"},n({type:"saveNotebookSessionSettings",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,sessionSettings:i}))}}else if(o.updateSessionSettingsResponse){let r=o.updateSessionSettingsResponse;(null==r||null==(u=r.error)?void 0:u.length)&&"UserActionOnPage"===e.notebookSessionSettingsState.settingsUpdateSource&&n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"alert",content:(0,ex.C$)(null!=(d=r.error)?d:void 0),autoDismiss:!1}})}else if(o.getSessionSettingsResponse){let r=o.getSessionSettingsResponse.sessionSettings;if(!r)return;let i=e.notebookSessionSettingsState.settings,a=eV(eG({},i),{queryWarehouse:r.queryWarehouse||i.queryWarehouse,role:(null==(f=r.role)?void 0:f.primaryRole)||i.role,secondaryRoles:(null==(E=r.role)?void 0:E.allSelected)?A.Bq:(null==(p=r.role)?void 0:p.noneSelected)?A.sM:i.secondaryRoles});(a.queryWarehouse!==i.queryWarehouse||a.role!==i.role||a.secondaryRoles!==i.secondaryRoles)&&(e.notebookSessionSettingsState.settings=a,e.notebookSessionSettingsState.settingsUpdateSource="RuntimeCodes",e.notebookSessionSettingsState.settingsUpdateTime=Date.now(),e.notebookSessionSettingsState.settingsCheckResponse={status:"success"},n({type:"saveNotebookSessionSettings",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,sessionSettings:a}))}else if(v&&o.updateCondaEnvironment&&1===o.updateCondaEnvironment.environmentStatus){let e=o.updateCondaEnvironment.packageUpdates;(null==e?void 0:e.length)&&e.length>0&&(n({type:"openPackageUpdateAlert",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles}),n({type:"logNotebookPackageUpdateAlertTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles}))}else{let r=1===o.status||(null==(b=o.error)?void 0:b.errorMessage);e.runStatus=r?"updatingPackagesFailed":"idle",r||n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"success",content:(0,ex.Oz)(),autoDismiss:!0}})}break}case"notebookUserChannelStarted":{let o=(null==(y=t.message.notebookUserChannelStarted)?void 0:y.whReconnectMode)?({0:"FAST",1:"NEW_JOB"})[null==(g=t.message.notebookUserChannelStarted)?void 0:g.whReconnectMode]:void 0,r=(null==(S=t.message.notebookUserChannelStarted)?void 0:S.whReconnectInstance)?({0:"CONTROL",1:"USER"})[null==(O=t.message.notebookUserChannelStarted)?void 0:O.whReconnectInstance]:void 0;e.sessionLifecycleState&&(e.sessionLifecycleState.userChannelStartedInfo=eV(eG({},t.message.notebookUserChannelStarted),{whReconnectMode:o,whReconnectInstance:r})),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles})}}},RUN_NOTEBOOK:ek,CLEAR_CODE_RESULTS:(e,t,n)=>{var o,r;ek(e,(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},t),r=r={type:"RUN_NOTEBOOK",cellRunType:1,runCellId:"",clearCodeResults:!0,userTriggered:!0},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))}),o),n)},RUN_NOTEBOOK_FAILED:e=>{e.runStatus="idle"},CANCEL_EXECUTION:function(e,t,n){let{id:o,role:r,secondaryRoles:i}=t;"running"===e.runStatus&&(e.runStatus="cancelling",n({type:"cancelExecution",id:o,role:r,secondaryRoles:i}))},SHUTDOWN_NOTEBOOK:(e,t,n)=>{let{id:o,role:r,secondaryRoles:i,isContainerRuntime:a}=t;n({type:"shutdownNotebook",id:o,role:r,secondaryRoles:i,isContainerRuntime:a})},START_NOTEBOOK:(e,t,n)=>{var o;if("loaded"!==e.loadStatus)return;let r=E.Z();e.sessionLifecycleState=eJ(eZ({},null!=(o=e.sessionLifecycleState)?o:{}),{sessionStartId:r,isReplayingMessagesAfterReconnect:t.isReplayingMessagesAfterReconnect}),ek(e,eJ(eZ({},t),{type:"RUN_NOTEBOOK",cellRunType:7,runCellId:"",userTriggered:t.userTriggered}),n)},RECONNECT_NOTEBOOK:function(e,t,n){let{id:o,role:r,secondaryRoles:i}=t;n({type:"reconnectSession",id:o,role:r,secondaryRoles:i})},RESTART_NOTEBOOK:function(e,t,n){let{id:o,role:r,secondaryRoles:i,isContainerRuntime:a}=t;n({type:"restartNotebook",id:o,role:r,secondaryRoles:i,isContainerRuntime:a})},RESTART_KERNEL:function(e,t,n){let{id:o,role:r,secondaryRoles:i}=t;e.udfConnectionStatus=ey.Q.RestartingKernel,n({type:"restartNotebookKernel",id:o,role:r,secondaryRoles:i})},CLEAR_DISCONNECT_REASON:function(e){let t=e.sessionLifecycleState;t&&(t.sessionEndReason=void 0)},UPDATE_NOTEBOOK_SESSION_SETTINGS:(e,t,n)=>{let{id:o,role:r,secondaryRoles:i,sessionSettings:a,updatedBy:l}=t,s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},e.notebookSessionSettingsState.settings,a);e.notebookSessionSettingsState.settings=s,e.notebookSessionSettingsState.settingsUpdateSource=l,e.notebookSessionSettingsState.settingsUpdateTime=Date.now(),e.notebookSessionSettingsState.settingsCheckResponse=void 0,"Initialization"!==l&&n({type:"saveNotebookSessionSettings",id:o,role:r,secondaryRoles:i,sessionSettings:s})},SET_EXECUTION_CONFIGURATIONS:(e,t,n)=>{let{id:o,role:r,secondaryRoles:i,executionConfigurations:a}=t;n({type:"updateExecuteConfiguration",id:o,role:r,secondaryRoles:i,executionConfiguration:a})},WEBSOCKET_UNMOUNTED:function(e){let t=e.notebookState;t&&(e.runStatus="notStarted",e.cacheStatus="notLoaded",e.notebookState=t.clearAllResults(),e.sessionLifecycleState={})},WEBSOCKET_START_CONNECTING:function(e,t){let{numOfActiveSessions:n}=t;if(e.websocketStatus.status=n?ey.Q.Reconnecting:ey.Q.Connecting,void 0!==n){var o,r,i;n&&(e.udfConnectionStatus=ey.Q.Reconnecting),r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},null!=(o=e.sessionLifecycleState)?o:{}),i=i={numberOfRunningSessions:n},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))}),e.sessionLifecycleState=r}},WEBSOCKET_CONNECTED:function(e,t){console.log("Websocket connected"),e.websocketStatus.status=ey.Q.Connected,e.websocketStatus.idOfAlreadyRunningInstance=t.idOfAlreadyRunningInstance,e.websocketStatus.error=null,e.websocketStatus.streamlitVersionOfAlreadyRunningInstance=t.streamlitVersionOfAlreadyRunningInstance},WEBSOCKET_DISCONNECTED:function(e,t,n){var o,r,i;let{id:a,role:l,secondaryRoles:s,reason:c}=t;console.log("Websocket disconnected due to reason:",c);let u=e.notebookState;u&&(t.reason&&"string"==typeof t.reason&&(e.sessionLifecycleState=e1(e0({},null!=(r=e.sessionLifecycleState)?r:{}),{sessionEndReason:t.reason})),e.sessionLifecycleState&&(e.sessionLifecycleState=e1(e0({},e.sessionLifecycleState),{reconnectResultInfo:void 0,userChannelStartedInfo:void 0})),!(0,eX.vi)({udfConnectionStatus:e.udfConnectionStatus,disconnectReason:c})||(null==e||null==(o=e.sessionLifecycleState)?void 0:o.isNonInteractiveSession)?(e.websocketStatus.status=ey.Q.NotConnected,e.runStatus="updatingPackages"===e.runStatus?"updatingPackagesFailed":"idle",e.notebookState=u.clearAllExecutionStates(),e.udfConnectionStatus=ey.Q.NotConnected,e.bottomBarState=void 0,e.sessionLifecycleState=e1(e0({},null!=(i=e.sessionLifecycleState)?i:{}),{sessionEndTimeMs:Date.now()}),(0,eX.ne)(c)&&"loaded"!==e.cacheStatus&&(console.debug("[Notebook] Reconnect websocket to load cache results after reconnecting existing session failed"),e.cacheStatus="notLoaded",n({type:"connectWebsocket",id:a,role:l,secondaryRoles:s,connectExistingSession:!1,loadCachedResultsAfterConnection:!0})),c===ey.w.USER_NOTEBOOK_SHUTDOWN&&(e.runStatus="notStarted")):(e.websocketStatus.status=ey.Q.Reconnecting,e.udfConnectionStatus=ey.Q.Reconnecting,n({type:"reconnectSession",id:a,role:l,secondaryRoles:s})))},WEBSOCKET_CONNECTION_ERROR:function(e,t,n){let{id:o,role:r,secondaryRoles:i}=t;e.udfConnectionStatus=ey.Q.NotConnected,e.websocketStatus.status=ey.Q.NotConnected,e.websocketStatus.idOfAlreadyRunningInstance=void 0,e.websocketStatus.error=t.error,e.bottomBarState=void 0,e.runStatus="updatingPackages"===e.runStatus?"updatingPackagesFailed":"notStarted"===e.runStatus?"notStarted":"idle";let a=e.sessionLifecycleState;a&&(a.sessionEndTimeMs=Date.now()),n({type:"onNotebookError",id:o,role:r,secondaryRoles:i,error:"Unable to establish web socket connection after max attempts"===t.error?"Unable to connect.":"Unable to connect. A firewall or ad blocker might be preventing you from connecting."})},NETWORK_CONDITION_CHANGED:function(e,t,n){var o,r,i;let{id:a,role:l,secondaryRoles:s,onlineToSnowflakeServer:c}=t,u=null!=(o=e.sessionLifecycleState)?o:{},d=void 0===u.onlineToSnowflakeServer||u.onlineToSnowflakeServer,f=void 0!==c?c:d;r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},u),i=i={onlineToSnowflakeServer:f},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))}),e.sessionLifecycleState=r,f===d&&f||(console.debug("User's network condition changed.",{onlineToSnowflakeServer:f}),n({type:"networkConditionChanged",id:a,role:l,secondaryRoles:s,onlineToSnowflakeServer:f}))},UPDATE_PACKAGE:(e,t,n)=>{let{id:o,role:r,secondaryRoles:i,isContainerRuntime:a}=t;if(e.udfConnectionStatus!==ey.Q.Connected)return void console.warn(`UPDATE_PACKAGE is only applicable when UDF Connection Status is connected but got ${e.udfConnectionStatus}`);e.runStatus="updatingPackages",n(a?{type:"updatePackage",isContainerRuntime:a,imports:t.imports,id:o,role:r,secondaryRoles:i}:{type:"updatePackage",data:t.data,isContainerRuntime:a,id:o,role:r,secondaryRoles:i})},UPDATE_PACKAGE_FAILED:e=>{"updatingPackages"===e.runStatus&&(e.runStatus="updatingPackagesFailed")},UPDATE_PACKAGE_DONE:e=>{"updatingPackages"===e.runStatus&&(e.runStatus="idle")},START_FETCHING_CACHED_RESULTS:function(e,t,n){var o;let{id:r,role:i,secondaryRoles:a}=t;(0,_.OY)(eb.bZ,(0,p.m)(r)),null==(o=e.notebookState)||o.getCellsProto().forEach(e=>{var t;(0,_.OY)(eb.QX,null!=(t=e.id)?t:"")}),n({type:"fetchCachedResults",id:r,role:i,secondaryRoles:a})},START_FETCHING_CACHE_RESULT:function(e,t){let{cacheLoadId:n}=t;e.cacheStatus="pending",e.cacheLoadId=n},FETCHING_CACHE_TIMED_OUT:function(e,t,n){let{id:o,role:r,secondaryRoles:i,cacheLoadId:a}=t;a===e.cacheLoadId&&(0,eI.P)(e.cacheStatus)&&(e.cacheStatus="error",n({type:"onNotebookError",id:o,role:r,secondaryRoles:i,error:"Some cell results could not be loaded.",silent:!0}))},SET_NON_INTERACTIVE_MODE:function(e){var t,n,o;n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},null!=(t=e.sessionLifecycleState)?t:{}),o=o={isNonInteractiveSession:!0},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),e.sessionLifecycleState=n},RESET_STATE:function(e){var t;let n=e9({notebookViewId:null==(t=e.sessionLifecycleState)?void 0:t.notebookViewId,notebookUrlInfo:e.notebookUrlInfo});Object.assign(e,{},n)},REPLACE_STATE:function(e,t){Object.assign(e,{},t.state)}},eh.j),e3=(e,t,n)=>(o,r,i)=>{i(()=>(function(e,t){for(let n of t)try{n(e)}catch(e){a.cM.error(e,{message:"An error occurred in the notebook event listener"})}})(r,e));let l=(0,eO.ZP)(o,e=>{let{type:t,id:n,role:o,secondaryRoles:a}=r,l=(0,eS.E)(n,o,a);if(e[l]||(e[l]=e9({})),e_(r)){var s,c,u;e[l].sessionLifecycleState=(c=e4({},null!=(s=e[l].sessionLifecycleState)?s:{}),u=u={latestUserInteractionTime:Date.now()},Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(u)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(u)).forEach(function(e){Object.defineProperty(c,e,Object.getOwnPropertyDescriptor(u,e))}),c),i({type:"triggerUserInteractionKeepalive",id:n,role:o,secondaryRoles:a})}let d=e2[t];void 0!==d&&d(e[l],r,i)});if(n&&t){let{id:e,role:t,secondaryRoles:n}=r;i({type:"syncNotebookEditorState",notebookEditorState:l[(0,eS.E)(e,t,n)],id:e,role:t,secondaryRoles:n})}return l};var e7=n(64472),e5=n(601401);function e6(e,t){let n=(0,e5.mk)(),o=t.urlId,r=n.get(o)||{};r[t.cellId]=t.resultHeight,n.delete(o),n.set(o,r),n.size>=e5.Dz&&(n=new Map(Array.from(n.entries()).slice(-e5.Dz))),localStorage.setItem(e5.Y7,JSON.stringify(Array.from(n.entries())))}var e8=n(51723);function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function tt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let tn=({websocketMapRef:e})=>{let{logEvent:t}=(0,e8.useTelemetry)(),n=(0,ee.N)(),o=(0,r.z)((t,o)=>{var r,i;let{id:a,event:l,data:s={},role:c,secondaryRoles:u}=o,d=(0,eS.E)(a,c,u),f=e.current[d],E=t[d];n.logCellUITelemetry(a,l,tt(te({},s),{connectionId:null!=(i=null==f?void 0:f.connectionId)?i:"",notebookViewId:null==E||null==(r=E.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==E?void 0:E.notebookRuntime}),{event:eb.Xv,markers:[`${s.cellIndex}`]})}),i=(0,r.z)((t,o)=>{var r,i;let{id:a,event:l,data:s,role:c,secondaryRoles:u,markerInfo:d}=o,f=(0,eS.E)(a,c,u),E=e.current[f],p=t[f];n.logCellRunTelemetry(a,l,tt(te({},s),{connectionId:null!=(i=null==E?void 0:E.connectionId)?i:"",notebookViewId:null==p||null==(r=p.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==p?void 0:p.notebookRuntime}),s.isSuccess,d)}),a=(0,r.z)((t,o)=>{var r,i,a;let{id:l,event:s,data:c,role:u,secondaryRoles:d}=o,f=(0,eS.E)(l,u,d),E=e.current[f],b=t[f];n.logRunEvent(l,s,tt(te({},c),{connectionId:null!=(a=null==E?void 0:E.connectionId)?a:"",notebookViewId:null==b||null==(r=b.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==b?void 0:b.notebookRuntime,isReplayingMessage:!!(s===eT.MKg&&c&&c.isReplayingMessagesAfterReconnect),reconnectInstanceId:null==b||null==(i=b.websocketStatus)?void 0:i.idOfAlreadyRunningInstance}),c?c.isSuccess:void 0,{event:eb.bZ,markers:[(0,p.m)(l)],isUserE2E:!0})}),l=(0,r.z)((t,o)=>{var r,i;let{id:a,event:l,eventType:s,role:c,secondaryRoles:u,data:d={}}=o,f=(0,eS.E)(a,c,u),E=e.current[f],b=t[f];n.logIPYNBEvent(a,l,tt(te({},d),{connectionId:null!=(i=null==E?void 0:E.connectionId)?i:"",notebookViewId:null==b||null==(r=b.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==b?void 0:b.notebookRuntime}),s,{event:eb.sW,markers:[(0,p.m)(a)]})}),s=(0,r.z)((t,o)=>{var r,i;let{id:a,role:l,secondaryRoles:s}=o,c=(0,eS.E)(a,l,s),u=e.current[c],d=t[c];n.logSessionStarting(a,{connectionId:null==u?void 0:u.connectionId,sessionStartId:null==d||null==(r=d.sessionLifecycleState)?void 0:r.sessionStartId,notebookViewId:null==d||null==(i=d.sessionLifecycleState)?void 0:i.notebookViewId,notebookRuntime:null==d?void 0:d.notebookRuntime})}),c=(0,r.z)((t,o)=>{var r,i;let{id:a,role:l,secondaryRoles:s,data:c}=o,u=(0,eS.E)(a,l,s),d=e.current[u],f=t[u],E={connectionId:null==d?void 0:d.connectionId,notebookRuntime:null==f?void 0:f.notebookRuntime,sessionStartId:null==f||null==(r=f.sessionLifecycleState)?void 0:r.sessionStartId,notebookViewId:null==f||null==(i=f.sessionLifecycleState)?void 0:i.notebookViewId};c.isSuccess?n.logSessionStartSuccess(a,E):n.logSessionStartFailed(a,tt(te({},E),{error:c.error}))}),d=(0,r.z)((t,o)=>{var r,i;let{id:a,role:l,secondaryRoles:s,data:c}=o,u=(0,eS.E)(a,l,s),d=e.current[u],f=t[u];n.logSessionErrorMessage(a,{connectionId:null==d?void 0:d.connectionId,sessionStartId:null==f||null==(r=f.sessionLifecycleState)?void 0:r.sessionStartId,notebookViewId:null==f||null==(i=f.sessionLifecycleState)?void 0:i.notebookViewId,notebookRuntime:null==f?void 0:f.notebookRuntime,error:c.error})}),f=(0,r.z)((t,o)=>{var r,i;let{id:a,role:l,secondaryRoles:s,data:c}=o,u=(0,eS.E)(a,l,s),d=e.current[u],f=t[u];n.logSessionReconnectCompleted(a,{connectionId:null==d?void 0:d.connectionId,notebookViewId:null==f||null==(r=f.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==f?void 0:f.notebookRuntime,error:c.error,reconnectInstanceId:null==f||null==(i=f.websocketStatus)?void 0:i.idOfAlreadyRunningInstance})}),E=(0,r.z)((t,o)=>{var r,i,a,l;let{id:s,role:c,secondaryRoles:u}=o,d=(0,eS.E)(s,c,u),f=t[d],E=e.current[d],p=null==(r=f.sessionLifecycleState)?void 0:r.reconnectResultInfo,b=null==(i=f.sessionLifecycleState)?void 0:i.userChannelStartedInfo;p&&b&&n.logSessionReconnectDetails(s,te({connectionId:null==E?void 0:E.connectionId,notebookViewId:null==f||null==(a=f.sessionLifecycleState)?void 0:a.notebookViewId,notebookRuntime:null==f?void 0:f.notebookRuntime,reconnectInstanceId:null==f||null==(l=f.websocketStatus)?void 0:l.idOfAlreadyRunningInstance},p,b))}),b=(0,r.z)((e,n)=>{var o;let{id:r,role:i,secondaryRoles:a,event:l,eventType:s,data:c={}}=n,u=e[(0,eS.E)(r,i,a)];t({data:tt(te({notebookIdentifier:(0,p.m)(r)},c),{notebookViewId:null==u||null==(o=u.sessionLifecycleState)?void 0:o.notebookViewId}),event:l,type:s})}),y=(0,r.z)((e,t)=>{var o;let{id:r,event:i,eventType:a,role:l,secondaryRoles:s,error:c,data:u={}}=t,d=e[(0,eS.E)(r,l,s)];n.logNotebookEditEvent(r,i,tt(te({},u),{notebookViewId:null==d||null==(o=d.sessionLifecycleState)?void 0:o.notebookViewId,notebookRuntime:null==d?void 0:d.notebookRuntime,error:c}),a,{event:eb.gr,markers:[(0,p.m)(r)]})}),g=(0,r.z)((t,o)=>{var r;let{id:i,role:a,secondaryRoles:l,data:s}=o,c=(0,eS.E)(i,a,l),u=e.current[c],d=t[c];n.logKernelRestartEnd(i,{connectionId:null==u?void 0:u.connectionId,notebookViewId:null==d||null==(r=d.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==d?void 0:d.notebookRuntime,error:null==s?void 0:s.error})}),S=(0,r.z)((t,o)=>{var r;let{id:i,role:a,secondaryRoles:l}=o,s=(0,eS.E)(i,a,l),c=e.current[s],u=t[s];n.logNotebookPackageUpdateAlert(i,{connectionId:null==c?void 0:c.connectionId,notebookViewId:null==u||null==(r=u.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==u?void 0:u.notebookRuntime})});return(0,u.useMemo)(()=>({logNotebookTelemetry:b,logNotebookIPYNBTelemetry:l,logNotebookCellUITelemetry:o,logNotebookCellRunTelemetry:i,logNotebookRunTelemetry:a,logNotebookStartingSessionTelemetry:s,logNotebookSessionTelemetry:c,logNotebookSessionErrorMessage:d,logSessionReconnectCompleted:f,logSessionReconnectDetails:E,logNotebookKernelRestartEnd:g,logNotebookEditTelemetry:y,logNotebookPackageUpdateAlertTelemetry:S}),[b,l,o,i,a,c,d,s,f,E,g,y,S])};var to=n(920597);async function tr({isParallelFetchEnabled:e,urlInfo:t,notebookEditorState:o,getNotebookUrlInfo:r,getWebsocketProtoParams:i}){if(t&&!e){let{ConnectionManager:e}=await Promise.all([n.e("94641"),n.e("70434"),n.e("95918"),n.e("63153"),n.e("73213")]).then(n.bind(n,767739));return{ConnectionManager:e,webSocketProtoParams:await i(),urlInfo:t}}let[{ConnectionManager:a},l,s]=await Promise.all([Promise.all([n.e("94641"),n.e("70434"),n.e("95918"),n.e("63153"),n.e("73213")]).then(n.bind(n,767739)),i(),(null==o?void 0:o.notebookUrlInfo)?Promise.resolve(o.notebookUrlInfo):r()]);return{ConnectionManager:a,webSocketProtoParams:l,urlInfo:s}}var ti=n(569016);function ta(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function tl(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let[ts,tc]=(0,l.Z)(()=>(function(){let{formatMessage:e}=(0,d.Z)(),t=(0,O.U)(),{openDialog:n,hideDialog:l}=(0,U.E)(),{triggerDialog:s}=(0,N.b)(),A=(0,ee.N)(),{user:L}=(0,y.m)(["user"]),k=L.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_NOTEBOOK_LARGE_MESSAGE_CACHE"),P=m.flags.FEATURE_UI_ENABLE_NOTEBOOKS_SCHEDULING(),D=m.flags.NOTEBOOK_ENABLE_IDLE_HEARTBEAT(),F=m.flags.NOTEBOOK_IDLE_HEARTBEAT_TIMEOUT_SECONDS(),B=m.flags.NOTEBOOK_CACHE_FETCHING_TIMEOUT_SECONDS(),G=m.flags.UI_ENABLE_NOTEBOOK_FEATURE_1(),K=L.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_NOTEBOOK_FEATURE_21"),W=L.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_NOTEBOOK_FEATURE_22"),H=(0,x.w)(),$=void 0!==window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN,Q=(0,T.J)(),Y=m.flags.NOTEBOOK_UPDATE_PACKAGE_TIMEOUT_SECONDS()||300,z=L.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_NOTEBOOK_JUPYTER_VARIABLE_SEMANTICS"),q=L.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_NOTEBOOK_FEATURE_25"),Z=L.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_NOTEBOOK_FEATURE_30"),J=m.flags.UI_ENABLE_NOTEBOOK_FEATURE_40(),ed=(0,u.useRef)({}),ef=m.flags.UI_ENABLE_NOTEBOOK_FEATURE_29(),eO=m.flags.STREAMLIT_WEBSOCKET_IDLE_TIMEOUT(),eh=m.flags.UI_ENABLE_NOTEBOOK_FEATURE_45()||H,em=(0,u.useRef)(null),{organization:e_}=(0,y.m)(["organization"]),{region:eI,org:eT}=e_.currentRegionAndOrgInfoFromOrganization,{readFromStage:ev,writeToStage:eR}=X(),eC=(0,V.U)(ec.k,eu)(),eN=(0,u.useCallback)((e,t,n)=>void ev(t,n),[ev]),eA=(0,u.useCallback)((e,t,n)=>{let{id:o}=t;A.markEventStart(eb.gr,(0,p.m)(o)),eR(t,n)},[eR,A]),ew=(0,u.useMemo)(()=>c()(eA,3e3,{trailing:!0}),[eA]),eL=(0,g.d)(),ek=(0,V.U)(et.l,en)(),eP=(0,V.U)(eo.M,er)(),eD=(0,V.U)(el.W,es)(),eM=(0,V.U)(ei.P,ea)(),eU=(0,r.z)(async({id:e,role:t,secondaryRoles:n,urlInfo:o,queryId:r,connectExistingSession:i=!0,loadCachedResultsAfterConnection:a=!1})=>{var l,s,c;let u=(0,eS.E)(e,t,n),d=ed.current;(null==(l=d[u])?void 0:l.connection.isConnected())&&(null==(c=d[u])||c.connection.disconnect("NOTEBOOK_RECONNECT"));let f=E.Z(),b=tC[u],y=null==b?void 0:b.notebookRuntime,g=!!r,O=i&&!g,{ConnectionManager:m,webSocketProtoParams:_,urlInfo:T}=await tr({isParallelFetchEnabled:(0,ti.q)(L),urlInfo:o,notebookEditorState:b,getNotebookUrlInfo:()=>eD({id:e,role:t,secondaryRoles:n,isPrivatelink:eL(),isNotebookPrivateLinkEnabled:!!ef}),getWebsocketProtoParams:()=>O?ek(e):Promise.resolve({additionalProtoParams:[],activeInstanceJobId:null,activeNotebookInstancesNum:void 0,additionalMetadata:void 0})});(null==b?void 0:b.notebookUrlInfo)||tN({type:"SET_NOTEBOOK_URL_INFO",id:e,role:t,secondaryRoles:n,urlInfo:T});let{additionalProtoParams:v,activeInstanceJobId:R,activeNotebookInstancesNum:C,additionalMetadata:N}=_,w=[(0,p.m)(e),f];A.markEventStart(eb.x5,...w),A.markEventStart(eb.wT,f||"UNKNOWN"),C&&A.markEventStart(eb.Ff,(0,p.m)(e),f),A.logWebsocketStartConnecting(e,{connectionId:f,notebookViewId:null==b||null==(s=b.sessionLifecycleState)?void 0:s.notebookViewId,notebookRuntime:y,isReconnect:!!C,reconnectInstanceId:null!=R?R:void 0,skipPingEnabled:eh}),tN({type:"WEBSOCKET_START_CONNECTING",id:e,role:t,secondaryRoles:n,numOfActiveSessions:C});let D=!!(C&&b&&"notStarted"!==b.runStatus&&!g),M=[],U=e=>{M.includes(e)||M.push(e)},j=e=>{let t=M.indexOf(e);t>=0&&M.splice(t,1)},x=e=>{let t=!0;for(let n of M)if(!(t=n.onMessage(e)))break;return t},F=e=>{let t=!0;for(let n of M)if(!(t=n.onSendMessage(e)))break;return t},B=e=>{let t=!0;for(let n of M)if(!(t=n.onControlMessage(e)))break;return t},G=(e,t,n)=>{let o=[];for(let r of M)r.onConnectionChange(e,t,n)||o.push(r);for(let e of o)j(e)},V=Date.now();return new Promise((o,i)=>{d[u]={registerHandler:U,unregisterHandler:j,sendMessage:e=>{if(F(e)){var t;null==(t=d[u])||t.connection.sendMessage(e)}},connection:new m({connectionId:f,additionalProtocolParams:v,skipPingEnabled:eh,onMessage:o=>{var r;f===(null==(r=d[u])?void 0:r.connectionId)&&(Q?x(o)&&tN({type:"RECEIVE_MESSAGE",id:e,role:t,secondaryRoles:n,message:o}):tN({type:"RECEIVE_MESSAGE",id:e,role:t,secondaryRoles:n,message:o}))},onControlMessage:o=>{var r,i;f===(null==(r=d[u])?void 0:r.connectionId)&&(Q?B(o)&&tN({type:"RECEIVE_CONTROL_MESSAGE",id:e,role:t,secondaryRoles:n,message:o,isNotebookRestartKernelEnabled:Z,updatePackageTimeoutId:tf.current}):tN({type:"RECEIVE_CONTROL_MESSAGE",id:e,role:t,secondaryRoles:n,message:o,isNotebookRestartKernelEnabled:Z,updatePackageTimeoutId:tf.current}),A.logWebsocketControlMessage(e,{connectionId:f,notebookViewId:null==b||null==(i=b.sessionLifecycleState)?void 0:i.notebookViewId,notebookRuntime:y,messageJson:o.toJSON()}))},onConnectionError:o=>{var r,a;if(f!==(null==(r=d[u])?void 0:r.connectionId))return;let l="string"==typeof o?o:"Unknown error";A.logWebsocketConnectError(e,{connectionId:f,notebookViewId:null==b||null==(a=b.sessionLifecycleState)?void 0:a.notebookViewId,notebookRuntime:y,error:l,isReconnect:!!C,reconnectInstanceId:null!=R?R:void 0},{event:eb.x5,markers:w}),tN({type:"WEBSOCKET_CONNECTION_ERROR",id:e,role:t,secondaryRoles:n,error:l}),i()},connectionStateChanged:(r,l,s)=>{var c,E,p,g,S,O,m;if(f===(null==(c=d[u])?void 0:c.connectionId))switch(G(r,l,s),r){case I.e.CONNECTED:tN({type:"WEBSOCKET_CONNECTED",id:e,role:t,secondaryRoles:n,idOfAlreadyRunningInstance:null!=R?R:void 0,streamlitVersionOfAlreadyRunningInstance:null==N?void 0:N.streamlitVersionOfAlreadyRunningInstance}),D&&tN({type:"START_NOTEBOOK",id:e,role:t,secondaryRoles:n,userTriggered:!1,isReplayingMessagesAfterReconnect:!0}),a&&tN({type:"START_FETCHING_CACHED_RESULTS",id:e,role:t,secondaryRoles:n}),A.logWebsocketConnected(e,{connectionId:f,notebookViewId:null==b||null==(E=b.sessionLifecycleState)?void 0:E.notebookViewId,notebookRuntime:y,connectionState:"CONNECTED",reason:s,error:l,isReconnect:!!C,reconnectInstanceId:null!=R?R:void 0},{event:eb.x5,markers:w}),h.v.addDurationVital(eb.P7,{startTime:V,duration:Date.now()-V,context:{isReconnect:!!C,reconnectInstanceId:null!=R?R:void 0,skipPingEnabled:eh}}),o();break;case I.e.DISCONNECTED_FOREVER:tN({type:"WEBSOCKET_DISCONNECTED",id:e,role:t,secondaryRoles:n,reason:s}),null==(p=e4.current)||p.stop(),e4.current=null,W&&eJ(-1),A.logWebsocketDisconnected(e,{connectionId:f,notebookViewId:null==b||null==(g=b.sessionLifecycleState)?void 0:g.notebookViewId,notebookRuntime:y,connectionState:r,reason:s,error:l,isReconnect:!!C,reconnectInstanceId:null!=R?R:void 0},{event:eb.x5,markers:w}),s===ey.w.NOTEBOOK_IDLE_TIMEOUT&&A.logSessionEnd(e,{connectionId:f,notebookViewId:null==b||null==(S=b.sessionLifecycleState)?void 0:S.notebookViewId,sessionStartId:null==b||null==(O=b.sessionLifecycleState)?void 0:O.sessionStartId,notebookRuntime:y,connectionState:r,reason:s,error:l,isReconnectEnabled:!0}),i();break;default:A.logWebsocketConnectionStateChange(e,{connectionId:f,notebookViewId:null==b||null==(m=b.sessionLifecycleState)?void 0:m.notebookViewId,notebookRuntime:y,connectionState:r,reason:s,error:l,isReconnect:!!C,reconnectInstanceId:null!=R?R:void 0})}},claimHostAuthToken:async()=>await eM({id:e,role:t,secondaryRoles:n,queryId:r,isHistoryQueryResultEnabled:P}),resetHostAuthToken:S.EI,setAllowedOriginsResp:S.EI,baseUriParts:T.baseUriParts,isHttps:T.isHttps,isLargeMessageCacheEnabled:k,createWebSocket:(e,t)=>H&&$?new ep.LU(e,t):new WebSocket(e,t)}),urlInfo:T,connectionId:f}})}),ej=(0,r.z)((e,t,n,o)=>{var r;let i=(0,eS.E)(e,t,n),a=null==(r=ed.current[i])?void 0:r.connection;a&&(null==a||a.disconnect(o),ed.current[i]=void 0)}),ex=(0,r.z)(async(t,n)=>{var o,r,a;let{id:l,role:s,secondaryRoles:c,cellRunType:u,runCellId:d,cells:f,clientState:E,eventType:b,notebookRuntime:y}=t,g=(0,eS.E)(l,s,c);(1===u||7===u)&&A.markEventStart(eb.bZ,(0,p.m)(l)),f.forEach(e=>{var t,n;A.markEventStart(eb.QX,null!=(t=e.id)?t:""),A.markE2EEventStart(eb.QX,null!=(n=e.id)?n:"")});let S=tA(l,s,c),O=ed.current[g];if(void 0===O||O.connection.isDisconnected()){try{await eU({id:l,role:s,secondaryRoles:c}),O=ed.current[g]}catch(e){}if(J&&O){let{settingsUpdateTime:e,settings:t}=null!=(o=null==S?void 0:S.notebookSessionSettingsState)?o:{};e&&t&&O.connection.sendControlMessage({clientControlRequest:{executeConfigurationUpdateRequest:{runtime:t.runtimeName,queryWarehouse:t.queryWarehouse,codeWarehouse:t.codeWarehouse,computePool:t.computePool,externalIntegrations:t.externalAccessIntegrations,roleSelection:w(t.role,t.secondaryRoles),idleShutdownSecs:t.idleAutoShutdownTimeSeconds}}})}}else try{await O.connection.waitForConnection()}catch(e){}if(void 0!==O&&O.connection.isConnected()){let e={cellRunType:u,cellUpdateSemantics:1,cellInteractionSemantics:+!z,runCellId:d};q&&(e=tl(ta({},e),{userErrorHandlingSemantics:0})),Q?O.sendMessage({runCells:tl(ta({},e),{cells:f,clientState:E})}):O.connection.sendMessage({runCells:tl(ta({},e),{cells:f,clientState:E})}),A.logRunRequested(l,tl(ta({},e),{connectionId:O.connectionId,notebookViewId:null==S||null==(a=S.sessionLifecycleState)?void 0:a.notebookViewId,notebookRuntime:y,runId:d}),null!=b?b:"ui_click")}else(0,i.w)({content:e({id:"Connection is not ready yet"}),type:"alert",autoDismiss:!1}),A.logRunRequestedError(l,{error:"Connection is not ready yet",connectionId:(null==O?void 0:O.connectionId)||"",notebookViewId:null==S||null==(r=S.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:y,runId:d},null!=b?b:"ui_response_error"),n({type:"RUN_NOTEBOOK_FAILED",id:l,role:s,secondaryRoles:c})}),eF=(0,to.q)(ed.current,e=>{e.connection.isConnected()&&(Q?e.sendMessage({controlRequest:{cancelExecution:{cancelType:0}}}):e.connection.sendMessage({controlRequest:{cancelExecution:{cancelType:0}}}))}),eB=(0,to.q)(ed.current,e=>{G&&e.connection.isConnected()&&(Q?e.sendMessage({controlRequest:{resourceUtilization:{resourceTypes:[0,1]}}}):e.connection.sendMessage({controlRequest:{resourceUtilization:{resourceTypes:[0,1]}}}))}),eG=(0,to.q)(ed.current,(e,t,n)=>{var o,r,i;let{id:a,role:l,secondaryRoles:s}=t,c=null==(o=tA(a,l,s))?void 0:o.notebookState,u=null==c||null==(i=c.data)||null==(r=i.cells)?void 0:r.filter(e=>"markdown"!==e.cell_type).map(e=>({cellId:e.id}));if(A.markEventStart(eb.bZ,(0,p.m)(a)),null==u||u.forEach(e=>{A.markEventStart(eb.QX,e.cellId)}),e.connection.isConnected()&&u&&u.length>0){let t=E.Z();n({type:"START_FETCHING_CACHE_RESULT",id:a,role:l,secondaryRoles:s,cacheLoadId:t}),Q?e.sendMessage({previousResults:{warmStart:!1,cellIds:u}}):e.connection.sendMessage({previousResults:{warmStart:!1,cellIds:u}}),setTimeout(()=>{n({type:"FETCHING_CACHE_TIMED_OUT",id:a,role:l,secondaryRoles:s,cacheLoadId:t})},1e3*B)}}),eV=(0,u.useCallback)((e,t,n)=>{ex(t,n)},[ex]),eK=(0,u.useCallback)((t,n)=>{var o,r;n.silent||(0,i.w)({content:(r=n.error.replace(/Stack trace[\s\S]*/iu,"").trim(),Object.keys(eg._y).includes(r)?(0,eg.Ex)(r,e):e({id:"Something went wrong. {message}"},{message:r})),type:"alert",autoDismiss:!1}),(null==(o=n.logError)||o)&&(A.logError({notebookIdentifier:(0,p.m)(n.id),error:n.error}),a.cM.error(n.error))},[e,A]),eW=(0,u.useCallback)((e,t)=>{H?s({type:"externalAccessIntegrationError",fullNotebookIdentifier:t.id}):n((0,o.jsx)(C.z,{fullNotebookIdentifier:t.id,hide:l})),A.logError({notebookIdentifier:(0,p.m)(t.id),error:t.error}),a.cM.warn(t.error)},[H,A,s,n,l]),eH=(0,r.z)(e=>{n((0,o.jsx)(R.W,{urlData:{region:eI,org:eT},sourceFullNotebookIdentifier:e,hideLayer:l}))}),e$=(0,r.z)((e,t)=>{var r,i;let{id:a,role:c,secondaryRoles:u,saveEligibilityCheckStatus:d,editingUserName:f,editingUserEmail:E}=t,p=tA(a,c,u);H?s({type:"concurrentEditAlert",saveEligibilityCheckStatus:d,editingUserName:f,editingUserEmail:E,notebookViewId:null==p||null==(r=p.sessionLifecycleState)?void 0:r.notebookViewId,fullNotebookIdentifier:a,role:c,region:eI,org:eT}):n((0,o.jsx)(e7.n,{hide:l,role:c,saveEligibilityCheckStatus:d,editingUserName:f,editingUserEmail:E,fullNotebookIdentifier:a,onDuplicateNotebook:eH,notebookViewId:null==p||null==(i=p.sessionLifecycleState)?void 0:i.notebookViewId}))}),eQ=(0,to.q)(ed.current,(e,t)=>{var n;if(!Z)return;e.connection.sendMessage({controlRequest:{restartKernelRequest:{restartKernel:!0}}});let{id:o,role:r,secondaryRoles:i}=t,a=tA(o,r,i);A.logKernelRestartBegin(o,{connectionId:e.connectionId,notebookViewId:null==a||null==(n=a.sessionLifecycleState)?void 0:n.notebookViewId,notebookRuntime:null==a?void 0:a.notebookRuntime})}),eY=(0,r.z)((e,t)=>{var n,o;let{id:r,role:i,secondaryRoles:a}=t,l=(0,eS.E)(r,i,a),s=ed.current[l],c=null==s?void 0:s.connection,u=(null==c?void 0:c.getConnectionId())||"UNKNOWN",d=tA(r,i,a),f=null==d||null==(n=d.sessionLifecycleState)?void 0:n.latestUserInteractionTime;if(A.logWebsocketHeartbeat(r,{connectionId:u,notebookViewId:null==d||null==(o=d.sessionLifecycleState)?void 0:o.notebookViewId,isConnected:(null==c?void 0:c.isConnected())||!1,isEnableIdleHeartbeat:D,idleHeartbeatTimeoutSeconds:F,isNotebookRunning:(null==d?void 0:d.runStatus)==="running"},{event:eb.wT,markers:[u]}),!(null==c?void 0:c.isConnected()))return!1;let E=Date.now();return Q?null==s||s.sendMessage({heartbeatRequest:{browserState:f&&E-f<=6e4?1:0}}):c.sendMessage({heartbeatRequest:{browserState:f&&E-f<=6e4?1:0}}),console.debug("[Notebook] Heartbeat sent with browser state: ",f&&E-f<=6e4?"ACTIVE":"IDLE"),!0}),ez=(0,u.useMemo)(()=>c()(eY,eO/5||6e4,{leading:!0}),[eO,eY]),eq=(0,u.useRef)(-1),eZ=(0,u.useRef)(null),eJ=(0,u.useCallback)(e=>{var t;eq.current=e,null==(t=eZ.current)||t.call(eZ,e)},[]),eX=(0,u.useCallback)(async e=>{let{id:n,role:o,secondaryRoles:r}=e,i=await t(n,o,r);return(null==i?void 0:i.idleAutoShutdownTimeSeconds)||F||eO/1e3||j.K7},[t,F,eO]),e0=(0,u.useCallback)(async e=>{let{unsetNull:t,effect:n}=e;if(null==eq.current&&!t)return;let o=await eX(n);K?eJ(new Date().getTime()+1e3*o):eJ(new Date().getTime()+Math.max(1e3*o-(eO||0),0))},[eX,K,eJ,eO]),e1=(0,r.z)((e,t)=>{D?e0({effect:t}):ez(e,t)}),e9=(0,u.useCallback)(()=>{eJ(null)},[eJ]),e4=(0,u.useRef)(null),e2=(0,r.z)((e,t)=>{var n,o,r;if(D&&(e9(),e4.current))return void e4.current.restart();let{id:i,role:a,secondaryRoles:l}=t,s=(0,eS.E)(i,a,l),c=tA(i,a,l),u=null==(n=ed.current[s])?void 0:n.connection.getConnectionId();e4.current&&(A.logWebsocketHeartbeatEnd(i,{connectionId:u,notebookViewId:null==c||null==(r=c.sessionLifecycleState)?void 0:r.notebookViewId,isEnableIdleHeartbeat:D,idleHeartbeatTimeoutSeconds:F},{event:eb.wT,markers:[u||"UNKNOWN"]}),e4.current.stop()),A.logWebsocketHeartbeatStart(i,{connectionId:u,notebookViewId:null==c||null==(o=c.sessionLifecycleState)?void 0:o.notebookViewId,isEnableIdleHeartbeat:D,idleHeartbeatTimeoutSeconds:F});let d=(0,b.zp)(()=>{let n=!0;console.debug("Running heartbeater loop ",eq.current),console.debug("Sending heartbeat"),console.debug("Received response from heartbeat: ",n=eY(e,ta({},t))),n||(K?console.debug("No heartbeat sent but continuing to keep the heartbeat active."):(console.debug("Stopping heartbeater because no heartbeat was sent ",{heartbeatPollEndTimeMs:null==eq?void 0:eq.current}),d.stop()))},{pollingIntervalInSec:60,shouldPauseOnInactive:!1});e4.current=d,d.start()}),e5=(0,u.useCallback)((e,t)=>{var n,o;let{id:r,role:i,secondaryRoles:a}=t,l=(0,eS.E)(r,i,a),s=null==(n=ed.current[l])?void 0:n.connection.getConnectionId();D?e0({unsetNull:!0,effect:t}):(A.logWebsocketHeartbeatEnd(r,{connectionId:s,isEnableIdleHeartbeat:D,idleHeartbeatTimeoutSeconds:F},{event:eb.wT,markers:[s||"UNKNOWN"]}),null==(o=e4.current)||o.stop())},[D,F,A,e0]),e8=tn({websocketMapRef:ed}),te=(0,r.z)(async e=>{var t,n,o;let{id:r,role:i,secondaryRoles:a,isContainerRuntime:l,reason:s}=e,c=(0,eS.E)(r,i,a),u=tA(r,i,a),d=null==(t=ed.current[c])?void 0:t.connection,f=(null==d?void 0:d.getConnectionId())||"";(0,_.H$)(eb.Sc,(0,p.m)(r),f),ej(r,i,a,"USER_NOTEBOOK_SHUTDOWN"),await eP({id:r,role:i,secondaryRoles:a}),A.logSessionEnd(r,{connectionId:f,notebookViewId:null==u||null==(n=u.sessionLifecycleState)?void 0:n.notebookViewId,sessionStartId:null==u||null==(o=u.sessionLifecycleState)?void 0:o.sessionStartId,reason:s,notebookRuntime:l?"spcs":"wh",isReconnectEnabled:!0})}),tt=(0,r.z)((e,t)=>{te(tl(ta({},t),{reason:"USER_NOTEBOOK_SESSION_SHUTDOWN"}))}),ts=(0,r.z)(async(e,t)=>{let{id:n,role:o,secondaryRoles:r,isContainerRuntime:i}=e;await te(tl(ta({},e),{type:"shutdownNotebook",isContainerRuntime:i,reason:"NOTEBOOK_SESSION_RESTART"})),t({id:n,role:o,secondaryRoles:r,type:"START_NOTEBOOK",userTriggered:!0,isReplayingMessagesAfterReconnect:!1})}),tc=(0,r.z)((e,t,n)=>{ts(t,n)}),tu=(0,u.useCallback)((e,t)=>{let{notificationProps:n,notificationRefCallback:o}=t;if(n.content){let e=(0,i.w)(n);null==o||o(e)}},[]),td=(0,u.useRef)(""),tf=(0,u.useRef)(),tE=(0,to.q)(ed.current,(e,t,n)=>{if(!e.connection.isConnected())return;let{id:o,role:r,secondaryRoles:i,data:a,isContainerRuntime:l,imports:s}=t;if(a&&e.connection.sendControlMessage({clientControlRequest:{updateCondaEnvironment:{packageSpec:a.dependencies}}}),l&&void 0!==s){let t=E.Z();td.current=t,Q?e.sendMessage({controlRequest:{installPackage:{importUrls:s},requestId:t}}):e.connection.sendMessage({controlRequest:{installPackage:{importUrls:s},requestId:t}})}clearTimeout(tf.current),tf.current=setTimeout(()=>{n({type:"UPDATE_PACKAGE_FAILED",id:o,role:r,secondaryRoles:i})},1e3*Y)}),tp=(0,to.q)(ed.current,(e,t,n)=>{if(!e.connection.isConnected())return;let{id:o,role:r,secondaryRoles:i,executionConfiguration:a}=t,l=tA(o,r,i);(null==l?void 0:l.udfConnectionStatus)!==ey.Q.Connected?e.connection.sendControlMessage({clientControlRequest:{executeConfigurationUpdateRequest:{runtime:a.runtimeName,queryWarehouse:a.queryWarehouse,codeWarehouse:a.codeWarehouse,computePool:a.computePool,externalIntegrations:a.externalAccessIntegrations,roleSelection:w(a.role,a.secondaryRoles),idleShutdownSecs:a.idleAutoShutdownTimeSeconds}}}):e.connection.sendControlMessage({clientControlRequest:{updateSessionSettingsRequest:{sessionSettings:{queryWarehouse:a.queryWarehouse,role:w(a.role,a.secondaryRoles),idleTimeoutSecs:a.idleAutoShutdownTimeSeconds}}}})}),tb=(0,to.q)(ed.current,(e,t,n)=>{if(!J||!e.connection.isConnected())return;let{id:o,role:r,secondaryRoles:i}=t,a=tA(o,r,i);(null==a?void 0:a.udfConnectionStatus)===ey.Q.Connected&&e.connection.sendControlMessage({clientControlRequest:{getSessionSettingsRequest:{}}})}),ty=(0,r.z)((e,t,n)=>{let{id:o,role:r,secondaryRoles:i,requestId:l,status:s}=t,c=td.current;td.current="",""!==c&&c===l&&(0===s?n({type:"UPDATE_PACKAGE_DONE",id:o,role:r,secondaryRoles:i}):1===s?n({type:"UPDATE_PACKAGE_FAILED",id:o,role:r,secondaryRoles:i}):a.cM.warn(`Unknown status response for package import update: ${s}`))}),tg=(0,u.useCallback)((e,t,n)=>{let{id:o,role:r,secondaryRoles:i,queryId:a}=t,l=(0,eS.E)(o,r,i),s=ed.current[l];(null==s?void 0:s.connection.isConnected())?n({type:"START_NOTEBOOK",id:o,role:r,secondaryRoles:i,userTriggered:!1,isReplayingMessagesAfterReconnect:!0}):eU({id:o,role:r,secondaryRoles:i,urlInfo:void 0,queryId:a})},[eU]),tS=(0,u.useCallback)((e,t,n)=>{let{id:o,role:r,secondaryRoles:i,queryId:a,connectExistingSession:l,loadCachedResultsAfterConnection:s}=t,c=(0,eS.E)(o,r,i),u=ed.current[c];(null==u?void 0:u.connection.isConnected())||eU({id:o,role:r,secondaryRoles:i,queryId:a,urlInfo:void 0,connectExistingSession:l,loadCachedResultsAfterConnection:s})},[eU]),tO=(0,r.z)((e,t)=>{let{id:n,sessionSettings:o}=t;eC({notebookId:n,sessionSettings:o})}),th=(0,u.useCallback)((t,n,o)=>{let{id:r,role:a,secondaryRoles:l,queryId:s,onlineToSnowflakeServer:c}=n,u=(0,eS.E)(r,a,l);if(c){var d;null==(d=em.current)||d.hide(),em.current=null;let e=ed.current[u];(null==e?void 0:e.connection.isConnected())||eU({id:r,role:a,secondaryRoles:l,urlInfo:null==e?void 0:e.urlInfo,queryId:s});return}em.current||(em.current=(0,i.w)({content:e({id:"Notebook connection lost. Check your internet or wifi connection."}),type:"alert",autoDismiss:!1,onDismiss:()=>{em.current=null}}),ej(r,a,l,"NETWORK_DOWN"))},[ej,e,eU]),tm=(0,u.useRef)([]),t_=(0,u.useCallback)(e=>(tm.current.push(e),function(){let t=tm.current.indexOf(e);t<0||tm.current.splice(t,1)}),[]),tI=(0,v.S)(ed.current,10*B),tT=eE(),tv=(0,r.z)((e,t)=>{tT(t.notebookEditorState)}),tR=(0,r.z)((e,t,r)=>{n((0,o.jsx)(M,{hide:l,restart:()=>r({type:"RESTART_NOTEBOOK",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,isContainerRuntime:!1})}))}),[tC,tN]=(0,f.M)(e3(tm.current,$,H),{},ta({readFromStage:eN,writeToStage:eA,writeToStageThrottled:ew,runCells:eV,onNotebookError:eK,fetchCachedResults:eG,saveResultHeight:e6,triggerUserInteractionKeepalive:e1,startRunningNotebookHeartbeat:e2,stopRunningNotebookHeartbeat:e5,shutdownNotebook:tt,restartNotebook:tc,cancelExecution:eF,fetchResourceUsage:eB,restartNotebookKernel:eQ,pushNotification:tu,updatePackage:tE,controlResponseStatus:ty,onExternalAccessIntegrationError:eW,onNotebookConcurrentEditAlert:e$,reconnectSession:tg,connectWebsocket:tS,networkConditionChanged:th,syncNotebookEditorState:tv,saveNotebookSessionSettings:tO,updateExecuteConfiguration:tp,openPackageUpdateAlert:tR,fetchLatestNotebookSessionSettings:tb},tI,e8)),tA=(0,u.useCallback)((e,t,n)=>tC[(0,eS.E)(e,t,n)],[tC]),tw=(0,u.useCallback)(e=>{eZ.current=e},[]),tL=(0,u.useCallback)((e,t,n)=>{let o=(0,eS.E)(e,t,n);return ed.current[o]},[]);return(0,u.useMemo)(()=>({getNotebookEditorState:tA,dispatchNotebookEditorStatesMap:tN,connectToWebSocket:eU,disconnectWebsocket:ej,subscribe:t_,setHeartbeatPollEndTimeUpdateCallback:tw,getWebsocketConnection:tL}),[eU,ej,tN,tA,t_,tw,tL])})()),tu=tc,td=function({children:e}){return(0,o.jsx)(U.U,{children:(0,o.jsx)(ts,{children:e})})};td.displayName="NotebookEditorGlobalProvider";let tf=()=>({cellRunStatus:"neverRun",pushdownQueries:[],startedAt:void 0,endAt:void 0,cellRunStatusBeforeExecution:"neverRun"}),tE=()=>({status:tf(),message:[]})},429523:function(e,t,n){n.d(t,{v:()=>p});var o=n(467131),r=n(499269),i=n(313554),a=n(689500),l=n(952624),s=n(469081),c=n(670840),u=n(748563),d=n(415299),f=n(65180);function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}class p{swapCell(e,t){return new p((0,r.ZP)(this.data,n=>{let o=n.cells;return e>=0&&e<o.length&&t>=0&&t<o.length&&([o[e],o[t]]=[o[t],o[e]]),n}),this.options)}static fromJson(e,t){let{enforceUUIDAsCellId:n=!1,enableConvertRawToMarkdown:o=!1,enableSafeCellIdGeneration:r=!1,convertRawToMarkdown:i=!1,isCellNameAndVariableConflictDetectionEnabled:a=!1}=t||{};try{var l,c;let u=JSON.parse(e),b=(0,d.J)(u,{enforceUUIDAsCellId:n,enableConvertRawToMarkdown:o,enableSafeCellIdGeneration:r,convertRawToMarkdown:i});for(let e of b.cells)e.result=(0,f.Hx)();let y=!1;return a&&s.bW.pythonModule&&(b.globalVariableDefiningCellsCount=p.analyzeGlobalVars(b.cells),y=!0),new p(b,(l=E({},null!=t?t:{}),c={globalVariablesAnalyzed:y},c=null!=c?c:{},Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(c)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(c)).forEach(function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(c,e))}),l))}catch(e){if(e instanceof d.m)throw e;throw Error(`Failed to parse nbformat string. ${null==e?void 0:e.message}`)}}toJson(){let e=[];for(let t of this.data.cells){let{result:n}=t,o=function(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(t,["result"]);e.push(o)}return JSON.stringify({metadata:this.data.metadata,nbformat_minor:this.data.nbformat_minor,nbformat:this.data.nbformat,cells:e},null,1)}static analyzeGlobalVars(e){let t={};for(let n of e)(0,a.ro)(n)&&(0,s.a_)((0,u.V)(n)).forEach(e=>{t[e]=(t[e]||0)+1});return t}checkAndAnalyzeGlobalVars(e){s.bW.pythonModule&&!this.options.globalVariablesAnalyzed&&(e.globalVariableDefiningCellsCount=p.analyzeGlobalVars(e.cells),this.options.globalVariablesAnalyzed=!0)}addCell(e,t){return new p((0,r.ZP)(this.data,n=>{if(this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(n),n.cells.splice(e,0,t),this.options.isCellNameAndVariableConflictDetectionEnabled&&(0,a.ro)(t)){let e=(0,s.a_)((0,u.V)(t));n.globalVariableDefiningCellsCount||(n.globalVariableDefiningCellsCount={}),e.forEach(e=>{n.globalVariableDefiningCellsCount[e]=(n.globalVariableDefiningCellsCount[e]||0)+1})}}),this.options)}removeCell(e){return new p((0,r.ZP)(this.data,t=>{this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(t);let n=t.cells[e];if(t.cells.splice(e,1),this.options.isCellNameAndVariableConflictDetectionEnabled&&(0,a.ro)(n)){let e=(0,s.a_)((0,u.V)(n));t.globalVariableDefiningCellsCount||(t.globalVariableDefiningCellsCount={}),e.forEach(e=>{t.globalVariableDefiningCellsCount[e]&&(t.globalVariableDefiningCellsCount[e]-=1)})}}),this.options)}insertBefore(e,t){return new p((0,r.ZP)(this.data,n=>{if(e<0||e>=n.cells.length||t<0||t>=n.cells.length)return;let[o]=n.cells.splice(e,1);n.cells.splice(t,0,o)}),this.options)}moveCellUp(e){return this.swapCell(e,e-1)}moveCellDown(e){return this.swapCell(e,e+1)}modifyCell(e,t){return new p((0,r.ZP)(this.data,n=>{this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(n);let o=(0,u.V)(n.cells[e]);if(n.cells[e].source=t,this.options.isCellNameAndVariableConflictDetectionEnabled&&(0,a.ro)(n.cells[e])){let e=(0,s.a_)(t),r=(0,s.a_)(o),i=[...e].filter(e=>!r.has(e)),a=[...r].filter(t=>!e.has(t));n.globalVariableDefiningCellsCount||(n.globalVariableDefiningCellsCount={}),i.forEach(e=>{n.globalVariableDefiningCellsCount[e]=(n.globalVariableDefiningCellsCount[e]||0)+1}),a.forEach(e=>{n.globalVariableDefiningCellsCount[e]&&(n.globalVariableDefiningCellsCount[e]-=1)})}}),this.options)}updateCellResult(e,t){let n=this.cellIndexById[e];if(void 0===n)return o.cM.warn("can not find cell corresponding to the cellId"),this;let i=E({},this.data.cells[n].result,t);return new p((0,r.ZP)(this.data,e=>{e.cells[n].result=i}),this.options)}updateCellStatus(e,t){let n=this.cellIndexById[e];if(void 0===n)return o.cM.warn("can not find cell corresponding to the cellId"),this;let i=E({},this.data.cells[n].result.status,t);return new p((0,r.ZP)(this.data,e=>{e.cells[n].result.status=i}),this.options)}updatePredictExecutionId(e){let t=this.cellIndexById[e];return void 0===t?(o.cM.warn("can not find cell corresponding to the cellId"),this):new p((0,r.ZP)(this.data,e=>{var n;let o=null!=(n=(0,r.Js)(e.cells))?n:[],i=t>0?o[t-1].result.executionId:void 0;for(let n=t;n<o.length;n++){let t=(0,c.b)(i,e.cells[n].result.selfContentHash,e.cells[n].result.runId);e.cells[n].result.predictedExecutionId=t,i=t}}),this.options)}setLanguage(e,t){return new p((0,r.ZP)(this.data,n=>{let o=n.cells[e],r=(0,a.ro)(o);if(this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(n),(0,a.NT)(o)&&"markdown"!==t?n.cells[e]=function(e,t){let n=(0,l.B)(t,e.metadata.name);return n.metadata.collapsed=e.metadata.collapsed,n.metadata.codeCollapsed=e.metadata.collapsed,n.source=e.source,n.id=e.id,n}(o,t):(0,a.M1)(o)&&"markdown"===t?n.cells[e]=function(e){let t=(0,l.B)("markdown",e.metadata.name);return t.metadata.collapsed=e.metadata.collapsed&&e.metadata.codeCollapsed,t.source=e.source,t.id=e.id,t}(o):(0,a.M1)(o)&&"markdown"!==t&&(o.metadata.language=t),n.globalVariableDefiningCellsCount||(n.globalVariableDefiningCellsCount={}),r||"python"!==t){if(r&&"python"!==t){let t=(0,u.V)(n.cells[e]);(0,s.a_)(t).forEach(e=>{n.globalVariableDefiningCellsCount[e]&&(n.globalVariableDefiningCellsCount[e]-=1)})}}else{let t=(0,u.V)(n.cells[e]);(0,s.a_)(t).forEach(e=>{n.globalVariableDefiningCellsCount[e]=(n.globalVariableDefiningCellsCount[e]||0)+1})}}),this.options)}setWarehouse(e,t){return new p((0,r.ZP)(this.data,n=>{let o=n.cells[e];if(!(0,a.XN)(o))throw Error("setting warehouse on non-SQL cell not yet supported");o.metadata.EXECUTION_WAREHOUSE=t}),this.options)}setContentState(e,t){return new p((0,r.ZP)(this.data,n=>{if(void 0!==e){let o=n.cells[e];void 0!==t.collapsed&&(o.metadata.collapsed=t.collapsed),(0,a.M1)(o)&&void 0!==t.codeCollapsed&&(o.metadata.codeCollapsed=t.codeCollapsed)}else{let e=this.data.cells;for(let o=0;o<e.length;o++){let e=n.cells[o];void 0!==t.collapsed&&(e.metadata.collapsed=t.collapsed),(0,a.M1)(e)&&void 0!==t.codeCollapsed&&(e.metadata.codeCollapsed=t.codeCollapsed)}}}),this.options)}updateLastEditStatus(e){return new p((0,r.ZP)(this.data,t=>{t.metadata.lastEditStatus=e}),this.options)}renameCell(e,t){return new p((0,r.ZP)(this.data,n=>{n.cells[e].metadata.name=t}),this.options)}getCellsProto(){let e=[];for(let n of this.data.cells){var t;let{id:o,metadata:r,cell_type:i,source:a}=n,l={};for(let e in r)("string"==typeof r[e]||r[e]instanceof String)&&(l[e]=r[e]);e.push({id:o,name:null!=(t=r.name)?t:"",metadata:l,type:"code"===i?r.language:i,code:"string"==typeof a?a:a.join(""),outputFormat:r.outputFormat})}return e}getCellIndexById(e){return this.cellIndexById[e]}getCellById(e){return this.data.cells[this.cellIndexById[e]]}getCellResult(e){var t;return null==(t=this.getCellById(e))?void 0:t.result}getCellResultSize(e){var t;return(0,i.Q)(null==(t=this.getCellResult(e))?void 0:t.message)}getCellResultQueryId(e){var t,n,o;let r=null==(t=this.getCellResult(e))?void 0:t.status,[i]=null!=(n=null==r?void 0:r.pushdownQueries)?n:[];return null!=(o=null==i?void 0:i.queryId)?o:void 0}getLastEditStatus(){var e,t;return null==(t=this.data)||null==(e=t.metadata)?void 0:e.lastEditStatus}getGlobalVariables(){var e;return null!=(e=this.data.globalVariableDefiningCellsCount)?e:{}}clearAllResults(){let e=this.data.cells;return new p((0,r.ZP)(this.data,t=>{for(let n=0;n<e.length;n++)t.cells[n].result=(0,f.Hx)()}),this.options)}clearAllExecutionStates(){let e=this.data.cells;return new p((0,r.ZP)(this.data,t=>{for(let n=0;n<e.length;n++)"neverRun"!==t.cells[n].result.status.cellRunStatus&&(t.cells[n].result.status.cellRunStatus="idle")}),this.options)}isAllCellsExpanded(){let e=!0;return this.data.cells.forEach(t=>{(0,a.M1)(t)&&t.metadata.codeCollapsed&&t.metadata.collapsed&&(e=!1),(0,a.NT)(t)&&t.metadata.collapsed&&(e=!1)}),e}isCellResultCollapsed(e){var t;let n=this.cellIndexById[e];return!!(null==(t=this.data.cells[n])?void 0:t.metadata.collapsed)}constructor(e,t={}){this.data=e,this.options=t,this.cellIndexById={};for(let t=0;t<e.cells.length;t++){let n=e.cells[t];this.cellIndexById[n.id]=t}}}},64472:function(e,t,n){n.d(t,{n:()=>I});var o=n(184168),r=n(630455),i=n(702679),a=n(155382),l=n(145753),s=n(236689),c=n(173465),u=n(77822),d=n(239243),f=n(233174),E=n(193691),p=n(20170),b=n(912622),y=n(499924),g=n(778098),S=n(665007),O=n(674337),h=n(327879),m=n(98047),_=n(699395);let I=({hide:e,saveEligibilityCheckStatus:t,editingUserName:n,editingUserEmail:I,fullNotebookIdentifier:T,onDuplicateNotebook:v,notebookViewId:R,role:C,causalElement:N})=>{let A=(0,r.z)(()=>{L(T,O.DsD,{notebookViewId:R,saveEligibilityCheckStatus:t},"ui_click"),window.location.reload()}),{formatMessage:w}=(0,g.Z)(),{logNotebookEditEvent:L}=(0,m.N)(),k=!!(0,_.Z)(T),P=(0,y.useMemo)(()=>(0,o.jsxs)(i.s,{width:"100%",rowGap:12,children:[(0,o.jsx)(a.n,{color:l.Q2.primaryTextColor,children:w({id:"{userName}{emailPart} is editing this notebook."},{userName:(0,o.jsx)(s.x,{fontWeight:600,children:n}),emailPart:I?` (${I}) `:""})}),(0,o.jsx)(a.n,{color:l.Q2.primaryTextColor,marginTop:24,children:w({id:"To prevent overwriting each other, wait until {userName} stops editing for 1 minute. You can also duplicate this notebook to make your own copy."},{userName:n})})]}),[n,I,w]),D=(0,y.useMemo)(()=>(0,o.jsxs)(i.s,{width:"100%",rowGap:16,children:[(0,o.jsx)(a.n,{color:l.Q2.primaryTextColor,children:w({id:"{userName}{emailPart} recently edited this notebook. Reload to see their latest changes."},{userName:(0,o.jsx)(s.x,{fontWeight:600,children:n}),emailPart:I?` (${I}) `:""})}),(0,o.jsx)(c.j,{marginTop:16,theme:"yellow",icon:"warning-triangle",title:(0,o.jsx)(s.x,{color:l.Q2.statusWarningColor,fontSize:14,weight:500,children:w({id:"Reloading will discard your unsaved changes."})})})]}),[n,I,w]),M=(0,y.useMemo)(()=>(0,o.jsx)(a.n,{color:l.Q2.primaryTextColor,children:w({id:"You recently edited this notebook in another browser tab. Reload to see your latest changes."})}),[w]),U=(0,y.useCallback)(()=>{e(),v(T),L(T,O.$aC,{notebookViewId:R,saveEligibilityCheckStatus:t},"ui_click")},[e,v,T,R,t,L]),j=(0,y.useCallback)(()=>{L(T,O.mBO,{notebookViewId:R,saveEligibilityCheckStatus:t},"ui_click"),e()},[e,T,R,t,L]),x=(0,y.useMemo)(()=>{if("cannotSaveDueToRecentChangeFromSameUser"===t)return(0,o.jsx)(u.cN,{marginTop:8,children:(0,o.jsxs)(d.g,{children:[(0,o.jsx)(f.zx,{onClick:j,children:(0,o.jsx)(S.Z,{id:"Close"})}),(0,o.jsx)(f.zx,{use:"primary",onClick:A,marginLeft:8,children:(0,o.jsx)(S.Z,{id:"Reload notebook"})})]})});let e=k&&(0,h.e)(C),n=(0,o.jsx)(E.h,{onClick:e?void 0:U,textDecorationLine:"none",color:e?l.Q2.textButtonDisabledColor:l.Q2.textButtonColor,disabled:e,children:w({id:"Duplicate notebook"})});return(0,o.jsxs)(u.cN,{align:"justify",verticalAlign:"middle",marginTop:8,children:[e?(0,o.jsx)(p.u,{text:w({id:"Can't duplicate container notebooks using the ACCOUNTADMIN, SECURITYADMIN, or ORGADMIN roles. Try a different role."}),children:n}):n,(0,o.jsxs)(d.g,{children:[(0,o.jsx)(f.zx,{onClick:j,children:(0,o.jsx)(S.Z,{id:"Close"})}),"cannotSaveDueToRecentChangeFromOtherUser"===t&&(0,o.jsx)(f.zx,{use:"primary",onClick:A,marginLeft:8,children:(0,o.jsx)(S.Z,{id:"Reload notebook"})})]})]})},[t,U,A,w,j,k,C]);return(0,o.jsxs)(u.Vq,{manuallyShown:!0,behaviors:[b.O],onHide:e,causalElement:N,width:500,children:[(0,o.jsx)(u.fK,{children:(0,o.jsx)(S.Z,{id:"Can't save changes"})}),(0,o.jsxs)(u.a7,{marginBottom:12,children:["cannotSaveDueToEditLocked"===t&&P,"cannotSaveDueToRecentChangeFromOtherUser"===t&&D,"cannotSaveDueToRecentChangeFromSameUser"===t&&M]}),x]})};I.displayName="NotebookConcurrentEditAlertDialog"},261042:function(e,t,n){n.d(t,{d:()=>d});var o=n(609737),r=n(499924),i=n(501188),a=n(493098),l=n(254759);let s=({observerEnabled:e,visibleCallback:t})=>{(0,r.useEffect)(()=>{let n=()=>{e&&"visible"===document.visibilityState&&t&&t()};return document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}},[e,t])};var c=n(559159),u=n(571902);let d=()=>{let{dataDiscoverRole:e,secondaryRoles:t}=(0,i.j)(),n=(0,l.m)(["user"]),d=o.flags.UI_ENABLE_NOTEBOOK_FEATURE_38(),{localTimeToServerTime:E}=(0,u.h)(),p=(0,c.L)(),b=(0,r.useRef)(!1),y=(0,r.useCallback)(async n=>{var o;return null!=(o=JSON.parse(await p(n,e,t)).metadata.lastEditStatus)?o:null},[p,e,t]);return s({observerEnabled:d,visibleCallback:(0,r.useCallback)(()=>{b.current=!0},[])}),(0,r.useCallback)(async({id:e,urlId:t,currentNotebookViewId:o,lastEditStatusInMemory:r,lastestNotebookLoadTime:i})=>{let l=!1,s=r;if(!n.user.currentUserId)return{checkStatus:"cannotSaveDueToEditLocked",lastEditStatusRetrieved:null};let c=E();if(!(null==s?void 0:s.lastEditTime)||c-s.lastEditTime>6e4||d&&n.user.currentUserId===s.authorId&&s.sessionId!==o||b.current){if(s=await y(e),(0,a.IG)(a.cf.NOTEBOOK_EDIT_LOCK_CHECK)){var u;(null==r?void 0:r.lastEditTime)?c-(null!=(u=null==s?void 0:s.lastEditTime)?u:0)>6e4?console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Recent check expired, reload latest edit history from file: ",s):n.user.currentUserId===(null==s?void 0:s.authorId)&&s.sessionId!==o?console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Same user switched to a different session: ",s):b.current&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Notebook transit to focused state, reload latest edit history from file: ",s):console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] No in memory last edit status, load latest edit history from file: ",s)}l=!0,b.current&&(b.current=!1)}s&&s.notebookId===t||(s={notebookId:t,authorId:"",authorName:"",sessionId:o,lastEditTime:0},l=!0);let p="canSave",g=i?E(i):0;return c=E(),s.authorId===n.user.currentUserId?d&&g&&s.sessionId!==o&&g<s.lastEditTime?((0,a.IG)(a.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Recent edit was from the same user with changes from other sessions. lastEditTime: ",f(s.lastEditTime)," current time: ",f(c)," lastestNotebookLoadServerTime: ",f(g)),p="cannotSaveDueToRecentChangeFromSameUser"):((0,a.IG)(a.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Recent edit was from the same user. lastEditTime: ",f(s.lastEditTime)," current time: ",f(c)," lastestNotebookLoadServerTime: ",f(g)),p="canSave"):c-s.lastEditTime<=6e4?((0,a.IG)(a.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Active lock from different user. lastEditTime: ",f(s.lastEditTime)," current time: ",f(c)),p="cannotSaveDueToEditLocked"):g&&g<s.lastEditTime?((0,a.IG)(a.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Inactive Lock but has recent changes after previous load. lastEditTime: ",f(s.lastEditTime)," lastestNotebookLoadServerTime ",f(g)),p="cannotSaveDueToRecentChangeFromOtherUser"):((0,a.IG)(a.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Inactive Lock and has no recent changes after previous load. lastEditTime: ",f(s.lastEditTime)," lastestNotebookLoadServerTime ",f(g)),p="canSave"),{checkStatus:p,lastEditStatusRetrieved:l?s:null}},[n.user.currentUserId,y,E,d])},f=e=>new Date(e).toISOString()},181670:function(e,t,n){n.d(t,{Z:()=>a});var o=n(499924),r=n(690908),i=n(254759);let a=()=>{let{user:e}=(0,i.m)(["user"]);return(0,o.useCallback)(async({role:t,secondaryRoles:n})=>{let o=new r.L("SELECT SYSDATE()").toQuery();return new Date((await e.api.query(o,{isInternal:!0,role:t,secondaryRoles:n,desc:"get-system-utc-time"})).rows[0][0])},[e.api])}},571902:function(e,t,n){n.d(t,{h:()=>d});var o=n(609737),r=n(499924),i=n(501188),a=n(254759),l=n(181670),s=n(557078),c=n(242574);function u(){let e=(0,s.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.fetchSystemDate}let d=()=>{let{user:e}=(0,a.m)(["user"]),{dataDiscoverRole:t,secondaryRoles:n}=(0,i.j)(),s=(0,c.U)(l.Z,u)(),[d,f]=(0,r.useState)(0),E=o.flags.UI_ENABLE_NOTEBOOK_FEATURE_24(),p=!!e.currentUserId;(0,r.useEffect)(()=>{let e=async()=>{let e=await s({role:t,secondaryRoles:n}),o=Date.now();f(e.getTime()-o)};E&&p&&e()},[t,n,p,e.api,E,s]);let b=(0,r.useCallback)(e=>(null!=e?e:Date.now())+d,[d]);return{localToServerTimeOffset:d,localTimeToServerTime:b}}},920597:function(e,t,n){n.d(t,{q:()=>i});var o=n(499924),r=n(436978);let i=(e,t)=>(0,o.useCallback)((n,o,i)=>{let{id:a,role:l,secondaryRoles:s}=o,c=e[(0,r.E)(a,l,s)];c&&t(c,o,i)},[e,t])},3535:function(e,t,n){n.d(t,{FG:()=>r,Ff:()=>E,IM:()=>O,P7:()=>h,QX:()=>c,Sc:()=>b,Ti:()=>p,Xv:()=>l,_n:()=>o,bZ:()=>y,g3:()=>S,gr:()=>a,kk:()=>s,lX:()=>i,nL:()=>g,sW:()=>u,wT:()=>d,x5:()=>f});let o="notebook-open-event",r="notebook-create-event",i="notebook-rename-event",a="notebook-edit-event",l="cell-ui-event",s="cell-run-event",c="submit-cell-run-event",u="ipynb-loading",d="mark-ws-heartbeat-start",f="websocket-connection",E="session-reconnect",p="notebook-session-start",b="notebook-session-end",y="notebook-run-event",g="notebook-kernel-restart-event",S="entity-duplicate-start",O="notebook-duration-new-cache-load",h="notebook-websocket-full-connecting-duration"},996342:function(e,t,n){n.d(t,{A:()=>o});function o(e){return!(e.length<1)&&!(e.length>64)&&!!/^[a-zA-Z0-9-_]+$/u.test(e)}},475085:function(e,t,n){n.d(t,{Q:()=>i,w:()=>a});var o,r,i=((o={}).NotConnected="notConnected",o.Connected="connected",o.Connecting="connecting",o.Reconnecting="reconnecting",o.RestartingKernel="restartingKernel",o.Error="error",o),a=((r={}).NOTEBOOK_RECONNECT="NOTEBOOK_RECONNECT",r.GS_XP_STREAM_CLOSED="1011: GS/XP stream closed",r.NOTEBOOK_IDLE_TIMEOUT="1011: Idle time reached",r.USER_NOTEBOOK_SHUTDOWN="USER_NOTEBOOK_SHUTDOWN",r.NEW_WEBSOCKET_CONNECTION="1011: New websocket started",r.CLOSE_NOTEBOOK_PAGE="CLOSE_NOTEBOOK_PAGE",r.NETWORK_DOWN="NETWORK_DOWN",r.SERVER_INTERNAL_ERROR="1011: Internal error in [Streamlit server]",r.NOTEBOOK_RECONNECT_FAILED="1008: RECONNECTION_FAILED",r)},601401:function(e,t,n){n.d(t,{Dz:()=>r,Y7:()=>o,mk:()=>i});let o="notebooks-result-height-cache",r=50;function i(){let e;try{e=new Map(JSON.parse(localStorage.getItem(o)||"[]"))}catch(t){localStorage.setItem(o,"[]"),e=new Map}return e}},274438:function(e,t,n){function o(e){return"running"===e||"populatingResults"===e}function r(e){return o(e)||"waiting"===e}function i(e){if("code"!==e.cell_type)return!1;let t="string"==typeof e.source?e.source:e.source.join("");return/^(?!\s*#)\s*[!%](?:pip|conda)\s+install/mu.test(t)}function a(e){return"success"===e||"error"===e}n.d(t,{WT:()=>o,YX:()=>r,be:()=>a,rv:()=>i})},689500:function(e,t,n){function o(e){return"python"===e.metadata.language}function r(e){return"sql"===e.metadata.language}function i(e){return!!(o(e)||r(e))}function a(e){return"markdown"===e.cell_type}function l(e){let{metadata:t,cell_type:n}=e;return"markdown"===n?n:t.language}function s(e){return"code"===e.cell_type}n.d(t,{DA:()=>l,M1:()=>i,NT:()=>a,XN:()=>r,fM:()=>s,ro:()=>o})},469081:function(e,t,n){n.d(t,{We:()=>r,a_:()=>i,bW:()=>o});let o={pythonModule:null},r=()=>{Promise.all([n.e("52734"),n.e("19294"),n.e("31505")]).then(n.bind(n,996081)).then(e=>{o.pythonModule=e})};function i(e){if(!o.pythonModule)return new Set;let{parser:t}=o.pythonModule.python().language,n=t.parse(e),r=new Set,i=n.cursor(),a=t=>{if(t.firstChild()){do"VariableName"===t.name?r.add(e.slice(t.from,t.to)):("TupleExpression"===t.name||"ExpressionList"===t.name)&&a(t);while(t.nextSibling());t.parent()}},l=(t,n=0)=>{if(!(n>2))do{let o=t.name;if("FunctionDefinition"!==o&&"ClassDefinition"!==o||n)if(("AssignStatement"===o||"ForStatement"===o||"WhileStatement"===o)&&0===n){if(t.firstChild()){let n=-1,o=0;do"AssignOp"===t.name&&(n=o),o++;while(t.nextSibling());for(;t.prevSibling(););o=0;do(o<n||-1===n)&&("VariableName"===t.name?r.add(e.slice(t.from,t.to)):("TupleExpression"===t.name||"ExpressionList"===t.name)&&a(t)),o++;while(t.nextSibling());t.parent()}t.firstChild()&&(l(t,n),t.parent())}else t.firstChild()&&(l(t,n),t.parent());else t.firstChild()&&t.nextSibling()&&(r.add(e.slice(t.from,t.to)),t.parent()),t.firstChild()&&(l(t,n+1),t.parent())}while(t.nextSibling())};return i.firstChild()&&l(i),r}},670840:function(e,t,n){n.d(t,{S:()=>i,b:()=>a});var o=n(271754),r=n(689500);function i(e,t){let n=o.sha256.create();if(n.update(e.id),!t){var i;n.update(null!=(i=e.metadata.name)?i:"")}return n.update((0,r.DA)(e).toUpperCase()),n.update("string"==typeof e.source?e.source:e.source.join("")),n.hex()}function a(e,t,n){let r=o.sha256.create();return r.update(null!=e?e:""),r.update(null!=t?t:""),r.update(null!=n?n:""),r.hex()}},952624:function(e,t,n){n.d(t,{B:()=>i});var o=n(164214),r=n(65180);function i(e,t,n){let i;return"markdown"===e?{cell_type:"markdown",id:o.Z(),metadata:{name:t},source:null!=n?n:"",result:(0,r.Hx)()}:{cell_type:"code",id:o.Z(),metadata:{language:e,name:t},outputs:[],source:null!=n?n:"",execution_count:null,result:(0,r.Hx)()}}},748563:function(e,t,n){n.d(t,{V:()=>o});let o=e=>"string"==typeof e.source?e.source:e.source.join("\n")},247174:function(e,t,n){n.d(t,{t:()=>o});function o(e,t){switch(e){case"valid":case"empty":return null;case"tooLong":return t({id:"Exceeds maximum length of 255 characters"});case"invalidCharacters":return t({id:"Name can only include letters, numbers, spaces, underscores, -, $, and :"})}}},408195:function(e,t,n){n.d(t,{i:()=>o});function o(e){let t=new Set(e.map(e=>{var t;return null==(t=e.metadata)?void 0:t.name})),n="";for(let o=1;o<=e.length+1;o++){let e=`cell${o}`;if(!t.has(e)){n=e;break}}return n}},432532:function(e,t,n){n.d(t,{e:()=>r});var o=n(527565);function r(e){return e===o.U?"wh":"spcs"}},900352:function(e,t,n){function o(e){return"pending"===e||"fetching"===e}function r(e){return"loaded"===e||"error"===e}n.d(t,{P:()=>o,f:()=>r})},569016:function(e,t,n){n.d(t,{q:()=>r});var o=n(648834);function r(e){return(0,o.w)("UI_ENABLE_NOTEBOOK_FEATURE_54","UI_ENABLE_NOTEBOOK_FEATURE_53","isParallelFetchEnabled",e)}},399696:function(e,t,n){n.d(t,{G:()=>o});function o(e){var t,n;return null!=(n=e.delta)&&null!=(t=n.newElement)&&!!t.exception}},137757:function(e,t,n){function o(e){return!!e.match(/integration '.+'/imu)}n.d(t,{T:()=>o,p:()=>i});let r=["`np.float_` was removed in the NumPy 2.0 release. Use `np.float64` instead."];function i(e){return r.some(t=>e.includes(t))}},415299:function(e,t,n){n.d(t,{m:()=>b,J:()=>y});var o=n(467131),r=n(207055),i=n.n(r),a=n(164214),l=n(34589),s=n(996342);let c="ce110000-1111-2222-3333-ffffff",u=c+"{:06d}",d=c.length+6;class f{_markIfMatchingPattern(e){let t=null;if(e.length===d&&e.startsWith(c)){if(!Number.isInteger(t=Number(e.slice(c.length))))return null;this._seenIndexes[t]=t}return t}markIfMatchingPattern(e){let t=null;return null!==e&&(t=this._markIfMatchingPattern(e)),t}_doGeneratedId(){let e=u.replace("{:06d}",this._lastGeneratedIndex.toString().padStart(6,"0"));return this._lastGeneratedIndex+=1,e}_generateNextId(){let e=null;for(;null===e;){for(;this._lastGeneratedIndex in this._seenIndexes;)this._lastGeneratedIndex+=1;(e=this._doGeneratedId())in this._seenIds&&(e=null)}return e}generateAndMarkNextId(){let e=this._generateNextId();return this._seenIds[e]=e,e}ensureValidId(e){return null===e||""===e||e in this._seenIds?this.generateAndMarkNextId():(this._seenIds[e]=e,e)}constructor(){this._lastGeneratedIndex=0,this._seenIds={},this._seenIndexes={}}}var E=n(689500),p=n(408195);class b extends Error{constructor(...e){super(...e),this.name="RawCellDetectedError",this.message="RawCellDetectedError"}}function y(e,t){let{enforceUUIDAsCellId:n=!1,enableConvertRawToMarkdown:r=!1,enableSafeCellIdGeneration:c=!1,convertRawToMarkdown:u=!1}=t||{},d=i()(e);if(!Array.isArray(d.cells))throw Error("Can not find cell arrays.");let y=new f;for(let e of d.cells){var S;if(!e||!g(e))throw Error("Format of a cell is incorrect.");if(r&&"raw"===e.cell_type){if(!u)throw new b;e.cell_type="markdown"}if("code"!==e.cell_type&&"markdown"!==e.cell_type)throw Error("Cell type is incorrect.");if(c){let t=null==e.id?null:e.id.toString();e.id=y.ensureValidId(t),e.id!==t&&o.cM.info("parseIpynb",`New notebook cell ID is generated: ${e.id}. Original ID: ${t}.`)}else e.id||(e.id=a.Z());if("string"!=typeof e.id||!(0,s.A)(e.id))throw Error("Cell id is not valid.");n&&(S=e.id,!/^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/u.test(S))&&(e.id=a.Z()),"code"!==e.cell_type||e.outputs||(e.outputs=[]),"code"===e.cell_type&&void 0===e.execution_count&&(e.execution_count=null),e.source||(e.source=""),g(e.metadata)||(e.metadata={}),e.metadata.name||(e.metadata.name=(0,p.i)(d.cells)),(0,E.fM)(e)&&!e.metadata.language&&(e.metadata.language="python")}return e.nbformat!==l.$&&(d.nbformat=l.$),d}function g(e){return"object"==typeof e}},436978:function(e,t,n){n.d(t,{E:()=>r});var o=n(794912);function r(e,t,n){let r=(0,o.P)(e.database),i=(0,o.P)(e.schema),a=(0,o.P)(e.name);return`${t}.${n}.${r}.${i}.${a}`}},7042:function(e,t,n){n.d(t,{ne:()=>l,qq:()=>r,vi:()=>a});var o=n(475085);let r=[o.w.NOTEBOOK_RECONNECT,o.w.NOTEBOOK_IDLE_TIMEOUT,o.w.USER_NOTEBOOK_SHUTDOWN,o.w.NEW_WEBSOCKET_CONNECTION,o.w.CLOSE_NOTEBOOK_PAGE,o.w.GS_XP_STREAM_CLOSED,o.w.NETWORK_DOWN],i=[o.w.NOTEBOOK_RECONNECT_FAILED,o.w.SERVER_INTERNAL_ERROR],a=({udfConnectionStatus:e,disconnectReason:t})=>e===o.Q.Connected&&!r.includes(null!=t?t:"")&&!i.some(e=>null==t?void 0:t.startsWith(e)),l=e=>!!(null==e?void 0:e.startsWith(o.w.NOTEBOOK_RECONNECT_FAILED))},994106:function(e,t,n){n.d(t,{Dy:()=>s,PJ:()=>d,jX:()=>c,k$:()=>u});var o=n(609737),r=n(690908),i=n(67158),a=n(868646),l=n(94587);function s(e,t){let{role:n,secondaryRoles:o,fullNotebookIdentifier:a,serviceIdentifier:s}=t;return e.api.query(new r.L("CALL SYSTEM$DELETE_RUNNING_NOTEBOOK_INSTANCES({}, {})",(0,l.i)((0,i.m)(a)),(0,l.i)(s)).toQuery(),{role:n,secondaryRoles:o,isInternal:!0,desc:"delete-notebook-instances"})}async function c({userStore:e,fullNotebookIdentifier:t,role:n,secondaryRoles:o}){let i=new r.L().add("CALL SYSTEM$LIST_RUNNING_NOTEBOOK_INSTANCES(?)",(0,a.M)(t)).toQuery(),[[l]]=(await e.api.query(i,{role:n,secondaryRoles:o,isInternal:!0,desc:"system-list-running-notebook-instances"})).rows;return JSON.parse(l).filter(e=>e.serviceId.length>0)}async function u({userStore:e,uniqueId:t,role:n,secondaryRoles:o}){let i=new r.L().add("CALL SYSTEM$GENERATE_NOTEBOOK_FQN_FROM_ID(?)",(0,l.i)(t)).toQuery(),[[a]]=(await e.api.query(i,{role:n,secondaryRoles:o,isInternal:!0,desc:"system-get-notebook-full-identifier-from-unique-id"})).rows;return a}async function d({userStore:e,role:t,secondaryRoles:n}){if(!o.flags.ENABLE_UI_FEATURE_NOTEBOOKS_ACTIVE_STATUS())return[];let i=new r.L().add("CALL SYSTEM$LIST_USER_RUNNING_NOTEBOOKS()").toQuery(),a=await e.api.query(i,{role:t,secondaryRoles:n,isInternal:!0,desc:"system-list-user-running-notebooks"});if(!a||0===a.rows.length)return[];let[[l]]=a.rows;return l?JSON.parse(l):[]}},79517:function(e,t,n){n.d(t,{Ex:()=>u,Ke:()=>l,_Z:()=>c,_y:()=>a,ae:()=>s});let o=/^[_a-zA-Z]/u,r=/^[_a-zA-Z][_a-zA-Z0-9]*$/u;var i,a=((i={}).DUPLICATE="DUPLICATE",i.RESERVED_WORDS="RESERVED_WORDS",i.INVALID_START="INVALID_START",i.INVALID_CHAR="INVALID_CHAR",i.VARIABLE_CONFLICT="VARIABLE_CONFLICT",i.NONE="NONE",i);function l(e,t){return new Set(["and","as","assert","break","class","continue","def","del","elif","else","except","false","finally","for","from","global","if","import","in","is","lambda","none","nonlocal","not","or","pass","raise","return","true","try","while","with","yield"]).has(e.toLowerCase())?{isValid:!1,reason:"RESERVED_WORDS"}:o.test(e)?r.test(e)?t[e]?{isValid:!1,reason:"VARIABLE_CONFLICT"}:{isValid:!0,reason:"NONE"}:{isValid:!1,reason:"INVALID_CHAR"}:{isValid:!1,reason:"INVALID_START"}}function s(e,t,n){for(let o=0;o<e.length;o++)if(e[o].metadata.name===t&&o!==n)return!1;return!0}function c(e,t){switch(e){case"RESERVED_WORDS":return t({id:"Reserved word in Python cannot be used as a cell name."});case"INVALID_START":return t({id:"Cell names must start with a letter or an underscore."});case"INVALID_CHAR":return t({id:"Cell names can only contain alphanumeric characters and underscores."});case"DUPLICATE":return t({id:"Cell name must be unique."});case"VARIABLE_CONFLICT":return t({id:"Can’t use the same name as a Python variable."});default:return""}}function u(e,t){return t({id:"Failed to rename cell. {message}"},{message:c(e,t)})}},523692:function(e,t,n){n.d(t,{V:()=>r});var o=n(850114);let r=e=>{let t=e.trim();return t?t.length>o.g0?"tooLong":/^[a-zA-Z0-9_$\- :]+$/u.test(t)?"valid":"invalidCharacters":"empty"}},648834:function(e,t,n){n.d(t,{S:()=>l,w:()=>s});var o=n(307134),r=n(609737),i=n(254759);function a(e,t,n,r){let i=!1;return e?i=!0:t&&(i=!!n&&n%2==0),o.v.addFeatureFlagEvaluation(r,i),i}function l(e,t,n){var o;let{user:r}=null!=(o=(0,i.m)([]).untracked)?o:{},l=null==r?void 0:r.isUiSpecifiedSnowflakeFeatureEnabled(e);return a(l,null==r?void 0:r.isUiSpecifiedSnowflakeFeatureEnabled(t),Number(null==r?void 0:r.currentUserId),n)}function s(e,t,n,o){let i=r.flags[e]();return a(i,r.flags[t](),Number(null==o?void 0:o.currentUserId),n)}},198819:function(e,t,n){n.d(t,{E:()=>l});var o=n(499924),r=n(537840),i=n(168333),a=n(336400);function l(e){let t=(0,a.k)();return(0,o.useCallback)(async n=>{await (0,i.J)((0,i.R)(e),(0,r.mJ)(n),t)},[e,t])}},815877:function(e,t,n){n.d(t,{KP:()=>l,NT:()=>f,Nk:()=>m,p5:()=>d,EX:()=>s.E});var o=n(499924),r=n(778098),i=n(463462),a=n(782649);function l(){let{read:e}=(0,a.l)(),{formatMessage:t}=(0,r.Z)();return(0,o.useCallback)(async({rootLocation:n,mainFile:o,throwRawError:r})=>{let{stage:a,path:l}=(0,i.T)(n),s=await e(a,l,o);if(!s.success){if(r)throw s.error;throw Error(t({id:"An unexpected error occurred. Try refreshing the page or contact Support if the error persists."}))}return s.content},[t,e])}var s=n(198819),c=n(51723),u=n(674337);function d(){let{logNavigation:e}=(0,c.useTelemetry)();(0,o.useEffect)(()=>{e(u.Hku)},[e])}function f(){let e=(0,o.useRef)(),{logEvent:t}=(0,c.useTelemetry)(),n=(0,o.useCallback)(()=>{if(!e.current)return;let t=Math.round(performance.now()-e.current);return e.current=void 0,t},[]),r=(0,o.useCallback)(n=>{e.current=performance.now(),t({event:u.fmT,type:"ui_performance",component:"useStageFilesUploader",data:{filesCount:n}})},[t]);return{logUploadStarted:r,logUploadSucceeded:(0,o.useCallback)(e=>{t({event:u.rlY,type:"ui_performance",component:"useStageFilesUploader",data:{uploadedFilesCount:e,uploadingTimeInMs:n()}})},[t,n]),logUploadFailed:(0,o.useCallback)(e=>{t({event:u.U3e,type:"ui_response_error",component:"useStageFilesUploader",data:{error:e,uploadingTimeInMs:n()}})},[t,n])}}var E=n(524603),p=n(369859),b=n(731694),y=n(750671),g=n(320241),S=n(646397),O=n(998269),h=n(832072);function m(){let{write:e}=(0,a.l)(),t=(0,o.useContext)(g.V1),{formatMessage:n}=(0,r.Z)(),l=(0,b.iA)();return(0,o.useCallback)(async(o,r,a,s,c)=>{var u,d;let f=await (0,S.W)(t.get(r,o,O.Y.describe,{secondaryRoles:a}));if((0,h.D)(f))throw Error(n({id:"Could not get details for {type} object. Error: {message}"},{type:o.type.toLowerCase(),message:null==(u=f.error)?void 0:u.message}));if(!f.result)throw Error(n({id:"Could not get details for {type} object."},{type:o.type.toLowerCase()}));let{rootLocation:b,kind:g,isLive:m}=(0,p.R)(f.result.columns[0]),_=b;if("versioned"===g&&!m){let{liveVersionLocationUri:e}=await l({id:o,role:r,secondaryRoles:a});_=(0,y.h)(e,n({id:"Expected a valid live version location"}))}let{stage:I,path:T}=(0,i.T)(_),v=await e(I,E.join(T,E.dirname(f.result.columns[0].mainFile)),E.basename(f.result.columns[0].mainFile),s);if(!v.success){if(c)throw v.error;throw Error(n({id:"Could not save {type} content to stage. Error: {message}"},{type:o.type.toLowerCase(),message:null==(d=v.error)?void 0:d.message}))}},[l,n,t,e])}},902668:function(e,t,n){n.d(t,{Q:()=>R,B:()=>C});var o=n(184168),r=n(499924),i=n(755388),a=n(221009),l=n(446013),s=n(67158),c=n(40532),u=n(80550),d=n(423882),f=n(650294),E=n(689398),p=n(403842),b=n(674337),y=n(342141),g=n(775136);let S=({fullStreamlitIdentifier:e,clearFatalError:t,appStateMachine:n,appPreviewStatus:o,setAppPreviewStatus:i,updateIframeFetchId:a,loadAppTelemetry:l,websocketTelemetry:s,interactiveStartedTelemetry:c,initialResponseCacheState:u,iframeRef:S,iframeOrigin:O})=>{let h=(0,E.Yb)(),m=(0,E.EX)(),_=(0,g.h)(),I=(0,f.v)(n,y.pO),T=m?I:o===d.I.suspended;return{reloadApp:(0,r.useCallback)(({isReconnect:o,resetLoadAppTelemetry:r,source:f})=>{if(h&&_({fullStreamlitIdentifier:e,componentName:b.uD0,eventName:b.igR,eventType:"ui_impression",additionalTelemetryParams:{source:f}}),t("fatalErrorPage"===f),T&&!m&&i(d.I.loaded),o&&O){var E,y;m&&n.send("RESTART");let e={stCommVersion:p.hb,type:"RESTART_WEBSOCKET_CONNECTION"};null==(y=S.current)||null==(E=y.contentWindow)||E.postMessage(e,O),s.onRestartWebsocketConnection()}else m&&("fatalErrorPage"===f?n.send("FORCE_RESTART"):n.send("RESTART")),a();"retry"===f&&(m&&n.send("FAIL"),l.incrementRetryCount()),r&&(l.reset(),c.reset(),u.reset())},[t,T,O,i,m,n,S,_,e,a,l,s,c,u,h])}};var O=n(124823),h=n(164214),m=n(439337),_=n(767904);let I=(0,m.C)({predictableActionArguments:!0,tsTypes:{},schema:{context:{},events:{}},context:{iframeLoadRetryCount:0},id:"streamlitApp",initial:"loading",on:{FATAL:{target:"#streamlitApp.failed"}},states:{loading:{on:{LOADED:{target:"loaded"},FAIL:[{cond:"canIframeLoadRetry",actions:"incrementIframeLoadRetry",target:"loading"},{target:"failed"}]},after:{DEFAULT_DELAY:{target:"failed"}},description:"The app is currently loading. In this state, the app is initializing and preparing to be displayed."},loaded:{on:{SUSPEND:{target:"suspended"},RESTART:{target:"restarting"}},description:"The app has successfully loaded. In this state, the app is fully operational and ready for user interaction."},failed:{on:{FORCE_RESTART:{target:"restarting"}},description:"The app failed to load after reaching the maximum number of retries, encountered a fatal exception, or timed out while loading."},suspended:{on:{LOADED:{target:"loaded"},RESTART:{target:"restarting"}},description:"The app is suspended. In this state, the app is temporarily inactive and not available for user interaction."},restarting:{always:{target:"loading"},entry:{type:"resetIframeLoadRetryCount"},description:"The app is restarting. In this state, the app is resetting and will transition back to the loading state."}}},{delays:{DEFAULT_DELAY:3e4},actions:{incrementIframeLoadRetry:(0,_.f0)({iframeLoadRetryCount:e=>e.iframeLoadRetryCount++}),resetIframeLoadRetryCount:(0,_.f0)({iframeLoadRetryCount:()=>0})},guards:{canIframeLoadRetry:e=>e.iframeLoadRetryCount<3}});var T=n(347444);let v=(0,r.createContext)({appStateMachine:{},appPreviewStatus:d.I.loading,setAppPreviewStatus:()=>{},iframeRef:(0,r.createRef)(),iframeFetchId:"",reloadApp:()=>{},terminateWebsocketConnection:()=>{},initialResponseCacheState:{stateName:"NONE",reset:()=>{}},loadAppTelemetry:{getLoadAppData:()=>({isReload:!1,retryCount:0,firstLoadStartedAt:0,currentLoadStartedAt:0}),onAppLoadStep:()=>void 0,onShowIframe:()=>void 0,incrementRetryCount:()=>void 0,reset:()=>void 0},websocketTelemetry:{getWebsocketData:()=>({firstConnectedAt:void 0,lastConnectedAt:void 0,lastDisconnectedAt:void 0,attemptingToReconnect:!1}),onConnected:()=>void 0,onDisconnected:()=>void 0,onTerminateWebsocketConnection:()=>void 0,onRestartWebsocketConnection:()=>void 0},interactiveStartedTelemetry:{reset:()=>void 0,onWarehouseSelectedAt:()=>void 0},warehouseState:void 0,shouldShowIframe:!1,isNativeApp:!1,isInEditMode:!1,setIsInEditMode:()=>{}}),R=(0,r.memo)(({fullStreamlitIdentifier:e,bootstrapResult:t,historyQueryData:n,configToml:f,iframeRef:p,appPreviewStatus:y,setAppPreviewStatus:m,initialResponseCacheState:_,loadAppTelemetry:R,websocketTelemetry:C,interactiveStartedTelemetry:N,warehouseState:A,shouldShowIframe:w,isNativeApp:L,isInEditMode:k,setIsInEditMode:P,fatalError:D,clearFatalError:M,terminateWebsocketConnection:U,children:j})=>{var x;let{fetchId:F,updateFetchId:B}=(0,i.m)("streamlit-preview-pane"),G=function(e){let t=(0,E.EX)(),n=(0,g.h)(),o=(0,O.k)(I,{id:h.Z()});return(0,r.useEffect)(()=>{if(!t)return;let r=o.subscribe(t=>{var o;(t.changed||!t.historyValue)&&n({fullStreamlitIdentifier:e,componentName:b.uD0,eventName:b.UG5,eventType:"ui_impression",error:t.event.error||void 0,additionalTelemetryParams:{from:null==(o=t.history)?void 0:o.value,to:t.value}})});return()=>{r.unsubscribe()}},[e,t,n,o]),o}(e);(0,r.useEffect)(()=>()=>{G.stop()},[G]),(0,r.useEffect)(()=>{y===d.I.suspended&&G.send("SUSPEND")},[y,G]),(0,r.useEffect)(()=>{t.error&&G.send("FATAL",{error:t.error})},[t.error,G]),(0,r.useEffect)(()=>{D&&G.send("FATAL",{error:D})},[D,G]);let{reloadApp:V}=S({fullStreamlitIdentifier:e,clearFatalError:M,appStateMachine:G,appPreviewStatus:y,setAppPreviewStatus:m,updateIframeFetchId:B,loadAppTelemetry:R,websocketTelemetry:C,interactiveStartedTelemetry:N,initialResponseCacheState:_,iframeRef:p,iframeOrigin:(0,u.A)(null==(x=t.data)?void 0:x.url)}),K=(0,r.useMemo)(()=>({fullStreamlitIdentifier:e,appStateMachine:G,appPreviewStatus:y,setAppPreviewStatus:m,iframeRef:p,iframeFetchId:F,reloadApp:V,terminateWebsocketConnection:U,initialResponseCacheState:_,loadAppTelemetry:R,websocketTelemetry:C,interactiveStartedTelemetry:N,shouldShowIframe:w,warehouseState:A,isNativeApp:L,isInEditMode:k,setIsInEditMode:P,fatalError:D}),[e,G,y,m,p,F,V,U,_,R,C,N,w,A,L,k,P,D]);return(0,o.jsx)(c.h,{value:(0,s.m)(e),children:(0,o.jsx)(v.Provider,{value:K,children:(0,o.jsx)(l.X,{value:n||null,children:(0,o.jsx)(T.t,{bootstrapResult:t,children:(0,o.jsx)(a.EQ,{configToml:f,children:j})})})})})});R.displayName="StreamlitAppProvider";let C=()=>(0,r.useContext)(v)},347444:function(e,t,n){n.d(t,{E:()=>l,t:()=>a});var o=n(184168),r=n(499924);let i=(0,r.createContext)({data:null,loading:!1,appViewRequestId:"default-request-id"}),a=({bootstrapResult:e,children:t})=>(0,o.jsx)(i.Provider,{value:e,children:t});a.displayName="StreamlitBootstrapDataProvider";let l=()=>(0,r.useContext)(i)},507260:function(e,t,n){n.d(t,{Y:()=>E,t:()=>f});var o=n(609737),r=n(467131),i=n(499924),a=n(501188),l=n(750671),s=n(254759),c=n(551276),u=n(65662),d=n(314209);let f=640;function E(){var e;let t=o.flags._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_TELEMETRY(),{dataDiscoverRole:n,secondaryRoles:E}=(0,a.j)(),p="log-streamlit-batch-telemetry",b=(0,i.useContext)(s.L),y=(0,l.h)(null==b||null==(e=b.user)?void 0:e.api,"UserStore is not loaded"),g=(0,c.d)();return t&&d.WD.forEach(e=>d.kD.add(e)),(0,i.useCallback)(async({events:e,fullStreamlitIdentifier:t})=>{let o=e.filter(e=>d.kD.has(e.eventName));if(0===o.length)return;let i=Date.now();for(let e=0;e<o.length;e+=f){let a=function(e,t,n){let o={};for(let a of e){var r,i;let{eventName:e,additionalParams:l={},componentName:s}=a,c=function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({clientTimeStamp:null!=(r=l.clientTimeStamp)?r:n},l),{componentName:s,isPrivateLink:t()}),u=null!=(i=o[e])?i:[];u.push(c),o[e]=u}return o}(o.slice(e,e+f),g,i),l=(0,u.s9)(t,a);try{await y.query(l,{isInternal:!0,role:n,secondaryRoles:E,desc:p})}catch(e){r.cM.error(e)}}},[y,n,E,p,g])}},314209:function(e,t,n){n.d(t,{kD:()=>m,WD:()=>h,Qh:()=>_});var o=n(609737),r=n(467131),i=n(499924),a=n(501188),l=n(750671),s=n(254759),c=n(551276),u=n(65662),d=n(689398),f=n(674337),E=n(642261);class p{actOnItems(){this.action(this.queue.splice(0,this.queue.length))}enqueueItem(e){this.queue.push(e),-1!==this.maxQueueSize&&this.queue.length>=this.maxQueueSize&&this.actOnItems(),this.throttledAction()}flush(){this.throttledAction.flush()}get length(){return this.queue.length}constructor(e,t,n=-1){this.queue=[],this.action=e,this.throttledAction=(0,E.P)(this.actOnItems.bind(this),t,{leading:!1}),this.maxQueueSize=n}}var b=n(67158),y=n(507260);let g=()=>{var e;let t=(0,y.Y)(),n=(0,i.useCallback)(e=>{let n={};for(let t of e){var o;let e=t.fullStreamlitIdentifier?(0,b.m)(t.fullStreamlitIdentifier):"<none>",r=null!=(o=n[e])?o:[];r.push(t),n[e]=r}for(let e of Object.values(n))t({fullStreamlitIdentifier:e[0].fullStreamlitIdentifier,events:e.map(e=>({componentName:e.componentName,eventName:e.eventName,additionalParams:e.additionalParams}))})},[t]),{analytics:o}=(0,s.m)(["analytics"]),r=o.getStreamlitQueue(),a=null!=(e=(0,d.sB)())?e:5e3,l=(0,d.wd)()?new p(n,a,y.t):void 0;return r||o.setStreamlitQueue(l),null!=r?r:l};function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function O(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let h=[f.dO0,f.uYd,f.TV5,f.UfY,f.X9g],m=new Set([f.WmD,f.D3Z,f.w0o,f.SxE,f.Zq6,f.Hqt,f.pwE,f.ESo,f.RKz,f.__d,f.KF8,f.Bpb,f.qnG,f.rKO,f.hn2,f.IeT,f.cT0,f.u9u,f.Vdk,f.wKB,f.Rb3,f.J8b,f.yDA,f.Xrf,f.me3,f.VF4,f.VjJ,f.FSx,f.xJE,f.m2U,f.peE,f.Ao4,f.jym,f.UG5,f.t6j,f.mBZ]);function _(){var e;let t=o.flags._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_TELEMETRY(),n=(0,d.gN)(),f=(0,d.wd)()&&n,{dataDiscoverRole:E,secondaryRoles:p}=(0,a.j)(),b="log-streamlit-telemetry",y=(0,i.useContext)(s.L),_=(0,l.h)(null==y||null==(e=y.user)?void 0:e.api,"UserStore is not loaded"),I=(0,c.d)(),T=g();return t&&h.forEach(e=>m.add(e)),(0,i.useCallback)(e=>{let{fullStreamlitIdentifier:t,componentName:n,eventName:o,additionalParams:i={}}=e;if(!m.has(o))return;if(f&&T){i.clientTimeStamp=Date.now(),T.enqueueItem(O(S({},e),{additionalParams:i}));return}let a=O(S({},i),{componentName:n,clientTimeStamp:Date.now(),eventType:o,isPrivateLink:I()}),l=(0,u.Sz)(t,o,a);_.query(l,{isInternal:!0,role:E,secondaryRoles:p,desc:b}).catch(e=>{r.cM.error(e)})},[f,T,I,_,E,p,b])}},153958:function(e,t,n){n.d(t,{Z:()=>i});var o=n(499924),r=n(689398);let i=()=>{let e=(0,r.uy)();return{debugLog:(0,o.useCallback)((t,n,...o)=>{e&&console.debug(`[ST_DEBUG][${t}]`,n,...o)},[e])}}},775136:function(e,t,n){n.d(t,{h:()=>h});var o=n(51723),r=n(499924),i=n(225532),a=n(979991),l=n(527565),s=n(375756),c=n(67158),u=n(362779),d=n(927514),f=n(689398),E=n(674337),p=n(902668),b=n(347444),y=n(314209),g=n(153958);function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}function O(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let h=()=>{let e=(0,y.Qh)(),{logEvent:t}=(0,o.useTelemetry)(),{logEventToSnowflakeAndDatadog:n}=(0,a.z)(),h=(0,f.I1)(),m=sessionStorage.getItem(i.VE),{debugLog:_}=(0,g.Z)(),{appViewRequestId:I}=(0,b.E)(),{isNativeApp:T,isInEditMode:v}=(0,p.B)();return(0,r.useCallback)(o=>{var r,i,a,f,p;let b=o.fullStreamlitIdentifier?(0,c.m)(o.fullStreamlitIdentifier):void 0,y=null!=(i=o.appViewRequestId)?i:I,g=null!=(a=o.isNativeApp)?a:T,R=null!=(f=o.isInEditMode)?f:v,C=O(S({},o.additionalTelemetryParams,(0,d.T)({error:o.error,isUserError:(null==(r=o.additionalTelemetryParams)?void 0:r.isUserError)===!0})),{windowId:m,appViewRequestId:y,isNativeApp:g,isInEditMode:R,runtimeName:o.runtimeName,runMode:(p=o.runtimeName)===l.U?"WarehouseOnly":p===s.S?"SpcsOnly":void 0});e({fullStreamlitIdentifier:o.fullStreamlitIdentifier,componentName:o.componentName,eventName:o.eventName,additionalParams:C});let N={component:o.componentName,event:o.eventName,type:o.eventType,data:O(S({},C),{area:E.Y$F,streamlitIdentifier:b})};h&&u.A.disallowedDatadogEventTypes.includes(N.type)?n(O(S({},N),{type:N.type})):t(N),_("TELEMETRY",o.eventName,N)},[I,T,v,m,t,e,h,n,_])}},342141:function(e,t,n){n.d(t,{E2:()=>r,EV:()=>a,fL:()=>i,pO:()=>o});let o=e=>e.matches("suspended"),r=e=>e.matches("loading")||e.matches("restarting"),i=e=>e.matches("loaded")&&!e.matches("suspended"),a=e=>e.matches("failed")},982055:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,o={NoopStagger:function(){return a},NoopStaggerProvider:function(){return l},SFDBErrorCode:function(){return s},SnowflakeQueryError:function(){return c},hasCode:function(){return u},hasMessage:function(){return d}};for(var r in o)Object.defineProperty(t,r,{enumerable:!0,get:o[r]});function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let a=class{upsertTags(e){}withTags(e){return this}trace(e,t){10>=this.getLogLevel()&&console.log(e,t)}debug(e,t={}){20>=this.getLogLevel()&&console.log(e,t)}info(e,t={}){30>=this.getLogLevel()&&(console.log(this.getLogLevel()),console.log(e,t))}warn(e,t={},n){40>=this.getLogLevel()&&console.log(e,t)}error(e,t={},n){console.log(e,t)}fatal(e,t={},n){console.log(e,t)}gauge(e,t,n={}){}timing(e,t,n={}){}increment(e,t,n={}){}incrementMulti(e,t,n){}getLogLevel(){if(this.overrideLevel)return this.overrideLevel;if(!process.env.LOG_LEVEL)return 30;switch(process.env.LOG_LEVEL.toLowerCase()){case"trace":return 10;case"debug":return 20;case"info":default:return 30;case"warn":return 40}}constructor(e){i(this,"overrideLevel",void 0),this.overrideLevel=e}},l=class{get(){return this.stagger}constructor(){i(this,"stagger",void 0),this.stagger=new a}};var s=((n={}).ACCOUNT_ALREADY_EXISTS_003723="003723",n.ALREADY_EXISTS_002002="002002",n.NOT_FOUND_002043="002043",n.BROKEN_SHARE_003030="003030",n.NOT_FOUND_001999="001999",n.NOT_FOUND_002003="002003",n.UNKNOWN_IDENTIFIER="002004",n.INSUF_PRIV_003001="003001",n.ACCOUNT_CANNOT_BE_ADDED_003516="003516",n.LISTING_ALREADY_REQUESTED_090532="090532",n.DX_ALREADY_HAS_ACCOUNT_090542="090542",n.DX_DOES_NOT_HAVE_ACCOUNT_090543="090543",n.LISTING_CANNOT_DROP_PUBLISHED_090553="090553",n.LISTING_CANNOT_EDIT_PUBLISHED_090554="090554",n.SHARE_LISTING_ALREADY_SET_090557="090557",n.LISTING_NO_REQUEST_090561="090561",n.LISTING_ALREADY_FULFILLED_090566="090566",n.SHARE_ALREADY_ATTACHED_TO_LISTING_090567="090567",n.TOKEN_EXPIRED_ERROR="390114",n.WAREHOUSE_ALREADY_RESUMED_ERROR="090063",n.WAREHOUSE_ALREADY_SUSPENDED_ERROR="090064",n.WAREHOUSE_SUSPENDED_WHILE_QUEUED_ERROR="090109",n.WAREHOUSE_CANNOT_BE_RESUMED_BECAUSE_RESOURCE_MONITOR_EXCEEDED_QUOTA_ERROR="090073",n.WAREHOUSE_SUSPENDED_ERROR="000608",n.WAREHOUSE_DO_NOT_EXIST_OR_HAVE_ROLE_ACCESS_ERROR="092803",n.STAGE_DOES_NOT_EXIST_OR_HAVE_ROLE_ACCESS_ERROR_092804="092804",n.EXTERNAL_STAGES_NOT_SUPPORTED_092805="092805",n.STREAMLIT_NOT_FOUND_092806="092806",n.NO_WAREHOUSE_FOUND_092807="092807",n.WAREHOUSE_NOT_AVAILBLE_092808="092808",n.UNSUPPORTED_FEATURE="000002",n.NO_FEATURED_SECTIONS="000603",n.NO_ACTIVE_WAREHOUSE="000606",n.INVALID_PROFILE_STATE_090622="090622",n.INVALID_IP_ADDRESS_090302="090302",n.RESULT_NOT_FOUND_000612="000612",n.NO_IMPORT_SHARE_PRIV_090594="090594",n.SHARING_NOT_ENABLED_003027="003027",n.TRIAL_ACCOUNT_SUSPENDED_000666="000666",n.CANNOT_RUN_COMMAND_391833="391833",n.UNKNOWN_FUNCTION_REQUEST_002140="002140",n.CANNOT_AUTO_FULFILL_LISTING_090685="090685",n.CANNOT_AUTO_FULFILL_APP_PACKAGE_090824="090824",n.SHARE_HAS_NON_CONSUMER_TARGETS_090602="090602",n.CANNOT_REPLICATE_TAGS_391810="391810",n.PYTHON_UDF_ERROR="100357",n.CONTAINS_PYTHON_UDF_003948="003948",n.CONTAINS_EXTERNAL_TABLE_003906="003906",n.INVALID_PROPERTY_001420="001420",n.CANNOT_DROP_LISTING_DIRECTLY="090673",n.CANNOT_DROP_LISTING_AUTOFULFILLMENT_ENABLED_090684="090684",n.CANNOT_MODIFY_RETIRED_LISTING_090674="090674",n.SQL_EXECUTION_TIMED_OUT_AND_WAS_CANCELED="000630",n.EMAIL_RECIPIENT_NOT_ALLOWED_394209="394209",n.MONETIZATION_NOT_ENABLED_FOR_ACCOUNT_090659="090659",n.NO_SUITABLE_BILLING_ENTITY_FOR_TARGET_CLOUD_042119="042119",n.NATIVE_APPS_CREATION_FEATURE_NOT_ENABLED_092521="092521",n.NATIVE_APPS_APPLICATION_NO_LONGER_INSTALLED="093079",n.NATIVE_APPS_INSTALLATION_SCRIPT_ERROR_093082="093082",n.ACCOUNT_BUDGET_NOT_ACTIVATE_ERROR_20000="-20000",n.ACCOUNT_BUDGET_SNOWFLAKE_DB_NOT_SETUP_ERROR_002141="002141",n.USER_TASK_RETRY_TARGET_RUN_HAD_NO_FAILURES="091456",n.REVOKE_PARTIALLY_EXECUTED_DEPENDENT_GRANTS_NO_CASCADE_SPECIFIED="003935",n.DMX_BUY_NOT_ENABLED_042105="042105",n.CIRCULAR_ROLE_GRANT_ERROR="003010",n.LISTING_NAME_CANNOT_CONTAIN_DOLLAR_SIGN="092755",n.DRAFT_LISTINGS_PER_ACCOUNT_LIMIT_REACHED="091972",n.EMPTY_SQL_STATEMENT="000900",n.REMOTE_FILE_NOT_FOUND="091016",n.INTERNAL_DISTRIBUTION_FLAG="093085",n.NONE_APPROVED_VERSION="093086",n.NO_DEFAULT_RELEASE_DIRECTIVE="090720",n.USER_ERROR_REPORT_100315="100315",n.SNOWGIT_INTERNAL_ERROR="000600",n.GIT_REPOSITORY_NOT_AUTHORIZED="093550",n.GIT_REPOSITORY_CONNECTION_FAILED="093555",n.GIT_REPOSITORY_UNEXPECTED_BRANCH_HEAD="093560",n.GIT_REPOSITORY_FILE_OR_DIRECTORY_CONFLICT="093561",n.GIT_REPOSITORY_REMOTE_UPDATE_FAILED="093562",n.VSTAGE_LIVE_VERSION_EXISTS="099106",n.VSTAGE_LIVE_VERSION_NOT_FOUND="099108",n.VSTAGE_INVALID_READ_LOCATION="099112",n.VSTAGE_GIT_PUSH_FAILED="099120",n.VSTAGE_GIT_PULL_SUCCESS="099125",n.VSTAGE_GIT_PULL_ALREADY_LATEST="099126",n.VSTAGE_GIT_PULL_FAILED_WITH_MERGE_CONFLICT="099127",n.INSUF_PRIV_391882="391882",n.DYNAMIC_TABLE_MANUAL_REFRESH_FAILED="002742",n.PROPERTY_VALUE_IS_INVALID="001481",n);let c=class extends Error{toString(){return`${this.code}: ${this.message}, queryId=${this.queryId}`}constructor(e,t){super(null==e?void 0:e.message),i(this,"queryName",void 0),i(this,"code",void 0),i(this,"queryId",void 0),i(this,"sdkName",void 0),i(this,"data",void 0),this.queryName=t,Object.setPrototypeOf(this,new.target.prototype),e.name&&e.code&&e.message&&(this.code=e.code,this.data=e.data,this.sdkName=e.name)}};function u(e){return!!e&&!!e.code}function d(e){return!!e&&!!e.message}},267528:function(e,t,n){n.d(t,{SB:()=>u,tJ:()=>c});var o=n(941159),r=n(627678);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let a=Symbol("state"),l=Symbol("atom");class s{constructor(e){i(this,l,void 0),i(this,"schema",void 0),i(this,"get",(e=r.h)=>e.get(this)),i(this,"set",(e,t=r.h)=>{if(this.schema){let n=this.schema.parse(e);t.set(this,n)}else t.set(this,e)}),i(this,"subscribe",(e,t=r.h)=>{e(this.get(t));let n=this;return t.sub(n,()=>e(t.get(n)))}),this[l]=(0,o.cn)(e)}}function c(e){if(Reflect.has(e,a))return Reflect.get(Reflect.get(e,a),l);if(Reflect.has(e,l))return Reflect.get(e,l);if("object"==typeof e)return e;throw Error("State is not a object")}function u(e){let t=new s(e),n=function(e){return t.get(e)};return Reflect.set(n,a,t),n.set=t.set,n.subscribe=t.subscribe,n.atom=()=>t.atom(),n.subject=()=>t.subject(),n.syncable=(e,o)=>(t.schema=o,Object.defineProperty(n,"name",{value:e}),n),n}},627678:function(e,t,n){n.d(t,{h:()=>a});var o=n(941159),r=n(267528);let i=Symbol("store"),a=new class{get(e){return this[i].get((0,r.tJ)(e))}set(e,t){this[i].set((0,r.tJ)(e),t)}sub(e,t){this[i].sub((0,r.tJ)(e),t)}reset(){this[i]=(0,o.MT)()}constructor(e){var t;t=void 0,i in this?Object.defineProperty(this,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[i]=t,this[i]=e||(0,o.MT)()}}((0,o.K7)())},431815:function(e,t,n){n.d(t,{_:()=>i});var o=n(267528),r=n(839856);let i=(0,o.SB)({role:"",database:"",schema:"",warehouse:""}).syncable("snowsight.executionContext",r.z.object({role:r.z.string(),database:r.z.string(),schema:r.z.string(),warehouse:r.z.string()}))}}]);
//# sourceMappingURL=2838-ece7898c1a404277.js.map